{"config":{"lang":["en"],"separator":"[\\s\\-,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"<p>This repository is a compulation of SOPs and How Tos for conducting a generic Incident Response.  It is designed to provide a wide variety of options.  </p>"},{"location":"#concept-for-contributions","title":"Concept for contributions","text":"<ul> <li>IR Phase - Example: (2.Identification)  </li> <li>README.md Table of Contents for phase tasks  </li> <li>IR Phase Task - Example: (2.02_Create_Active_IP_List)  <ul> <li>Scripts  </li> <li>README.md IR Phase Task  </li> </ul> </li> </ul>"},{"location":"#script-style-guide","title":"Script Style Guide","text":"<p>Name the script the following way. <pre><code># {TaskID}-WhatScriptDoes.(sh/ps1)\n2.04-GatherADStructureInformation.ps1\n</code></pre></p>"},{"location":"#1-bash","title":"1. Bash","text":"<p>Use Camel Case for Variable and Function Names:</p> <pre><code># variable: varCaseFirstLetterofEachWord\n# function: funcCaseFirstLetterofEachWord\n\nmyVariable=\"My Variable\"\n\nfunction myFunction {\n  # do something...\n}\n</code></pre>"},{"location":"#2-powershell","title":"2. Powershell","text":"<p>Use Pascal Case for Variable. Function Names should be Verb-Action combination: <pre><code># variable: VarCaseFirstLetterofEachWord\n# function: FuncCaseFirstLetterofEachWord\n\n$MyVariable = \"My Variable\"\n\nfunction MyFunction {\n  # do something...\n}\n</code></pre></p>"},{"location":"#3-python","title":"3. Python","text":"<p>Follow PEP 8 Guide Line: https://www.python.org/dev/peps/pep-0008/</p>"},{"location":"#git-workflow","title":"Git Workflow","text":""},{"location":"#1-clone-the-repo","title":"1. clone the repo","text":"<p>Once your account has MFA enforced you will need to use an API key.  Make sure you store your API key in a safe place, I would suggest your password manager. Generate API Key</p> <pre><code># copy url of this git repo and replace APIKEY with yours generated above\n$ git clone https://APIKEY@github.com/cmdcnd/IncidentResponse.git\n</code></pre> <p>once you clone, at this point, you should only have local copy of <code>main</code> branch. you can check all local branches using</p> <pre><code>$ git branch\n(output should look)\n* main\n</code></pre>"},{"location":"#2-create-a-local-branch","title":"2. create a local branch","text":"<p>create a local branch with name that is related to changes that are being made. <pre><code>$ git checkout -b $YOUR_LOCAL_BRANCH_NAME\n\n# if you're working on task 2.04, you can do something like.\n\n$ git checkout -b task-2.04\n</code></pre></p> <p>You can check all local branches again. <pre><code>$ git branch\n(output should look)\n  main\n* task-2.04\n</code></pre></p> <p>you can also jump back and forth different branch using <pre><code>$ git checkout $(branch_name)\n</code></pre></p> <p>This allows avoiding making changes directly on main which is usually the official branch where we only want to keep changes that are validated and reviewed.</p>"},{"location":"#3-complete-tasks-documenations","title":"3. complete tasks documenations","text":"<ul> <li>complete README.md: you can get the template and the example from ./template</li> <li>add any scripts if you have one under $(your_tasks_folder)/scripts</li> <li>make sure to include detailed steps for running the script.</li> </ul>"},{"location":"#4-add-your-changes","title":"4. add your changes","text":"<p>any changes to an existing files or a new file will show with red text when you run <pre><code>$ git status\n</code></pre></p> <p>before commiting, files you want to commit need to be added. <pre><code># adding everything: this has to run at the top level folder that contains any changes that are made.\n$ git add .\n\n# or add one at a time: if you want to commit some but leave others.\n$ git add $(file_name)\n</code></pre></p> <p>if you run the <code>git status</code> again, added files should show up green in color.</p>"},{"location":"#5-commit-your-changes","title":"5. commit your changes","text":"<p>committing will open whatever editor that is set as <code>core.editor</code> under <pre><code>$ git config --list\n</code></pre></p> <p>this is so that you can write a commit message. make sure that you're comfortable with editor the git is about to open.</p> <p>once you've confirmed that all files that need to be committed are added, commit the changes.</p> <pre><code>$ git commit\n</code></pre> <p>make sure to write a meaningful commit message that gives context to what changes are made. the first line becomes the header, and add a space and write the body.</p> <p>When you save and exit our of the editor, commit is complete.  </p>"},{"location":"#6-push-your-local-branch-to-remote","title":"6. push your local branch to remote","text":"<p>The branch you've created in step 2 is only available locally.  Remote is the central version of repo where everybody can access.  In order to make the branch available at remote, the branch needs to be pushed.  </p> <p>run this while you are at your branch: this means when <code>git branch</code> has <code>*</code> next to the branch you want to push. <pre><code>$ git push\n</code></pre></p> <p>When you push the local branch for the first time, <code>git</code> will complain because the remote branch does not exist yet for the local branch. in git, the paired remote branch of the local branch is called the upstream.</p> <pre><code>fatal: The current branch task-2.04 has no upstream branch.\nTo push the current branch and set the remote as upstream, use\n\n    git push --set-upstream origin task-2.04\n</code></pre> <p>Run the command the git suggests. <pre><code>$ git push --set-upstream origin task-2.04\n</code></pre></p> <p>Setting the upstream is required only once for the very first time, and if you need to push any other changes to your branch afterward, you can simply do</p> <pre><code>$ git push\n</code></pre>"},{"location":"#7-create-a-pull-request","title":"7. create a pull request","text":"<p>Now, the branch with your change is available remote. when you go to git repo: https://github.com/cmdcnd/IncidentResponse, you can create a pull request.  </p> <p>git should show a banner in the main repo as a short cut asking if you want to make a pull request out of the recent push.</p> <p>Or, you can click on <code>create a pull request</code> button. choose <code>main</code> on the left, and <code>your branch</code> on the right.</p>"},{"location":"#references","title":"References","text":"<p>Tasks are based on the NIST Framework for Improving Critical Infrastructure Cybersecurity. NIST Framework for Improving Critical Infrastructure Cybersecurity </p>"},{"location":"1.Preparation/","title":"1.Preparation","text":""},{"location":"1.Preparation/#preparation-tasks","title":"Preparation Tasks","text":"<p>The preparation phase of incident response is the phase where an organization takes proactive steps to prepare for potential security incidents or breaches. The goal of this phase is to establish an incident response plan that outlines the necessary procedures, roles and responsibilities, and tools and resources required to detect, respond to, and recover from security incidents.  </p> <p>The preparation phase typically involves the following activities:  </p> <ul> <li>Establishing an incident response team: This team is responsible for managing the incident response process and includes representatives from various departments within the organization.  </li> <li>Defining the incident response plan: This plan outlines the steps to be taken during a security incident, including who to contact, what actions to take, and how to communicate with stakeholders.  </li> <li>Identifying and prioritizing assets: This involves identifying critical assets that are essential to the organization's operations and prioritizing them based on their importance.  </li> <li>Conducting risk assessments: This involves identifying potential threats and vulnerabilities to the organization's assets and assessing the likelihood and impact of these risks.  </li> <li>Implementing security controls: This involves implementing security measures such as firewalls, intrusion detection systems, and access controls to reduce the likelihood of security incidents.  </li> <li>Testing and updating the incident response plan: This involves testing the incident response plan to ensure that it works as intended and updating it as necessary to reflect changes in the organization's infrastructure, assets, or threat landscape.  </li> </ul> <p>Overall, the preparation phase is critical for ensuring that an organization is well-prepared to respond to security incidents in a timely and effective manner.  </p>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/","title":"1.01-Troop Leading Procedures","text":""},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#troop-leading-procedures-task","title":"Troop Leading Procedures Task","text":""},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#conditions","title":"Conditions","text":"<ul> <li>Given a mission to deploy a IR Team in support of Guardnet, State IT systems, or other organization as directedby the Governor  </li> <li>Response effort if localized and a Type I / II Federal Disaster Response has not been declared  </li> </ul>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#standards","title":"Standards","text":"<ul> <li>Receive the Mission  </li> <li>Issue a warning order  </li> <li>Make a tentative plan  </li> <li>Start necessary movement  </li> <li>Reconnoiter  </li> <li>Complete the plan  </li> <li>Issue the complete order  </li> <li>Supervise  </li> </ul>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#end-state","title":"End State","text":"<p>As time allows, conduct MDMP, develop OPORD (and/or FRAGOs), and on-premises recon. If time does not allow, verbal orders are issued and documented during Cyber Incident Tracking.</p>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#notes","title":"Notes","text":""},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#manual-steps","title":"Manual Steps","text":""},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#running-script","title":"Running Script","text":""},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#dependencies","title":"Dependencies","text":""},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#other-available-tools","title":"Other available tools","text":""},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#references","title":"References","text":"<p>CALL Handbook 15-06: MDMP 150-LDR-5012: Troop Leading Procedures ADP 6-22: Army Leadership </p>"},{"location":"1.Preparation/1.01-Troop_Leading_Procedures/#revision-history","title":"Revision History","text":""},{"location":"1.Preparation/1.02-Receive_Mission/","title":"1.02-Receive Mission","text":""},{"location":"1.Preparation/1.02-Receive_Mission/#receive-the-mission-task","title":"Receive the Mission Task","text":""},{"location":"1.Preparation/1.02-Receive_Mission/#conditions","title":"Conditions","text":"<p>Given an IR Team</p> <ul> <li>IR Team is given a mission to deploy a IR Team in support of Guardnet, State IT systems, orother organization as directed by the Governor  </li> <li>Response effort if localized and a Type I / II Federal Disaster Response has not been declared  </li> </ul>"},{"location":"1.Preparation/1.02-Receive_Mission/#standards","title":"Standards","text":"<p>Successfully understand guidance from higher and deploys the appropriate resources to complete the mission.  </p> <ul> <li>Received Mission  </li> <li>Issued WARNO  </li> <li>Conducts Mission Analysis  </li> <li>Develops Courses of action  </li> <li>Estimate Manning  </li> <li>Produce OPORD  </li> <li>Activate Personnel and mobilize  </li> </ul>"},{"location":"1.Preparation/1.02-Receive_Mission/#end-state","title":"End State","text":"<p>The IR Team arrives on-site with appropriate personnel and equipment, prepared to execute defensive operations.  </p>"},{"location":"1.Preparation/1.02-Receive_Mission/#notes","title":"Notes","text":"<p>Much of the OPORD can be produced from a boilerplate template. However, special emphasis must be placed on Annexes P and H.  </p>"},{"location":"1.Preparation/1.02-Receive_Mission/#manual-steps","title":"Manual Steps","text":""},{"location":"1.Preparation/1.02-Receive_Mission/#running-script","title":"Running Script","text":""},{"location":"1.Preparation/1.02-Receive_Mission/#dependencies","title":"Dependencies","text":""},{"location":"1.Preparation/1.02-Receive_Mission/#other-available-tools","title":"Other available tools","text":""},{"location":"1.Preparation/1.02-Receive_Mission/#references","title":"References","text":"<p>NIST Cyber Security Framework NIST SP 800-61r2: Computer Security Incident Handling Guide </p>"},{"location":"1.Preparation/1.02-Receive_Mission/#revision-history","title":"Revision History","text":""},{"location":"1.Preparation/1.03-Personnel_Status/","title":"1.03-Personnel Status","text":""},{"location":"1.Preparation/1.03-Personnel_Status/#personnel-status-logistics-task","title":"Personnel Status &amp; Logistics Task","text":""},{"location":"1.Preparation/1.03-Personnel_Status/#conditions","title":"Conditions","text":"<ul> <li>Given a mission to deploy a IR Team in support of Guardnet, State IT systems, or other organization as directedby the Governor  </li> <li>Response effort if localized and a Type I / II Federal Disaster Response has not been declared  </li> </ul>"},{"location":"1.Preparation/1.03-Personnel_Status/#standards","title":"Standards","text":"<ul> <li>Verify personnel status: State Active Duty (SAD) or T32  </li> <li>Ensure orders are published for on-mission Soldiers  </li> <li>As appropriate, coordinate for lodging, meals, and other Soldier needs  </li> <li>As appropriate, coordinate for transportation to/from the mission location for participating Soldiers  </li> <li>Provide reporting on Personnel Status (PERSTAT) to the chain of command per local SOPs.  </li> </ul>"},{"location":"1.Preparation/1.03-Personnel_Status/#end-state","title":"End State","text":"<ul> <li>On-mission Soldiers are in the appropriate orders status and have the resource they need for success.</li> <li>PERSTATs are submitted.  </li> </ul>"},{"location":"1.Preparation/1.03-Personnel_Status/#notes","title":"Notes","text":"<p>This information will vary from state to state.  </p>"},{"location":"1.Preparation/1.03-Personnel_Status/#manual-steps","title":"Manual Steps","text":""},{"location":"1.Preparation/1.03-Personnel_Status/#running-script","title":"Running Script","text":""},{"location":"1.Preparation/1.03-Personnel_Status/#dependencies","title":"Dependencies","text":""},{"location":"1.Preparation/1.03-Personnel_Status/#other-available-tools","title":"Other available tools","text":""},{"location":"1.Preparation/1.03-Personnel_Status/#references","title":"References","text":"<p>NGAUS: Fact Sheet, Guard Duty Status: </p>"},{"location":"1.Preparation/1.03-Personnel_Status/#revision-history","title":"Revision History","text":""},{"location":"1.Preparation/1.04-Legal_Support/","title":"1.04-Legal Support","text":""},{"location":"1.Preparation/1.04-Legal_Support/#legal-support-task","title":"Legal Support Task","text":""},{"location":"1.Preparation/1.04-Legal_Support/#conditions","title":"Conditions","text":"<ul> <li>Given a mission to deploy a IR Team in support of Guardnet, State IT systems, or other organization as directedby the Governor  </li> <li>Response effort if localized and a Type I / II Federal Disaster Response has not been declared  </li> </ul>"},{"location":"1.Preparation/1.04-Legal_Support/#standards","title":"Standards","text":"<ul> <li>Verify personnel status: State Active Duty (SAD) or T32  </li> <li>Coordinate with JAG / Cyber Legal personnel regarding necessary MOUs and NDAs to support a Mission Partner (MP) off Guardnet/DODIN  </li> <li>Coordinate with JAG / Cyber Legal personnel to review the Rules for Use (RUC) of Cyber and any changes needed  </li> <li>After arriving on mission,continue to coordinate with JAG / Cyber Legal personnel on any changes inpersonnel status or requests from the Mission Partner  </li> <li>Coordinate with JAG / Cyber Legal personnel immediately should a Soldier become involved in actual orperceived illegal activities  </li> </ul>"},{"location":"1.Preparation/1.04-Legal_Support/#end-state","title":"End State","text":"<p>Cyber mission operations continue uninterrupted by legal concerns.  </p>"},{"location":"1.Preparation/1.04-Legal_Support/#notes","title":"Notes","text":""},{"location":"1.Preparation/1.04-Legal_Support/#manual-steps","title":"Manual Steps","text":""},{"location":"1.Preparation/1.04-Legal_Support/#running-script","title":"Running Script","text":""},{"location":"1.Preparation/1.04-Legal_Support/#dependencies","title":"Dependencies","text":""},{"location":"1.Preparation/1.04-Legal_Support/#other-available-tools","title":"Other available tools","text":""},{"location":"1.Preparation/1.04-Legal_Support/#references","title":"References","text":""},{"location":"1.Preparation/1.04-Legal_Support/#revision-history","title":"Revision History","text":""},{"location":"1.Preparation/1.05-Partner_Engagements/","title":"1.05-Partner Engagements","text":""},{"location":"1.Preparation/1.05-Partner_Engagements/#partner-engagements-task","title":"Partner Engagements Task","text":""},{"location":"1.Preparation/1.05-Partner_Engagements/#conditions","title":"Conditions","text":"<ul> <li>Given a mission to deploy a IR Team in support of Guardnet, State IT systems, or other organization as directedby the Governor  </li> <li>Response effort if localized and a Type I / II Federal Disaster Response has not been declared  </li> </ul>"},{"location":"1.Preparation/1.05-Partner_Engagements/#standards","title":"Standards","text":"<ul> <li>Verify personnel status: State Active Duty (SAD) or T32  </li> <li>Work with mission partner POC to understand support requirements  </li> <li>The mission partner is in charge  </li> <li>Coordinate with mission partner POC to sign MOUs as appropriate  </li> <li>Coordinate with mission partner POC to sign NDAs as appropriate  </li> <li>Provide updates to mission partner POC as requested or within their reporting timelines  </li> <li>Make recommendations when appropriate to the mission partner POC  </li> <li>Do not interact with or change mission partner systems unless receiving permission, preferably written  </li> <li>Be prepared to share any/all findings with the mission partner; reporting could be summary, technical, or both  </li> <li>Should on-mission personnel identify potentially illegal activities or other violations, inform the mission partnerimmediately and appropriate authorities  </li> </ul>"},{"location":"1.Preparation/1.05-Partner_Engagements/#end-state","title":"End State","text":"<p>The on-mission IR Team establishes and maintains a positive working relationship with the support mission partner.  </p>"},{"location":"1.Preparation/1.05-Partner_Engagements/#notes","title":"Notes","text":"<p>It is the prerogative of mission partner to approve/disapprove system changes; you may disagree with mission partner but ultimately it is their system  </p>"},{"location":"1.Preparation/1.05-Partner_Engagements/#manual-steps","title":"Manual Steps","text":""},{"location":"1.Preparation/1.05-Partner_Engagements/#running-script","title":"Running Script","text":""},{"location":"1.Preparation/1.05-Partner_Engagements/#dependencies","title":"Dependencies","text":""},{"location":"1.Preparation/1.05-Partner_Engagements/#other-available-tools","title":"Other available tools","text":""},{"location":"1.Preparation/1.05-Partner_Engagements/#references","title":"References","text":"<p>FM 3-13: Information Operations (Chapter 9, Soldier and Leader Engagements) </p>"},{"location":"1.Preparation/1.05-Partner_Engagements/#revision-history","title":"Revision History","text":""},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/","title":"1.06-Create and Execute IR Orders","text":""},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#create-and-execute-ir-team-orders-task","title":"Create and execute IR Team Orders Task","text":""},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#conditions","title":"Conditions","text":"<p>Given an OPORD for IR Team Operations  </p>"},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#standards","title":"Standards","text":"<p>Create and execute DCO Orders:  </p> <ul> <li>Enter Request for orders  </li> <li>Establish Rules of Engagement  </li> <li>Execute supporting documents  </li> </ul>"},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#end-state","title":"End State","text":"<p>Orders and executing documents are executed  </p>"},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#notes","title":"Notes","text":""},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#manual-steps","title":"Manual Steps","text":""},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#running-script","title":"Running Script","text":""},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#dependencies","title":"Dependencies","text":""},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#other-available-tools","title":"Other available tools","text":""},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#references","title":"References","text":"<p>NIST Cyber Security Framework NIST SP 800-184: Guide to Cyber Event Recovery </p>"},{"location":"1.Preparation/1.06-Create_and_Execute_IR_Orders/#revision-history","title":"Revision History","text":""},{"location":"1.Preparation/1.07-Integrate_Additional_Support/","title":"1.07-Integrate Additional Support","text":""},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#integrate-additional-support-task","title":"Integrate Additional Support Task","text":""},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#conditions","title":"Conditions","text":"<ul> <li>Given a mission to deploy a IR Team in support of Guardnet, State IT systems, or other organization as directedby the Governor  </li> <li>Response effort if localized and a Type I / II Federal Disaster Response has not been declared  </li> <li>IR Team unable to complete mission requirements due to scope of work and additional support is requested  </li> <li>Incident scope increased to Type I / II Federal Disaster Response and additional forces are necessary  </li> </ul>"},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#standards","title":"Standards","text":"<ul> <li>Coordinate with JAG / Cyber Legal personnel regarding inclusion of T10 forces in mission operations.  </li> <li>In coordination with JAG / Cyber Legal personnel, The Adjutant General (TAG) determines whether or not aDual Status Commander is necessary.  </li> <li>If needed, Dual Status Commander and supporting staff begins operations.  </li> <li>Upon T10 (USAR or Active Duty) forces arrival, IR Team informs their State Joint Operations Center.  </li> <li>Coordinate with JAG / Cyber Legal personnel regarding necessary MOUs and NDAs and appropriate scope forT10 forces.  </li> <li>Coordinate with JAG / Cyber Legal personnel to review the Rules for Use of Cyber and any changes neededfor inclusion of T10 forces.  </li> <li>Work with T10 forces leadership to establish mutually agreeable Battle Rhythm and integration into ongoingoperations  </li> <li>Coordinate with JAG / Cyber Legal personnel immediately should any Soldier become involved in actual orperceived illegal activities  </li> </ul>"},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#end-state","title":"End State","text":"<p>IR Team successfully integrates support from T10 forces in to Cyber mission operations.  </p>"},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#notes","title":"Notes","text":"<p>The scope of this Task will vary by state  </p>"},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#manual-steps","title":"Manual Steps","text":""},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#running-script","title":"Running Script","text":""},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#dependencies","title":"Dependencies","text":""},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#other-available-tools","title":"Other available tools","text":""},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#references","title":"References","text":"<p>NIST Cyber Security Framework NIST SP 800-61r2: Computer Security Incident Handling Guide </p>"},{"location":"1.Preparation/1.07-Integrate_Additional_Support/#revision-history","title":"Revision History","text":""},{"location":"1.Preparation/1.08-Mission_Intent/","title":"1.08-Mission Intent","text":""},{"location":"1.Preparation/1.08-Mission_Intent/#receive-plan-and-communicate-mission-intent-objectives-and-end-state-task","title":"Receive, plan, and communicate mission intent, objectives, and end-state Task","text":""},{"location":"1.Preparation/1.08-Mission_Intent/#conditions","title":"Conditions","text":"<p>IR Team is requested to support mission partner's critical information systems.  </p>"},{"location":"1.Preparation/1.08-Mission_Intent/#standards","title":"Standards","text":"<p>Using MDMP, determine appropriate COA and communicate to team members. Non-standard Considerations:  </p> <ul> <li>Duty Status (SAD, Title 10/32)  </li> <li>Cyber tool requirement vs. availability team / mission partner. (i.e. - mission partner may not permit tools that theIR Team is familiar with, or competent in)  </li> <li>Escalation procedure(s) (i.e. - if beyond capability, where / when to hand off request augmentation)  </li> <li>OPSEC requirements.  </li> <li>Legal support.  </li> </ul>"},{"location":"1.Preparation/1.08-Mission_Intent/#end-state","title":"End State","text":"<p>Effective mission plan communicated and understood by all team members.  </p>"},{"location":"1.Preparation/1.08-Mission_Intent/#notes","title":"Notes","text":"<p>Standard military MDMP applies (often abbreviated) with attention paid to non-standard considerations.  </p>"},{"location":"1.Preparation/1.08-Mission_Intent/#manual-steps","title":"Manual Steps","text":""},{"location":"1.Preparation/1.08-Mission_Intent/#running-script","title":"Running Script","text":""},{"location":"1.Preparation/1.08-Mission_Intent/#dependencies","title":"Dependencies","text":""},{"location":"1.Preparation/1.08-Mission_Intent/#other-available-tools","title":"Other available tools","text":""},{"location":"1.Preparation/1.08-Mission_Intent/#references","title":"References","text":"<p>ADP 5.0 </p>"},{"location":"1.Preparation/1.08-Mission_Intent/#revision-history","title":"Revision History","text":""},{"location":"1.Preparation/1.09-Continuous_AARs/","title":"1.09-Continuous AAR","text":""},{"location":"1.Preparation/1.09-Continuous_AARs/#continuous-aars-task","title":"Continuous AARs Task","text":""},{"location":"1.Preparation/1.09-Continuous_AARs/#conditions","title":"Conditions","text":"<ul> <li>Given a mission to deploy a IR Team in support of Guardnet, State IT systems, or other organization as directed by the Governor  </li> <li>Response effort if localized and a Type I / II Federal Disaster Response has not been declared  </li> </ul>"},{"location":"1.Preparation/1.09-Continuous_AARs/#standards","title":"Standards","text":"<p>Throughout operations, the IR Team should develop AAR containing the following elements:  </p> <ul> <li>List of Participants  </li> <li>Review key actions/event that occurred during mission  </li> <li>Analysis of Lessons Learned  </li> <li>Remediation plans to prevent this from occurring in the future  </li> <li>Discussion of final indicators of compromise to share for detection of potential incidents across the community  </li> <li>Staff performance review  </li> <li>Corrective actions review  </li> <li>Tool utilization review This list is not exhaustive. If the IR Team produces it during mission, it should be considered an artifact and turned over to the supported MP.  </li> </ul>"},{"location":"1.Preparation/1.09-Continuous_AARs/#end-state","title":"End State","text":"<p>The IR Team completes continuous AARs. As appropriate, the IR Team engages the mission partner in lessons learned, ways to prevent future incidents, and how to detect an actionable incident.  </p>"},{"location":"1.Preparation/1.09-Continuous_AARs/#notes","title":"Notes","text":"<p>This continuous AAR process will improve the Recovery Process and support lessons learned for current and future missions.  </p>"},{"location":"1.Preparation/1.09-Continuous_AARs/#manual-steps","title":"Manual Steps","text":""},{"location":"1.Preparation/1.09-Continuous_AARs/#running-script","title":"Running Script","text":""},{"location":"1.Preparation/1.09-Continuous_AARs/#dependencies","title":"Dependencies","text":""},{"location":"1.Preparation/1.09-Continuous_AARs/#other-available-tools","title":"Other available tools","text":""},{"location":"1.Preparation/1.09-Continuous_AARs/#references","title":"References","text":"<p>NIST Cyber Security Framework NIST SP 800-61r2: Computer Security Incident Handling Guide </p>"},{"location":"1.Preparation/1.09-Continuous_AARs/#revision-history","title":"Revision History","text":""},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/","title":"1.10-Incident Tracking and Reporting","text":""},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#incident-tracking-task","title":"Incident Tracking Task","text":""},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#conditions","title":"Conditions","text":"<ul> <li>Given a database that all team members have access to  </li> <li>Create a database schema that support the tracking of cyber incidents  </li> <li>Report any incident that is confirmed as a true-positive to ACOIC (Who: Support - INTEL)  </li> </ul>"},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#standards","title":"Standards","text":"INCIDENT ID <ul> <li>Question text: Incident or case ID  </li> <li>User notes: N/A  </li> <li>Question type: text field  </li> <li>Variable name: <code>incident_id</code> (string)  </li> <li>Purpose: To uniquely identify incidents for storage and tracking over time.  </li> <li>Developer notes: We recommend auto-generating IDs rather than prompting the user to create/submit one. If you plan to share an incident with others, we suggest not making your org's name part of the incident ID (e.g., <code>verizonBreach_00001</code>).  </li> <li>Miscellaneous: N/A  </li> </ul> SOURCE ID <ul> <li>Question text: Source or handler ID  </li> <li>User notes: N/A  </li> <li>Question type: text field  </li> <li>Variable name: source_id (string)  </li> <li>Purpose: Associate an incident with an entity that is handling or reporting it. This may be a CERT, law enforcement agency, consortium body, or some other custodian/aggregator of incident data. If the incident is handled or reported by the victim, this field is unnecessary (the victim_id will suffice).  </li> <li>Developer notes: N/A  </li> <li>Miscellaneous: N/A  </li> </ul> INCIDENT CONFIRMATION <ul> <li>Question text: Was this a confirmed security incident?  </li> <li>User notes: \"Security incident\" refers to any incident/event/occurrence/issue (or whatever) that compromises (or negatively affects) a security attribute (C*I-A) of an information asset in any form. This is an intentionally broad definition. In the case of false positives or \u201cnear misses\u201d (unsuccessful attacks), the schema allows you to record the actor, action, and asset involved while leaving the attribute blank (since ascribing an attribute would imply the asset was negatively affected\u2026which would mean it qualifies as an incident).  </li> <li>Question type: Enumerated list (single-select)  </li> <li>Variable name: <code>security_incident</code> (string; enumeration)  </li> <li>Purpose: N/A  </li> <li>Developer notes: N/A  </li> <li>Miscellaneous: Designates confirmed incidents from those that are suspected or known non-incidents. One could, if desired, record information on a significant (but unsuccessful) attack while maintaining the ability to remove it from incident rollups and reporting (if desired).  </li> </ul> INCIDENT SUMMARY <ul> <li>Question text: Please provide a brief summary of the incident.  </li> <li>User notes: For each major event or phase in the incident, try to convey \"who did what to what/whom with what result?\" with as much detail as you deem appropriate. Consider, for example, the following scenario:  <ul> <li>Event 1: External attacker sends a phishing email to a victim employee to gain admin credentials.  </li> <li>Event 2: Employee visits a web link in the phishing email and downloads a keylogger to their desktop.  </li> <li>Event 3: Attacker uses stolen credentials to access the corporate network via legitimate remote access software and searches for sensitive data.  </li> <li>Event 4: Attacker installs a backdoor program and a packet sniffer on a web server to capture card data and store it locally.  </li> <li>Event 5: Attacker returns via the backdoor and exfiltrates the data.  </li> </ul> </li> <li>Question type: text field  </li> <li>Variable name: <code>summary</code> (string)  </li> <li>Purpose: Though the purpose of VERIS is to describe an incident using a structured format, capturing a short free-form narrative is still very useful for many reasons.  </li> <li>Developer notes: N/A  </li> <li>Miscellaneous: N/A  </li> </ul> RELATED INCIDENTS <ul> <li>Question text: For example, the incident shares the same threat actor, external IP address, malware hash, or other characteristics with incidents submitted previously.  </li> <li>Question type: text field  </li> <li>Variable name: <code>related_incidents</code> (string)  </li> <li>Purpose: Provides a simple and explicit way to associate different incidents.  </li> <li>Developer notes: N/A  </li> <li>Miscellaneous: This field can be used to link incidents in a larger campaign. To do this, simply generate some kind of shared identifier and record it in this field for each incident in the campaign. You'll be able to easily retrieve all incidents associated with that identifier when necessary.  </li> <li>Enumerations: N/A  </li> </ul> CONFIDENCE RATING <ul> <li>Question text: How certain are you that the information you provided about this incident is accurate?  </li> <li>User notes: N/A  </li> <li>Question type: Enumerated list (single-select)  </li> <li>Variable name: <code>confidence</code> (string; enumeration)  </li> <li>Purpose: Provides a level of confidence associated with the information submitted for this incident.  </li> <li>Developer notes: N/A  </li> <li>Miscellaneous: N/A  </li> </ul> INCIDENT NOTES <ul> <li>Question text: General incident notes.  </li> <li>User notes: Use this field to record general information, observations, etc., about the incident that are not captured by fields specified within VERIS. Each section has a similar place to record notes, and information specific to certain aspects of the incident (e.g., the threat actor involved) should be recorded in the appropriate section.  </li> <li>Question type: text field  </li> <li>Variable name: <code>notes</code> (string)  </li> <li>Purpose: Record general information, observations, etc., about the incident that are not captured by fields specified within VERIS.  </li> <li>Developer notes: N/A  </li> <li>Miscellaneous: N/A  </li> </ul>"},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#end-state","title":"End State","text":"<p>A commonly accessed database is set up for the team to record Incident Records for tracking purpose  </p>"},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#notes","title":"Notes","text":"<p>The intent of this Task is to create a common reporting structure for incidents so that they may be recorded accurately and shared as needed.  If Security Onion is used</p>"},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#manual-steps","title":"Manual Steps","text":""},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#running-script","title":"Running Script","text":""},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#dependencies","title":"Dependencies","text":""},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#other-available-tools","title":"Other available tools","text":""},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#references","title":"References","text":"<p>VERIS: the vocabulary for event recording and incident sharing </p>"},{"location":"1.Preparation/1.10-Incident_Tracking_and_Reporting/#revision-history","title":"Revision History","text":""},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/","title":"1.13-Review Information Security Policies Constraint","text":""},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#task-review-organizational-information-security-policy-and-constraints","title":"Task Review Organizational information security policy and constraints","text":""},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#conditions","title":"Conditions","text":""},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#standards","title":"Standards","text":"<p>During the pre-mission phase (and as part of the mission owner interview), request and review the organizations Information Technology (IT) and security policies and constraints. The IT policy documents can inform the CPT on whether (and under what conditions) VPN access is granted, removable media is used or how files are moved from one security fabric to another.  </p>"},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#end-state","title":"End State","text":""},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#notes","title":"Notes","text":""},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#manual-steps","title":"Manual Steps","text":""},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#running-script","title":"Running Script","text":""},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#dependencies","title":"Dependencies","text":""},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#other-available-tools","title":"Other available tools","text":""},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#references","title":"References","text":""},{"location":"1.Preparation/1.13-Review_Information_Security_Policies_Constraint/#revision-history","title":"Revision History","text":""},{"location":"1.Preparation/1.14-Request_Logs/","title":"1.14-Request Logs","text":""},{"location":"1.Preparation/1.14-Request_Logs/#task-request-for-logs-from-mission-owner","title":"Task Request for logs from mission owner","text":""},{"location":"1.Preparation/1.14-Request_Logs/#conditions","title":"Conditions","text":""},{"location":"1.Preparation/1.14-Request_Logs/#standards","title":"Standards","text":"<p>An IR Team should immediately request at least 30 days of logs from the Internet Access Provider (IAP), as well as, logs from the organizations proxy firewall, Domain Name System (DNS), Dynamic Host Configuration Protocol (DHCP) and host/network sensors. Ideally, the organization has 180 days of logs but frequently most of the data is over written in even less than 30 days.  </p>"},{"location":"1.Preparation/1.14-Request_Logs/#end-state","title":"End State","text":""},{"location":"1.Preparation/1.14-Request_Logs/#notes","title":"Notes","text":""},{"location":"1.Preparation/1.14-Request_Logs/#manual-steps","title":"Manual Steps","text":""},{"location":"1.Preparation/1.14-Request_Logs/#running-script","title":"Running Script","text":""},{"location":"1.Preparation/1.14-Request_Logs/#dependencies","title":"Dependencies","text":""},{"location":"1.Preparation/1.14-Request_Logs/#other-available-tools","title":"Other available tools","text":""},{"location":"1.Preparation/1.14-Request_Logs/#references","title":"References","text":""},{"location":"1.Preparation/1.14-Request_Logs/#revision-history","title":"Revision History","text":""},{"location":"1.Preparation/1.15-Interview_Network_Owner/","title":"1.15-Interview Network Owner","text":""},{"location":"1.Preparation/1.15-Interview_Network_Owner/#task-interview-mission-owner-to-identify-sensors-and-tools","title":"Task Interview mission owner to identify sensors and tools","text":""},{"location":"1.Preparation/1.15-Interview_Network_Owner/#conditions","title":"Conditions","text":""},{"location":"1.Preparation/1.15-Interview_Network_Owner/#standards","title":"Standards","text":"<p>An IR Team deploys to an existing network that may or may not have adequate sensors to complete the mission. It is important to discuss the existing sensors, network monitoring and cyber defense tools (e.g., firewalls, Security Event Information Manager (SIEM), forensics, malware detection, network discovery and mapping) with the mission owner to determine what is already in place as part of the mission preparation phase. Based on that interview and the tools available, open source best practices and capabilities), the CPT should discuss additional sensors or tools with the organizations Network owner to determine the tools that are needed for the mission.    </p>"},{"location":"1.Preparation/1.15-Interview_Network_Owner/#end-state","title":"End State","text":""},{"location":"1.Preparation/1.15-Interview_Network_Owner/#notes","title":"Notes","text":""},{"location":"1.Preparation/1.15-Interview_Network_Owner/#manual-steps","title":"Manual Steps","text":""},{"location":"1.Preparation/1.15-Interview_Network_Owner/#running-script","title":"Running Script","text":""},{"location":"1.Preparation/1.15-Interview_Network_Owner/#dependencies","title":"Dependencies","text":""},{"location":"1.Preparation/1.15-Interview_Network_Owner/#other-available-tools","title":"Other available tools","text":""},{"location":"1.Preparation/1.15-Interview_Network_Owner/#references","title":"References","text":"<p>Incident Respone Owner Interview Packet </p>"},{"location":"1.Preparation/1.15-Interview_Network_Owner/#revision-history","title":"Revision History","text":""},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/","title":"1.16-Establish Network Owner Priorities Objectives","text":""},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#task-establish-mission-owner-priorities-and-objectives","title":"Task Establish mission owner priorities and objectives","text":""},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#conditions","title":"Conditions","text":""},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#standards","title":"Standards","text":"<p>The IR Team should interview the business or mission owner to understand the missions and priorities.  Ask them what is required as a bare bones minimum in order not to fail and in order to succeed, as those may be two different things. Determine the capabilities (services, ports, software/ hardware, connectivity, confidentiality/integrity of the data and availability of systems).  </p>"},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#end-state","title":"End State","text":""},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#notes","title":"Notes","text":""},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#manual-steps","title":"Manual Steps","text":""},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#running-script","title":"Running Script","text":""},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#dependencies","title":"Dependencies","text":""},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#other-available-tools","title":"Other available tools","text":""},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#references","title":"References","text":""},{"location":"1.Preparation/1.16-Establish_Network_Owner_Priorities_Objectives/#revision-history","title":"Revision History","text":""},{"location":"1.Preparation/1.17-Establish_Mission_Log/","title":"1.17-Establish Mission Log","text":""},{"location":"1.Preparation/1.17-Establish_Mission_Log/#task-establish-mission-log","title":"Task Establish Mission Log","text":""},{"location":"1.Preparation/1.17-Establish_Mission_Log/#conditions","title":"Conditions","text":"<p>Given a network to defend establish system for mission logging  </p>"},{"location":"1.Preparation/1.17-Establish_Mission_Log/#standards","title":"Standards","text":"<ul> <li>Team conducts incident tracking utilizing Date-Time Group (DTG)  </li> <li>Team provides incident description  </li> <li>Team categorizes level of incident  </li> <li>Team enumerates discovery and response  </li> <li>Team utilizes report logs  </li> </ul>"},{"location":"1.Preparation/1.17-Establish_Mission_Log/#end-state","title":"End State","text":"<p>Mission log created within parameters of the standards  </p>"},{"location":"1.Preparation/1.17-Establish_Mission_Log/#manual-steps","title":"Manual Steps","text":"<ul> <li> <p>How to use the 9-line  </p> <ul> <li>Date/Time:  Indicate when it was discovered  </li> <li>Reporting Unit &amp; Region:  Input current org/unit representing(ie CALOES or CPT)  </li> <li>POC: Person who discovered the anomaly   </li> <li>File Name: Input the file name  </li> <li>Type: Category of infection  </li> <li>Hazards: Input understood method of infection  </li> <li>Threat: Level of incident category and capabilities  </li> <li>Impact: Determine level of impact  </li> <li>Protective Measures: Determine steps of possible mitigation techniques  </li> <li><code>9-Line does not leave client's premises</code> </li> </ul> </li> <li> <p>How to use the Federal Agency Incidents Categories Document  </p> <ul> <li>Reference all incident descriptions on the document. <code>Description</code> Column  </li> <li>By choosing the most applicable description, see the associated category (CAT) number. (left most column)  </li> <li>Ensure to be aware of and follow any associated time limitations in the column labeled <code>Reporting Timeframe</code> </li> <li>include selected <code>Category</code> in the Mission Log  </li> </ul> </li> <li> <p>How to Fill Out the Mission Log  </p> <ul> <li>Date/Time column: Insert the current date and time of your entry.  </li> <li>Category column: Reference the Federal Agency Incidents Categories (can be found in the References section below) in order to categorize the incident that is being worked on.  </li> <li>System/IP column: Insert the host name and IP address of the asset that is being worked on.  </li> <li>Technical Notes column: Insert the actions and modifications that were made on the asset being worked on (i.e. Name of script that was run, change of file permissions, copying of a file and moving it to another directory).  </li> <li>Summary column: Give a breakdown of all activites performed at the date and time in order to simplify an explanation of course of action (COA).  </li> <li>Operator column: Insert your name in this field following this format: RANK LASTNAME, FIRSTNAME MIDDLE INITIAL.  </li> </ul> </li> <li> <p>Team utilizes report logs  </p> <ul> <li>Consolidate mission logs into a summary of all findings for the day  </li> <li>Save consolidated mission log at the client*approved location  </li> <li>Sanitize client/victim data from summary report.  Save <code>sanitized</code> summary report in CPT archive  </li> </ul> </li> </ul>"},{"location":"1.Preparation/1.17-Establish_Mission_Log/#running-script","title":"Running Script","text":"<p>N/A  </p>"},{"location":"1.Preparation/1.17-Establish_Mission_Log/#dependencies","title":"Dependencies","text":"<p>Identify your limitations as far as utilization of tools on UNCLASSIFIED/CLASSIFIED networks  </p>"},{"location":"1.Preparation/1.17-Establish_Mission_Log/#other-available-tools","title":"Other available tools","text":"<p>N/A</p>"},{"location":"1.Preparation/1.17-Establish_Mission_Log/#references","title":"References","text":"<p>Federal Agency Incidents Categories Website Mission Log document Federal Agency Incidents Categories Spreadsheet Malware 9-Line Report template </p>"},{"location":"1.Preparation/1.17-Establish_Mission_Log/#revision-history","title":"Revision History","text":""},{"location":"1.Preparation/1.18-Request_Network_Accounts/","title":"1.18-Request Network Accounts","text":""},{"location":"1.Preparation/1.18-Request_Network_Accounts/#task-establish-network-access-accounts","title":"Task Establish network access accounts","text":""},{"location":"1.Preparation/1.18-Request_Network_Accounts/#conditions","title":"Conditions","text":"<p>Coordinate with CNDSP or mission owner network operations to gain network access accounts  </p>"},{"location":"1.Preparation/1.18-Request_Network_Accounts/#standards","title":"Standards","text":"<ul> <li>Identifying account types (End-User, Shared Credentials, Service Account, Application, Guest)  </li> <li>Work with mission partner POC to understand support requirements  </li> <li>Establishing conditions for group membership  </li> <li>Gaining approval for requests to establish network account access  </li> <li>Granting access to the system based on:   </li> <li>A valid access authorization  </li> <li>intended system usage  </li> <li>Other attributes as required by the organization or associated missions/business functions  </li> </ul>"},{"location":"1.Preparation/1.18-Request_Network_Accounts/#end-state","title":"End State","text":"<p>Gain network access accounts  </p>"},{"location":"1.Preparation/1.18-Request_Network_Accounts/#manual-steps","title":"Manual Steps","text":"<ul> <li>Identify an Account Manager from the Team [Team Leader]  </li> <li>Preliminary Site Survey to ensure all applicable network access is requested  </li> <li>Appropriate network groups and member roles are applied  </li> <li>Additional resource account creation if necessary  </li> <li>When in a Department of Defense setting, use referenced DD Form 2875  </li> <li>Interface with the customer organization liaison to submit request for desired actions  </li> <li>Monitors the use of information system accounts  </li> <li>Notify Client Organization of access changes  </li> <li>When accounts are no longer required  </li> <li>When users are terminated or transferred  </li> <li>When individual information system usage or need-to-know changes  </li> </ul>"},{"location":"1.Preparation/1.18-Request_Network_Accounts/#running-script","title":"Running Script","text":"<p>N/A  </p>"},{"location":"1.Preparation/1.18-Request_Network_Accounts/#dependencies","title":"Dependencies","text":"<p>Service-Member security clearance Applicable civilian credentials  </p>"},{"location":"1.Preparation/1.18-Request_Network_Accounts/#other-available-tools","title":"Other available tools","text":"<p>N/A  </p>"},{"location":"1.Preparation/1.18-Request_Network_Accounts/#references","title":"References","text":"<p>DD Form 2875.pdf NIST.SP.800-53r4.pdf </p>"},{"location":"1.Preparation/1.18-Request_Network_Accounts/#revision-history","title":"Revision History","text":""},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/","title":"1.19-Legal Authorities Regulatory Constraints","text":""},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#task-legal-authorities-and-regulatory-constraints","title":"Task Legal authorities and regulatory constraints","text":""},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#conditions","title":"Conditions","text":""},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#standards","title":"Standards","text":"<p>An IR Team will generally be operating under State legal authorities. Supporting a CIKR mission can bring in additional privacy and civil liberty constraints that should be discussed with the mission owner.  </p>"},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#end-state","title":"End State","text":""},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#notes","title":"Notes","text":""},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#manual-steps","title":"Manual Steps","text":""},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#running-script","title":"Running Script","text":""},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#dependencies","title":"Dependencies","text":""},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#other-available-tools","title":"Other available tools","text":""},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#references","title":"References","text":""},{"location":"1.Preparation/1.19-Legal_Authorities_Regulatory_Constraints/#revision-history","title":"Revision History","text":""},{"location":"1.Preparation/Preparation_References/","title":"Index","text":""},{"location":"1.Preparation/Preparation_References/#business-owner-packets-task","title":"Business Owner Packets Task","text":"<p>This packet will be provided to the Business Owner by the Team Leader. Once complete, the packet will be then be provided to the Mission Element Leads and the Analytics Support Officer, who will then provide a better refined packet, which contains only pertinent information, to the Intelligence Analysts.  </p>"},{"location":"2.Identification/","title":"2.Identification","text":""},{"location":"2.Identification/#identification-tasks","title":"Identification Tasks","text":"<p>Develop an organizational understanding to manage cybersecurity risk to systems, people, assets, data, and capabilities.  The activities in the Identify Function are foundational for effective use of the Framework. Understanding the business context, the resources that support critical functions, and the related cybersecurity risks enables an organization to focus and prioritize its efforts, consistent with its risk management strategy and business needs. Examples of outcome Categories within this Function include: Asset Management; Business Environment; Governance; Risk Assessment; and Risk Management Strategy.  </p>"},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/","title":"2.01-Review Organizational Processes and Conduct a site survey","text":""},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#task-understand-legal-authorities-and-regulatory-constraints-including-privacy-and-civil-liberties-obligations","title":"Task understand Legal authorities and regulatory constraints, including privacy and civil liberties obligations","text":""},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#conditions","title":"Conditions","text":""},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#standards","title":"Standards","text":"<p>The IR Team should gather information from the mission owner (and Network owner) about its domain, organizational processes, method of patch configuration management, privilege rights, training, cross-domain transfers, use of removable devices etc., prior to the site survey.  The CPT needs to receive, for example, a complete list of all workstations, servers, services, required applications, and trust requirements of the Domain(s) supported. Equally as important, the CPT needs to know the required services needed to run within the Domain and where these services can run.  (Example: a Domain Controller can run several rolls and services such as DHCP, DNS, and Active Directory.) It is important to remember that there may be workstations that reside in workgroups not jointed to the domain. A site survey is recommended, even though the mission owner theoretically can provide all information remotely. The site survey helps to establish the working relationships with the mission owner and can also result in the identifcation of devices and connections not previously disclosed.</p>"},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#end-state","title":"End State","text":""},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#notes","title":"Notes","text":""},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#manual-steps","title":"Manual Steps","text":""},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#running-script","title":"Running Script","text":""},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#dependencies","title":"Dependencies","text":""},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#other-available-tools","title":"Other available tools","text":""},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#references","title":"References","text":""},{"location":"2.Identification/2.01-Review_organizational_processes_and_conduct_a_site_survey/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.02-Create_Active_IP_List/","title":"2.02-Create Active IP List","text":""},{"location":"2.Identification/2.02-Create_Active_IP_List/#task-create-active-ip-list","title":"Task Create Active IP List","text":"<p>2.04 \u2013 Active_Host_and_Service_Enumeration 2.01 \u2013 Create a list of active IP addresses 2.05 \u2013 Create a list of active IP addresses with key ports included 2.07 \u2013 Scan ICS Equipment Ports 2.06 \u2013 Scan all ports of all hosts on given network segment  </p>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#conditions","title":"Conditions","text":"<p>Given a suspected compromised network segment(s), access to a system that can access and scan the identified network segment(s), and network scanning software included in the team\u2019s incident response kit.  </p>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#standards","title":"Standards","text":"<ul> <li>The team member identifies possibly compromised network segment(s).  </li> <li>The team member accesses a system that can scan the identified network segment(s).  </li> <li>The team member utilizes an IP-based network scanning utility to perform one of the following scanning tasksand directs the output to a text file for analysis:  <ul> <li>2.04 \u2013 Active_Host_and_Service_Enumeration  </li> <li>2.01 \u2013 Create a list of active IP addresses  </li> <li>2.05 \u2013 Create a list of active IP addresses with key ports included  </li> <li>2.07 \u2013 Scan ICS Equipment Ports  </li> <li>2.06 \u2013 Scan all ports of all hosts on given network segment  </li> </ul> </li> <li>The resulting scan data is compared to known network host data to determine anomalies present in the scanned network segment.  </li> </ul>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#end-state","title":"End State","text":"<p>All active hosts, ports and services are carefully enumerated based on the specific sub-task accomplished and any anomalies or mis-configurations are identified.  </p>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#manual-steps","title":"Manual Steps","text":"<p>A list of IP ranges can be provided by using the <code>-f IPRanges</code> option; otherwise, a range can be specified with <code>-i IPRange</code>. For each BD, the script will need to be ran. The script will need to be marked executable before running:  </p> <ul> <li> <p>Make the script executable <pre><code>chmod +x NmapScript.sh  \n</code></pre></p> </li> <li> <p>For Task 2.04, run the NmapScript.sh and choose menu 1     ```  </p> <ol> <li>2.04 \u2013 Active_Host_and_Service_Enumeration  </li> <li>2.01 \u2013 Create a list of active IP addresses  </li> <li>2.05 \u2013 Create a list of active IP addresses with key ports included  </li> <li>2.07 \u2013 Scan ICS Equipment Ports  </li> <li>2.06 \u2013 Scan all ports of all hosts on given network segment   </li> <li>Exit  </li> </ol> <p>Selection:&gt; 1    ```  </p> </li> <li> <p>A log will be generated to NmapScript.txt and the output will be shown to the user: <pre><code>Selection:&gt; 1  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:47 EDT  \n[+] Nmap scan report for 192.168.69.2  \n[+] Host is up (0.00084s latency).  \n[+] Not shown: 999 closed ports  \n[+] PORT   STATE SERVICE VERSION  \n[+] 53/tcp open  domain  dnsmasq 2.55  \n[+] MAC Address: 00:50:56:EB:3D:1D (VMware)  \n\n[+] Service detection performed. Please report any incorrect results at https://nmap.org/submit/.  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 17.23 seconds  \n</code></pre></p> </li> <li> <p>For Task 2.04, run the NmapScript.sh and choose menu 2 <code>Selection:&gt; 2       [+] 192.168.69.1 is live!       [+] 192.168.69.2 is live!       [+] 192.168.69.142 is live!       [+] 192.168.69.254 is live!       [+] 192.168.69.132 is live!       [+] 192.168.69.137 is live!</code></p> </li> <li> <p>For Task 2.02, run the NmapScript.sh and choose menu 3. It is important to provide key ports interested. If any ports are open on the targets, they will get displayed; otherwise, you will have no output. <pre><code>Selection:&gt; 3  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:56 EDT  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds  \n</code></pre></p> </li> <li> <p>For Task 2.07, run the script and choose menu 4. This will scan for ports on ICS equipment. This will warn you if you would like to continue. <pre><code>Selection:&gt; 4  \n[!] It is possible for Scada devices to fail with an Nmap scan, do you want to continue? Y  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:59 EDT  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds  \n</code></pre></p> </li> <li> <p>For Task 2.06, run the script and choose menu 5. This will scan for all ports on the target/target list. <pre><code>Selection:&gt; 5  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 14:01 EDT  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds  \n</code></pre></p> </li> </ul>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#dependencies","title":"Dependencies","text":"<ul> <li>If NMap is not installed: <pre><code>sudo apt install nmap  \n</code></pre></li> </ul>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#other-available-tools","title":"Other available tools","text":"<ul> <li>Angry IP scanner  </li> <li>Advanced IP Scanner  </li> <li>Solarwinds IP Scanner  </li> </ul>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#references","title":"References","text":"<p>NMAP Site LAN Spy NMAP Man Pages Nmap Man page Nmap Network Scanning \u2013online book </p>"},{"location":"2.Identification/2.02-Create_Active_IP_List/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/","title":"2.03-DNS Host Name Mapping","text":""},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#task-dns-host-name-mapping","title":"Task DNS Host Name Mapping","text":""},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#conditions","title":"Conditions","text":"<p>Given a responder\u2019s computer, a known network topology including IP address ranges, and the proper tools to map network hosts.  </p>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#standards","title":"Standards","text":"<ul> <li>Team member selects an appropriate tool for conducting host scans of the network  </li> <li>Team member configures the tool to do a full or partial (i.e., per subnet) scan of the network and saves the results to a text or comma-separated values (CSV) file  </li> </ul>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#end-state","title":"End State","text":"<ul> <li>A list of all accessible computers within the given IP ranges are listed with their domain name and IP addresses  </li> <li>These scripts are meant to be an Out-Of-the-Box (OOB) solution to Cybersecurity Operations  </li> <li>All scripts are open source and can be branched/edited as needed  </li> </ul>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#manual-steps","title":"Manual Steps","text":"<p>There are multiple tools available to scan network IP ranges and determine their host names. While a simple ping scan using the built-in Ping tool in Windows will work, the difficulty is that some Operating Systems (OS) block ICMP pings by default. Additionally network administrators may institute a firewall policy to block ICMP across the Enterprise. In those cases a simple ping sweep will not work. In this case, other 3<sup>rd</sup>-party tools will be more effective, Nmap being one of the most effective.  </p> <ul> <li>Example Host Discovery scan with Nmap:  On a network with working DNS server, this scan will return all live hosts on this network. For network hosts that do not synch with the local DHCP or DNS server this scan may not return the host name. <pre><code>nmap -sn 192.168.1.0/24  \n</code></pre></li> </ul> <p>If the above scan does not return hostnames (poorly configured DNS issues), then the following script can be run to further enumerate Windows hosts and possible return the hostname: <pre><code>nmap -sU \u2013script nbstsat.nse -p137 192.168.1.0/24  \n</code></pre></p> <p>Output should be in the format identified in 'output_format_template.csv' and named [mm/dd/yyyy_hhss_DNS_HOSTNAME_Mapping_(xx.xx.xx.xx/x)]  </p> <p>Notify mission element lead and intelligence analyst of completion of this Task  </p>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#running-script","title":"Running Script","text":"<ul> <li>Runs the script as Admin for full capabilities  </li> <li>Script execution is menu driven  </li> <li>Ensure the script is executable  </li> <li>Linux: <code>chmod 755 dns_hostname_mapping.py</code> </li> <li>Windows: Right-click script file, Properties/Unblock  </li> <li>Execute the script: <code>python dns_hostname_mapping.py</code> </li> <li>Execute the script using Python3.6+: <code>python3 dns_hostname_mapping_py3.py</code> </li> <li>Select a menu option  </li> <li>Specify the IP address range to be scanned  </li> <li>Specify the path and filename for output files  </li> </ul>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#dependencies","title":"Dependencies","text":"<p>Python 3.6+ Nmap </p>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#other-available-tools","title":"Other available tools","text":""},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#references","title":"References","text":"<p>NMAP Discovery NMAP Host Discovery NMAP NBTSTAT </p>"},{"location":"2.Identification/2.03-DNS_Host_Name_Mapping/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/","title":"2.04-Active Host and Service Enumeration","text":""},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#task-active-host-and-service-enumeration","title":"Task Active Host and Service Enumeration","text":"<p>2.04 \u2013 Active_Host_and_Service_Enumeration 2.01 \u2013 Create a list of active IP addresses 2.05 \u2013 Create a list of active IP addresses with key ports included 2.07 \u2013 Scan ICS Equipment Ports 2.06 \u2013 Scan all ports of all hosts on given network segment  </p>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#conditions","title":"Conditions","text":"<p>Given a suspected compromised network segment(s), access to a system that can access and scan the identified network segment(s), and network scanning software included in the team\u2019s incident response kit.  </p>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#standards","title":"Standards","text":"<ul> <li>The team member identifies possibly compromised network segment(s).  </li> <li>The team member accesses a system that can scan the identified network segment(s).  </li> <li>The team member utilizes an IP-based network scanning utility to perform one of the following scanning tasksand directs the output to a text file for analysis:  <ul> <li>2.04 \u2013 Active_Host_and_Service_Enumeration  </li> <li>2.01 \u2013 Create a list of active IP addresses  </li> <li>2.05 \u2013 Create a list of active IP addresses with key ports included  </li> <li>2.07 \u2013 Scan ICS Equipment Ports  </li> <li>2.06 \u2013 Scan all ports of all hosts on given network segment  </li> </ul> </li> <li>The resulting scan data is compared to known network host data to determine anomalies present in the scanned network segment.  </li> </ul>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#end-state","title":"End State","text":"<p>All active hosts, ports and services are carefully enumerated based on the specific sub-task accomplished and any anomalies or mis-configurations are identified.  </p>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#manual-steps","title":"Manual Steps","text":"<p>A list of IP ranges can be provided by using the <code>-f IPRanges</code> option; otherwise, a range can be specified with <code>-i IPRange</code>. For each BD, the script will need to be ran. The script will need to be marked executable before running:  </p> <ul> <li> <p>Make the script executable <pre><code>chmod +x NmapScript.sh  \n</code></pre></p> </li> <li> <p>For Task 2.04, run the NmapScript.sh and choose menu 1 <pre><code>1. 2.04 \u2013 Active_Host_and_Service_Enumeration  \n2. 2.01 \u2013 Create a list of active IP addresses  \n3. 2.05 \u2013 Create a list of active IP addresses with key ports included  \n4. 2.07 \u2013 Scan ICS Equipment Ports  \n5. 2.06 \u2013 Scan all ports of all hosts on given network segment   \n6. Exit  \n\nSelection:&gt; 1  \n</code></pre></p> </li> <li> <p>A log will be generated to NmapScript.txt and the output will be shown to the user: <pre><code>Selection:&gt; 1  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:47 EDT  \n[+] Nmap scan report for 192.168.69.2  \n[+] Host is up (0.00084s latency).  \n[+] Not shown: 999 closed ports  \n[+] PORT   STATE SERVICE VERSION  \n[+] 53/tcp open  domain  dnsmasq 2.55  \n[+] MAC Address: 00:50:56:EB:3D:1D (VMware)  \n\n[+] Service detection performed. Please report any incorrect results at https://nmap.org/submit/.  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 17.23 seconds  \n</code></pre></p> </li> <li> <p>For Task 2.04, run the NmapScript.sh and choose menu 2 <pre><code>Selection:&gt; 2  \n[+] 192.168.69.1 is live!  \n[+] 192.168.69.2 is live!  \n[+] 192.168.69.142 is live!  \n[+] 192.168.69.254 is live!  \n[+] 192.168.69.132 is live!  \n[+] 192.168.69.137 is live!  \n</code></pre></p> </li> <li> <p>For Task 2.02, run the NmapScript.sh and choose menu 3. It is important to provide key ports interested. If any ports are open on the targets, they will get displayed; otherwise, you will have no output. <pre><code>Selection:&gt; 3  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:56 EDT  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds  \n</code></pre></p> </li> <li> <p>For Task 2.07, run the script and choose menu 4. This will scan for ports on ICS equipment. This will warn you if you would like to continue. <pre><code>Selection:&gt; 4  \n[!] It is possible for Scada devices to fail with an Nmap scan, do you want to continue? Y  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:59 EDT  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds  \n</code></pre></p> </li> <li> <p>For Task 2.06, run the script and choose menu 5. This will scan for all ports on the target/target list. <pre><code>Selection:&gt; 5  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 14:01 EDT  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds  \n</code></pre></p> </li> </ul>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#dependencies","title":"Dependencies","text":"<ul> <li>If NMap is not installed: <pre><code>sudo apt install nmap  \n</code></pre></li> </ul>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#other-available-tools","title":"Other available tools","text":"<ul> <li>Angry IP scanner  </li> <li>Advanced IP Scanner  </li> <li>Solarwinds IP Scanner  </li> </ul>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#references","title":"References","text":"<p>NMAP Site LAN Spy NMAP Man Pages Nmap Man page Nmap Network Scanning \u2013online book </p>"},{"location":"2.Identification/2.04-Active_Host_and_Service_Enumeration/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/","title":"2.05-Active IP List on Key Ports","text":""},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#task-active-ip-list-on-key-ports","title":"Task Active IP List on key ports","text":"<p>2.04 \u2013 Active_Host_and_Service_Enumeration 2.01 \u2013 Create a list of active IP addresses 2.05 \u2013 Create a list of active IP addresses with key ports included 2.07 \u2013 Scan ICS Equipment Ports 2.06 \u2013 Scan all ports of all hosts on given network segment  </p>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#conditions","title":"Conditions","text":"<p>Given a suspected compromised network segment(s), access to a system that can access and scan the identified network segment(s), and network scanning software included in the team\u2019s incident response kit.  </p>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#standards","title":"Standards","text":"<ul> <li>The team member identifies possibly compromised network segment(s).  </li> <li>The team member accesses a system that can scan the identified network segment(s).  </li> <li>The team member utilizes an IP-based network scanning utility to perform one of the following scanning tasksand directs the output to a text file for analysis:  <ul> <li>2.04 \u2013 Active_Host_and_Service_Enumeration  </li> <li>2.01 \u2013 Create a list of active IP addresses  </li> <li>2.05 \u2013 Create a list of active IP addresses with key ports included  </li> <li>2.07 \u2013 Scan ICS Equipment Ports  </li> <li>2.06 \u2013 Scan all ports of all hosts on given network segment  </li> </ul> </li> <li>The resulting scan data is compared to known network host data to determine anomalies present in the scanned network segment.  </li> </ul>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#end-state","title":"End State","text":"<p>All active hosts, ports and services are carefully enumerated based on the specific sub-task accomplished and any anomalies or mis-configurations are identified.  </p>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#manual-steps","title":"Manual Steps","text":"<p>A list of IP ranges can be provided by using the <code>-f IPRanges</code> option; otherwise, a range can be specified with <code>-i IPRange</code>. For each BD, the script will need to be ran. The script will need to be marked executable before running:  </p> <ul> <li> <p>Make the script executable <pre><code>chmod +x NmapScript.sh  \n</code></pre></p> </li> <li> <p>For Task 2.04, run the NmapScript.sh and choose menu 1 <pre><code>1. 2.04 \u2013 Active_Host_and_Service_Enumeration  \n2. 2.01 \u2013 Create a list of active IP addresses  \n3. 2.05 \u2013 Create a list of active IP addresses with key ports included  \n4. 2.07 \u2013 Scan ICS Equipment Ports  \n5. 2.06 \u2013 Scan all ports of all hosts on given network segment   \n6. Exit  \n\nSelection:&gt; 1  \n</code></pre></p> </li> <li> <p>A log will be generated to NmapScript.txt and the output will be shown to the user: <pre><code>Selection:&gt; 1  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:47 EDT  \n[+] Nmap scan report for 192.168.69.2  \n[+] Host is up (0.00084s latency).  \n[+] Not shown: 999 closed ports  \n[+] PORT   STATE SERVICE VERSION  \n[+] 53/tcp open  domain  dnsmasq 2.55  \n[+] MAC Address: 00:50:56:EB:3D:1D (VMware)  \n\n[+] Service detection performed. Please report any incorrect results at https://nmap.org/submit/.  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 17.23 seconds  \n</code></pre></p> </li> <li> <p>For Task 2.04, run the NmapScript.sh and choose menu 2 <pre><code>Selection:&gt; 2  \n[+] 192.168.69.1 is live!  \n[+] 192.168.69.2 is live!  \n[+] 192.168.69.142 is live!  \n[+] 192.168.69.254 is live!  \n[+] 192.168.69.132 is live!  \n[+] 192.168.69.137 is live!  \n</code></pre></p> </li> <li> <p>For Task 2.02, run the NmapScript.sh and choose menu 3. It is important to provide key ports interested. If any ports are open on the targets, they will get displayed; otherwise, you will have no output. <pre><code>Selection:&gt; 3  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:56 EDT  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds  \n</code></pre></p> </li> <li> <p>For Task 2.07, run the script and choose menu 4. This will scan for ports on ICS equipment. This will warn you if you would like to continue. <pre><code>Selection:&gt; 4  \n[!] It is possible for Scada devices to fail with an Nmap scan, do you want to continue? Y  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:59 EDT  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds  \n</code></pre></p> </li> <li> <p>For Task 2.06, run the script and choose menu 5. This will scan for all ports on the target/target list. <pre><code>Selection:&gt; 5  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 14:01 EDT  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds  \n</code></pre></p> </li> </ul>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#dependencies","title":"Dependencies","text":"<ul> <li>If NMap is not installed: <pre><code>sudo apt install nmap  \n</code></pre></li> </ul>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#other-available-tools","title":"Other available tools","text":"<ul> <li>Angry IP scanner  </li> <li>Advanced IP Scanner  </li> <li>Solarwinds IP Scanner  </li> </ul>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#references","title":"References","text":"<p>NMAP Site LAN Spy NMAP Man Pages Nmap Man page Nmap Network Scanning \u2013online book </p>"},{"location":"2.Identification/2.05-Active_IP_List_on_Key_Ports/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.06-All_Port_Scan/","title":"2.06-All Port Scan","text":""},{"location":"2.Identification/2.06-All_Port_Scan/#task-all-port-scan","title":"TAsk All port scan","text":"<p>2.04 \u2013 Active_Host_and_Service_Enumeration 2.01 \u2013 Create a list of active IP addresses 2.05 \u2013 Create a list of active IP addresses with key ports included 2.07 \u2013 Scan ICS Equipment Ports 2.06 \u2013 Scan all ports of all hosts on given network segment  </p>"},{"location":"2.Identification/2.06-All_Port_Scan/#conditions","title":"Conditions","text":"<p>Given a suspected compromised network segment(s), access to a system that can access and scan the identified network segment(s), and network scanning software included in the team\u2019s incident response kit.  </p>"},{"location":"2.Identification/2.06-All_Port_Scan/#standards","title":"Standards","text":"<ul> <li>The team member identifies possibly compromised network segment(s).  </li> <li>The team member accesses a system that can scan the identified network segment(s).  </li> <li>The team member utilizes an IP-based network scanning utility to perform one of the following scanning tasksand directs the output to a text file for analysis:  <ul> <li>2.04 \u2013 Active_Host_and_Service_Enumeration  </li> <li>2.01 \u2013 Create a list of active IP addresses  </li> <li>2.05 \u2013 Create a list of active IP addresses with key ports included  </li> <li>2.07 \u2013 Scan ICS Equipment Ports  </li> <li>2.06 \u2013 Scan all ports of all hosts on given network segment  </li> </ul> </li> <li>The resulting scan data is compared to known network host data to determine anomalies present in the scanned network segment.  </li> </ul>"},{"location":"2.Identification/2.06-All_Port_Scan/#end-state","title":"End State","text":"<p>All active hosts, ports and services are carefully enumerated based on the specific sub-task accomplished and any anomalies or mis-configurations are identified.  </p>"},{"location":"2.Identification/2.06-All_Port_Scan/#manual-steps","title":"Manual Steps","text":"<p>A list of IP ranges can be provided by using the <code>-f IPRanges</code> option; otherwise, a range can be specified with <code>-i IPRange</code>. For each BD, the script will need to be ran. The script will need to be marked executable before running:  </p> <ul> <li> <p>Make the script executable <pre><code>chmod +x NmapScript.sh  \n</code></pre></p> </li> <li> <p>For Task 2.04, run the NmapScript.sh and choose menu 1 <pre><code>1. 2.04 \u2013 Active_Host_and_Service_Enumeration  \n2. 2.01 \u2013 Create a list of active IP addresses  \n3. 2.05 \u2013 Create a list of active IP addresses with key ports included  \n4. 2.07 \u2013 Scan ICS Equipment Ports  \n5. 2.06 \u2013 Scan all ports of all hosts on given network segment   \n6. Exit  \n\nSelection:&gt; 1  \n</code></pre></p> </li> <li> <p>A log will be generated to NmapScript.txt and the output will be shown to the user: <pre><code>Selection:&gt; 1  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:47 EDT  \n[+] Nmap scan report for 192.168.69.2  \n[+] Host is up (0.00084s latency).  \n[+] Not shown: 999 closed ports  \n[+] PORT   STATE SERVICE VERSION  \n[+] 53/tcp open  domain  dnsmasq 2.55  \n[+] MAC Address: 00:50:56:EB:3D:1D (VMware)  \n\n[+] Service detection performed. Please report any incorrect results at https://nmap.org/submit/.  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 17.23 seconds  \n</code></pre></p> </li> <li> <p>For Task 2.04, run the NmapScript.sh and choose menu 2 <pre><code>Selection:&gt; 2  \n[+] 192.168.69.1 is live!  \n[+] 192.168.69.2 is live!  \n[+] 192.168.69.142 is live!  \n[+] 192.168.69.254 is live!  \n[+] 192.168.69.132 is live!  \n[+] 192.168.69.137 is live!  \n</code></pre></p> </li> <li> <p>For Task 2.02, run the NmapScript.sh and choose menu 3. It is important to provide key ports interested. If any ports are open on the targets, they will get displayed; otherwise, you will have no output. <pre><code>Selection:&gt; 3  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:56 EDT  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds  \n</code></pre></p> </li> <li> <p>For Task 2.07, run the script and choose menu 4. This will scan for ports on ICS equipment. This will warn you if you would like to continue. <pre><code>Selection:&gt; 4  \n[!] It is possible for Scada devices to fail with an Nmap scan, do you want to continue? Y  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:59 EDT  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds  \n</code></pre></p> </li> <li> <p>For Task 2.06, run the script and choose menu 5. This will scan for all ports on the target/target list. <pre><code>Selection:&gt; 5  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 14:01 EDT  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds  \n</code></pre></p> </li> </ul>"},{"location":"2.Identification/2.06-All_Port_Scan/#dependencies","title":"Dependencies","text":"<ul> <li>If NMap is not installed: <pre><code>sudo apt install nmap  \n</code></pre></li> </ul>"},{"location":"2.Identification/2.06-All_Port_Scan/#other-available-tools","title":"Other available tools","text":"<ul> <li>Angry IP scanner  </li> <li>Advanced IP Scanner  </li> <li>Solarwinds IP Scanner  </li> </ul>"},{"location":"2.Identification/2.06-All_Port_Scan/#references","title":"References","text":"<p>NMAP Site LAN Spy NMAP Man Pages Nmap Man page Nmap Network Scanning \u2013online book </p>"},{"location":"2.Identification/2.06-All_Port_Scan/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/","title":"2.07-Scan ICS Equipment Ports","text":""},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#task-scan-ics-equipment-ports","title":"Task Scan ICS Equipment Ports","text":"<p>2.04 \u2013 Active_Host_and_Service_Enumeration 2.01 \u2013 Create a list of active IP addresses 2.05 \u2013 Create a list of active IP addresses with key ports included 2.07 \u2013 Scan ICS Equipment Ports 2.06 \u2013 Scan all ports of all hosts on given network segment  </p>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#conditions","title":"Conditions","text":"<p>Given a suspected compromised network segment(s), access to a system that can access and scan the identified network segment(s), and network scanning software included in the team\u2019s incident response kit.  </p>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#standards","title":"Standards","text":"<ul> <li>The team member identifies possibly compromised network segment(s).  </li> <li>The team member accesses a system that can scan the identified network segment(s).  </li> <li>The team member utilizes an IP-based network scanning utility to perform one of the following scanning tasksand directs the output to a text file for analysis:  <ul> <li>2.04 \u2013 Active_Host_and_Service_Enumeration  </li> <li>2.01 \u2013 Create a list of active IP addresses  </li> <li>2.05 \u2013 Create a list of active IP addresses with key ports included  </li> <li>2.07 \u2013 Scan ICS Equipment Ports  </li> <li>2.06 \u2013 Scan all ports of all hosts on given network segment  </li> </ul> </li> <li>The resulting scan data is compared to known network host data to determine anomalies present in the scanned network segment.  </li> </ul>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#end-state","title":"End State","text":"<p>All active hosts, ports and services are carefully enumerated based on the specific sub-task accomplished and any anomalies or mis-configurations are identified.  </p>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#manual-steps","title":"Manual Steps","text":"<p>A list of IP ranges can be provided by using the <code>-f IPRanges</code> option; otherwise, a range can be specified with <code>-i IPRange</code>. For each BD, the script will need to be ran. The script will need to be marked executable before running:  </p> <ul> <li> <p>Make the script executable <pre><code>chmod +x NmapScript.sh  \n</code></pre></p> </li> <li> <p>For Task 2.04, run the NmapScript.sh and choose menu 1 <pre><code>1. 2.04 \u2013 Active_Host_and_Service_Enumeration  \n2. 2.01 \u2013 Create a list of active IP addresses  \n3. 2.05 \u2013 Create a list of active IP addresses with key ports included  \n4. 2.07 \u2013 Scan ICS Equipment Ports  \n5. 2.06 \u2013 Scan all ports of all hosts on given network segment   \n6. Exit  \n\nSelection:&gt; 1  \n</code></pre></p> </li> <li> <p>A log will be generated to NmapScript.txt and the output will be shown to the user: <pre><code>Selection:&gt; 1  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:47 EDT  \n[+] Nmap scan report for 192.168.69.2  \n[+] Host is up (0.00084s latency).  \n[+] Not shown: 999 closed ports  \n[+] PORT   STATE SERVICE VERSION  \n[+] 53/tcp open  domain  dnsmasq 2.55  \n[+] MAC Address: 00:50:56:EB:3D:1D (VMware)  \n\n[+] Service detection performed. Please report any incorrect results at https://nmap.org/submit/.  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 17.23 seconds  \n</code></pre></p> </li> <li> <p>For Task 2.04, run the NmapScript.sh and choose menu 2 <pre><code>Selection:&gt; 2  \n[+] 192.168.69.1 is live!  \n[+] 192.168.69.2 is live!  \n[+] 192.168.69.142 is live!  \n[+] 192.168.69.254 is live!  \n[+] 192.168.69.132 is live!  \n[+] 192.168.69.137 is live!  \n</code></pre></p> </li> <li> <p>For Task 2.02, run the NmapScript.sh and choose menu 3. It is important to provide key ports interested. If any ports are open on the targets, they will get displayed; otherwise, you will have no output. <pre><code>Selection:&gt; 3  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:56 EDT  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds  \n</code></pre></p> </li> <li> <p>For Task 2.07, run the script and choose menu 4. This will scan for ports on ICS equipment. This will warn you if you would like to continue. <pre><code>Selection:&gt; 4  \n[!] It is possible for Scada devices to fail with an Nmap scan, do you want to continue? Y  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 13:59 EDT  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds  \n</code></pre></p> </li> <li> <p>For Task 2.06, run the script and choose menu 5. This will scan for all ports on the target/target list. <pre><code>Selection:&gt; 5  \n[+] Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 14:01 EDT  \n[+] Nmap done: 256 IP addresses (6 hosts up) scanned in 3.41 seconds  \n</code></pre></p> </li> </ul>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#dependencies","title":"Dependencies","text":"<ul> <li>If NMap is not installed: <pre><code>sudo apt install nmap  \n</code></pre></li> </ul>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#other-available-tools","title":"Other available tools","text":"<ul> <li>Angry IP scanner  </li> <li>Advanced IP Scanner  </li> <li>Solarwinds IP Scanner  </li> </ul>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#references","title":"References","text":"<p>NMAP Site LAN Spy NMAP Man Pages Nmap Man page Nmap Network Scanning \u2013online book </p>"},{"location":"2.Identification/2.07-Scan_ICS_Equipment_Ports/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/","title":"2.08-Perform Vulnerability Scan","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#task-conduct-vulnerability-scan-of-network-host","title":"Task Conduct Vulnerability Scan of Network Host","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#conditions","title":"Conditions","text":"<p>Given a host with local administrator credentials, an incident response workstation, network access, and a vulnerability assessment tool   </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#standards","title":"Standards","text":"<ul> <li>Team member verifies network connectivity to the host using the host IP address  </li> <li>Team member assures the vulnerability assessment tool is using the latest updates and signatures of the selected tool  </li> <li>Team member configures the vulnerability assessment tool with the IP address of the host  </li> <li>Team member selects assessment options within the tool based on testing level required   </li> <li>Note: Some tests can cause denial of service to host and will need to be evaluated before beginning of assessment  </li> <li>Team member runs the assessment with selected options and monitors progress  </li> <li>Team member evaluates the results of the assessment and determines if critical or high vulnerabilities exist on the test machine  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#end-state","title":"End State","text":"<p>All vulnerabilities on the test machine are found and critical or high results are evaluated for remediation  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#manual-steps","title":"Manual Steps","text":"<ul> <li>Determine if the client/victim currently have designated in-house vulnerability tools  </li> <li>Identify if the customer has a service account to conduct your scans. See Task 1.18 Establish Network Access Accounts </li> <li>Request a network topolgy from the network owner(if available)  </li> <li>Verify network topology with a ping sweep   </li> <li>Establish and separate vulnerability scan groups by Operating Systems(Win/Linux)  </li> <li>Narrow vulnerability scans prevent false results  </li> <li>Verify the credentials you are using to scan have:  </li> <li><code>Sudo</code> privilege for Unix/Linux  </li> <li><code>Administrator group</code> for Windows  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#optional-tools","title":"Optional Tools:","text":"<p>Nessus OpenVAS Kali OpenVAS Ubuntu </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#running-script","title":"Running Script","text":"<p>N/A</p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#dependencies","title":"Dependencies","text":"<p>Network access accounts: * Administrative group(Windows/Mac) * Sudo privilege(Unix/Linux)   </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#references","title":"References","text":"<p>OpenVAS Nessus Greenbone Vulnerability Manager Installation Guide </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/","title":"NESSUS","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#task-nessus-utilization-guide","title":"Task Nessus Utilization Guide","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#conditions","title":"Conditions","text":"<p>Utilizing the provided Administrative credentials with domain privileges, run vulnerability scans on servers and hosts.  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#standards","title":"Standards","text":"<ul> <li>Setup Nessus  </li> <li>Conduct vulnerability scan  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#end-state","title":"End State","text":"<p>Completed a vulnerability scan utilizing Nessus  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#manual-steps","title":"Manual Steps","text":"<ul> <li>Accessing Nessus Manager  </li> <li>You can access the Nessus Manager/Scanner web interface at: https://localhost:8834 </li> </ul> <ul> <li>Conducting a Vulnerability Assessment  </li> <li>Creating a scan  <ul> <li>In the top navigation bar, click <code>Scans</code> </li> <li>In the upper-right corner of the <code>My Scans</code> page, click the <code>New Scan</code> button  </li> </ul> </li> </ul> <ul> <li>Choose a Scan Template  </li> <li>Click on <code>Basic Network Scan</code> and select <code>Settings</code> tab  </li> </ul> <ul> <li>Configure Scan Settings  </li> <li>The following are Basic settings:  <ul> <li><code>Name</code> - Specifies the name of the scan or policy. This value is displayed on the Nessus interface.</li> <li><code>Description</code> - (Optional) Specifies a description of the scan or policy.</li> <li><code>Folder</code> - Specifies the folder where the scan appears after being saved.</li> <li><code>Targets</code> - Specifies one or more targets to be scanned. If you select a target group or upload a targets file, you are not required to specify additional targets. Input IP range(s) inside the <code>Targets</code> field  </li> </ul> </li> </ul> <ul> <li>Configure Credentials  </li> <li>Click <code>Credentials</code> tab  </li> <li>Select <code>Windows</code> </li> <li>Use the Administrator credentials and domain  </li> <li>Click <code>Save</code> and select <code>Launch Scan</code> </li> </ul> <ul> <li>Viewing Your Results  </li> <li>click on <code>My Scans</code> </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#running-script","title":"Running Script","text":"<p>N/A  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#dependencies","title":"Dependencies","text":"<p>N/A  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#other-available-tools","title":"Other available tools","text":"<p>N/A</p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#references","title":"References","text":"<p>Nessus Vulnerability Scanning</p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/NESSUS/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/","title":"OPENVAS(KALI)","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#task-openvas-uitilization-guide-for-kali-linux","title":"Task OpenVAS Uitilization Guide for Kali Linux","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#conditions","title":"Conditions","text":"<p>Utilizing the provided sudo privileges, run vulnerability scans on UNIX/Linux hosts  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#standards","title":"Standards","text":"<ul> <li>Setup OpenVAS on Kali Linux  </li> <li>Conduct vulnerability scan  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#end-state","title":"End State","text":"<p>Completed a vulnerability scan utilizing OpenVAS via Kali Linux  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#1-openvas-verification","title":"1. OpenVAS \u2013 Verification","text":"<ul> <li>Verify ONLY if OpenVAS is installed already. If OpenVAS(GVM) is not installed, move onto Step 2 From a terminal shell as root type the following: <pre><code>$ openvas-check-setup\n</code></pre></li> </ul> <p>Verify that all checks are good and openvas responds with OK  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#2-openvas-greenbone-vulnerability-manager-installation-for-kali-linux","title":"2. (OpenVAS) Greenbone Vulnerability Manager Installation for Kali Linux","text":"<ul> <li> <p>Install the packages through <code>apt install openvas</code> <pre><code>apt update\napt upgrade\napt install openvas\n</code></pre></p> </li> <li> <p>Configuration <pre><code>openvas-setup\n</code></pre></p> </li> <li> <p>Verify that the Green Security Assistant Daemon (gsad) is in a running and listening status <pre><code>netstat -apn | grep LISTEN\n</code></pre></p> </li> </ul> <p>You should see something like the following output: <pre><code>tcp    0  0 127.0.0.1:9390      0.0.0.0:*           LISTEN      128108/openvasmd    \ntcp    0  0 127.0.0.1:80        0.0.0.0:*           LISTEN      128112/gsad         \ntcp    0  0 127.0.0.1:9392      0.0.0.0:*           LISTEN      128106/gsad\n</code></pre></p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#2a-openvas-verify-all-signatures-and-feeds-are-up-to-date","title":"2a. OpenVAS \u2013 Verify all signatures and feeds are up-to-date","text":"<ul> <li>Access the OpenVAS web front-end at <code>https://localhost:9392/</code>. To access the web front-end interface from another node, use the following format: <code>https://hostname:9392/</code> </li> <li>Click on <code>Administration -&gt; NVT Feed</code> and verify that the Feed Version is the latest version Format is in the form of a timestamp: <code>YYYYMMDDHHSS</code> </li> <li>Completed the above for all feeds under Administration Menu, or to update all feeds from the terminal type the following: <pre><code>openvas-nvt-sync\n</code></pre></li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#3-openvas-simple-scan","title":"3. OpenVAS \u2013 Simple Scan","text":"<ul> <li>Access the OpenVAS web front-end at <code>https://localhost:9392/</code>. To access the web front-end interface from another node, use the following format: <code>https://hostname:9392/</code> </li> <li> <p>If you do not know the username and password see [Note 2] below  </p> </li> <li> <p>Enter the IP address or host name of the system(s) you wish to scan and press <code>Start Scan</code> </p> </li> <li>You will be presented with an updated progress bar as the scan progresses through the scan  </li> <li> <p>Once the scan is completed you will be presented with a results page  </p> </li> <li> <p>Verify results are in compliance with enclave SOP and local policy  </p> </li> <li> <p>Review the report  </p> </li> <li>The complete report as well as only filtered results can be viewed and downloaded  </li> <li>By default, only the High and Medium risks are displayed  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#4-openvas-authenticated-credentialed-scan","title":"4. OpenVAS \u2013 Authenticated / Credentialed Scan","text":"<p>This option can be heavy on the network  </p> <ul> <li> <p>Access the OpenVAS web front-end at <code>https://localhost:9392/</code>. To access the web front-end interface from another node, use the following format: <code>https://hostname:9392/</code> </p> <ul> <li>If you do not know the username and password see [Note 2] below  </li> </ul> </li> <li> <p>Create Credentials for Host being scanned  </p> <ul> <li>From the top menu select <code>Configuration</code> -&gt; <code>credentials</code> </li> <li>Click the <code>Blue Star icon</code> \u2013 New Credential and fill in the information below  </li> <li>Click <code>Create Credential</code> Button  </li> <li>For Linux / Unix hosts ensure SSH is utilized  </li> <li>If you receive an error when saving, please see [Note 3] below  </li> </ul> </li> <li> <p>Start the Advanced Wizard  </p> <ul> <li>Hovering over the purple New Wizard icon and selecting <code>Advanced Wizard</code> </li> <li>Enter in Task Name for scan  </li> <li>Change Scan Config to <code>Full and Fast</code> </li> <li>Enter in IP address or CIDR address range for Target Hosts  </li> <li>Ensure <code>Start immediately</code> radio button is selected  </li> <li>Select the credentials created in step 2 above:  <ul> <li>Ensure Linux/Unix hosts use SSH Credentials  </li> <li>Ensure Windows hosts use SMB Credentials  </li> </ul> </li> </ul> </li> <li> <p>Click <code>Create Task</code> to start your scan  </p> </li> </ul> <p>Once the scan is complete it will state <code>Done</code> in the Tasks pane. Click on the completed scan to view results.  Verify that the scan completed with credentials by checking the status of the <code>SMB Login</code> </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#5-openvas-report-and-remediate-all-high-medium-and-low-findings","title":"5. OpenVAS \u2013 Report and remediate all High Medium and Low findings","text":"<ul> <li>From the OpenVAS web page click on the Completed Report Date of the Report you would like to review  </li> <li>Vulnerabilities will be listed in order of severity (High, Medium, Low)  </li> <li>Click on each vulnerability and review/implement suggested remediation and workarounds per local SOP  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#notes","title":"Notes:","text":"<ul> <li> <p>Note 1: To perform Credentialed / Authenticated scans on windows hosts you must:  </p> <ul> <li>Ensure <code>remote registry</code> service is started  </li> <li>The credentials used must be members of the Local or Domain administrator group on scanned hosts  </li> <li>The File and Printer Sharing is activated \u2013 if host is Windows XP do not use Simple File Sharing  </li> </ul> </li> <li> <p>Note 2: To change your OpenVAS password type the following as root     <pre><code>openvasmd --user=admin --new-password=password\n</code></pre></p> </li> <li> <p>Note 3: If you receive an error while creating user credentials verify that the following directory exists  </p> <ul> <li><code>/var/lib/openvas/gnupg</code> </li> <li>If the above directory does not exist create it by typing on the server as root  <ul> <li><code>mkdir /var/lib/openvas/gnupg</code> </li> </ul> </li> </ul> </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#running-script","title":"Running Script","text":"<p>NA  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#dependencies","title":"Dependencies","text":"<p>Kali Linux  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#other-available-tools","title":"Other available tools","text":"<p>N/A  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#references","title":"References","text":"<p>Install OpenVAS(GVM) on Kali Linux 2019 A Brief Introduction to the OpenVAS Scanner </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28KALI%29/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/","title":"OPENVAS(Ubuntu)","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#task-openvas-uitilization-guide","title":"Task OpenVAS Uitilization Guide","text":""},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#conditions","title":"Conditions","text":"<ul> <li>Utilizing the provided sudo privileges, run vulnerability scans on UNIX/Linux hosts  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#standards","title":"Standards","text":"<ul> <li>Setup OpenVAS  </li> <li>Conduct vulnerability scan  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#end-state","title":"End State","text":"<ul> <li>Completed a vulnerability scan utilizing OpenVAS  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#manual-steps","title":"Manual Steps","text":"<ul> <li>OpenVAS \u2013 Verification ONLY if OpenVAS is installed already  </li> <li> <p>Move to Step 1 if OpenVAS(GVM) is not installed  </p> </li> <li> <p>From a terminal shell as root type the following: <pre><code>openvas-check-setup\n</code></pre></p> </li> <li> <p>Verify that all checks are good and openvas responds with OK  </p> </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#1-openvas-greenbone-vulnerability-manager-installation","title":"1. (OpenVAS) Greenbone Vulnerability Manager Installation","text":"<ul> <li> <p>To install the Greenbone Vulnerability Management 11 packages on <code>Ubuntu 18.04 Bionic Beaver</code> first you need to install PostgreSQL database server (if you don't already have one - it could also be installed on a remote machine): <pre><code>sudo apt install postgresql\n</code></pre></p> </li> <li> <p>Then use the following commands to install GVM:     <pre><code>sudo add-apt-repository ppa:mrazavi/gvm\nsudo apt install gvm\n</code></pre></p> </li> <li> <p>Finally, you have to update the greenbone nvt/cert/scap data with these commands: <pre><code>greenbone-nvt-sync\nsudo greenbone-scapdata-sync\nsudo greenbone-certdata-sync\n</code></pre></p> </li> <li> <p>You can access the Greenbone Security Assistant web interface at: <code>https://x.x.x.x:9392</code> </p> </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#2-openvas-verify-all-signatures-and-feeds-are-up-to-date","title":"2. OpenVAS \u2013 Verify all signatures and feeds are up-to-date","text":"<ul> <li>Access OpenVAS web front-end at: <code>https://x.x.x.x:9392</code> </li> <li> <p>Click on <code>Administration</code> -&gt; <code>NVT Feed</code> and verify that the Feed Version is the latest version Format is in the form of a timestamp: <code>YYYYMMDDHHSS</code> </p> </li> <li> <p>Completed the above for all feeds under Administration Menu, or to update all feeds from the terminal type the following: <pre><code>openvas-nvt-sync\n</code></pre></p> </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#3-openvas-simple-scan","title":"3. OpenVAS \u2013 Simple Scan","text":"<ul> <li>Access OpenVAS web front-end at: <code>https://x.x.x.x:9392</code>. If you do not know the username and password see [Step 5. Note 2] below.  </li> <li> <p>Enter the IP address or host name of the system(s) you wish to scan and press <code>Start Scan</code> </p> <ul> <li>You will be presented with an updated progress bar as the scan progresses through the scan  </li> <li>Once the scan is completed you will be presented with a results page  </li> <li>Verify results are in compliance with enclave SOP and local policy  </li> </ul> </li> <li> <p>Review the report  </p> <ul> <li>The complete report as well as only filtered results can be viewed and downloaded  </li> <li>By default, only the High and Medium risks are displayed  </li> </ul> </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#4-openvas-authenticated-credentialed-scan","title":"4. OpenVAS \u2013 Authenticated / Credentialed Scan","text":"<ul> <li>This option can be heavy on the network  </li> <li> <p>Access the OpenVAS web front-end at <code>https://x.x.x.x:9392</code> </p> <ul> <li>If you do not know the username and password see [Step 5. Note 2] below  </li> </ul> </li> <li> <p>Create Credentials for Host being scanned  </p> <ul> <li>From the top menu select <code>Configuration</code> -&gt; <code>credentials</code> </li> <li>Click the <code>Blue Star icon</code> \u2013 New Credential and fill in the information below  </li> <li>Click <code>Create Credential</code> Button  </li> <li>For Linux / Unix hosts ensure SSH is utilized  </li> <li>If you receive an error when saving please see [Step 5. Note 3] below  </li> </ul> </li> <li> <p>Start the Advanced Wizard  </p> <ul> <li>by hovering over the purple New Wizard icon and selecting \"Advanced Wizard\"  </li> <li>Enter in Task Name for scan  </li> <li>Change Scan Config to \"Full and Fast\"  </li> <li>Enter in IP address or CIDR address range for Target Hosts  </li> <li>Ensure \u201cStart immediately\u201d radio button is selected  </li> <li>Select the credentials created in step 2 above:  <ul> <li>Ensure Linux/Unix hosts use SSH Credentials  </li> <li>Ensure Windows hosts use SMB Credentials  </li> </ul> </li> </ul> </li> <li> <p>Click <code>Create Task</code> to start your scan  </p> </li> </ul> <p>Once the scan is complete it will state \"Done\" in the Tasks pane. Click on the completed scan to view results  </p> <p>Verify that the scan completed with credentials by checking the status of the \"SMB Login\"  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#5-openvas-report-and-remediate-all-high-medium-and-low-findings","title":"5. OpenVAS \u2013 Report and remediate all High Medium and Low findings","text":"<ul> <li>From the OpenVAS web page click on the Completed Report Date of the Report you would like to review  </li> <li>Vulnerabilities will be listed in order of severity (High, Medium, Low)  </li> <li>Click on each vulnerability and review/implement suggested remediation and workarounds per local SOP  </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#notes","title":"Notes:","text":"<ul> <li> <p>1: To perform Credentialed / Authenticated scans on windows hosts you must:  </p> <ul> <li>Ensure <code>remote registry</code> service is started  </li> <li>The credentials used must be members of the Local or Domain administrator group on scanned hosts  </li> <li>The File and Printer Sharing is activated \u2013 if host is Windows XP do not use Simple File Sharing  </li> </ul> </li> <li> <p>2: To change your OpenVAS password type the following as root  </p> <ul> <li><code>openvasmd --user=admin --new-password=password</code> </li> </ul> </li> <li> <p>3: If you receive an error while creating user credentials verify that the following directory exists  </p> <ul> <li><code>/var/lib/openvas/gnupg</code> </li> <li>If the above directory does not exist create it by typing on the server as root.  </li> <li><code>root@kali:~# mkdir /var/lib/openvas/gnupg</code> </li> </ul> </li> </ul>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#running-script","title":"Running Script","text":"<p>NA  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#dependencies","title":"Dependencies","text":"<p>Linux / Ubuntu  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#other-available-tools","title":"Other available tools","text":"<p>N/A  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#references","title":"References","text":"<p>N/A  </p>"},{"location":"2.Identification/2.08-Conduct_Vulnerability_Scan/OPENVAS%28Ubuntu%29/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.11-Determine_Installed_Software/","title":"2.11-Determine Installed Software","text":""},{"location":"2.Identification/2.11-Determine_Installed_Software/#task-idam-31-determine-installed-software","title":"Task  ID.AM-3.1 Determine Installed Software","text":""},{"location":"2.Identification/2.11-Determine_Installed_Software/#conditions","title":"Conditions","text":"<p>Given a responder\u2019s computer, a network host (workstation or server), and proper access credentials  </p>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#standards","title":"Standards","text":"<ul> <li>Team member verifies access to the network host  </li> <li>Team member selects a method of listing installed applications on the network host and a storage location for the output file  </li> <li>Team member runs the necessary script and verifies the data collected with the system owner upon completion  </li> </ul>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#end-state","title":"End State","text":"<p>The list of installed software for the selected host has been collected and validated as correct by the system owner  </p>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#manual-steps","title":"Manual Steps","text":"<ul> <li> <p>PowerShell: as Administrator - (Local computer -  Run both commands to get both 32- and 64-bit installed software output to a file) <pre><code>Get-ItemProperty HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName,DisplayVersion, Publisher, InstallDate | Format-Table -AutoSize &gt; C:\\software.txt  \n</code></pre></p> <pre><code>Get-ItemProperty HKLM:\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-Table -AutoSize &gt;&gt; C:\\software.txt  \n</code></pre> </li> <li> <p>PowerShell: as Administrator (Remote computer - Run both commands to get both 32- and 64-bit installed software output to a file) <pre><code>Invoke-command -cn &lt;computername&gt; -Scriptblock {Get-ItemProperty HKLM:\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-Table -AutoSize} &gt; C:\\software.txt  \n</code></pre></p> <pre><code>Invoke-command -cn &lt;computername&gt; -Scriptblock {Get-ItemProperty HKLM:\\Software\\\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-Table -AutoSize} &gt;&gt; C:\\software.txt  \n</code></pre> </li> <li> <p>WMIC: as Administrator (Run with cmd, used for localhost) <pre><code>wmic /output:\"C:\\software.txt\" product get name,version /format:\"C:\\Windows\\System32\\wbem\\en-us\\csv\"  \n</code></pre></p> <pre><code>wmic /output:\"C:\\%Computername%_software.txt\" product get name,version /format:\"C:\\Windows\\System32\\wbem\\en-us\\csv\"  \n</code></pre> </li> <li> <p>WMIC: as Administrator (Run with cmd. Use for remote computers) <pre><code>wmic /node:\"computername\" product get name,version /format:csv &gt; c:\\ software.txt  \n</code></pre></p> </li> <li> <p>PSInfo (Sysinternals) run command from the directory where PSInfo is installed/located <pre><code>psinfo \\\\computername -u username -p password -s &gt; c:\\software.txt  \n</code></pre></p> </li> </ul> <p>Output should be in the format identified in <code>output_format_template.csv</code> and named [mm/dd/yyyy_hhss_Installed_Software_(computer name)]  </p> <p>Notify mission element lead and intelligence analyst of completion of this battle drill  </p>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#running-script","title":"Running Script","text":"<ul> <li> <p>Download script from ./script/determine_installed_software.ps1  </p> </li> <li> <p>Run script <pre><code>./determine_installed_software.ps1  \n</code></pre></p> </li> <li> <p>Select method of emumeration (1 - 4)  </p> </li> <li> <p>for all input full pathname is required (i.e. C:\\textfile.txt)  </p> </li> <li> <p>Retrieve output file  </p> </li> </ul>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#dependencies","title":"Dependencies","text":"<ul> <li>Download PStools for option 4  </li> </ul>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#references","title":"References","text":"<p>PowerShell find installed software PowerShell list installed programs Sysinternals Psinfo </p>"},{"location":"2.Identification/2.11-Determine_Installed_Software/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/","title":"2.12-Perform SCAP Configuration Scan","text":""},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#task-perform-a-scap-or-retina-scan-of-network-configurations","title":"Task Perform a SCAP or Retina Scan of Network Configurations","text":""},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#conditions","title":"Conditions","text":"<p>Given an incident response workstation configured with the latest SCAP Compliance Checker, a current Open Vulnerability and Assessment Language (OVAL) file, and a copy of the configuration file for the device to be tested  </p>"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#standards","title":"Standards","text":"<ul> <li>Team member checks the make, model and software version of the device to be tested and ensures the latest OVAL file has been obtained from the manufacturer\u2019s website or other source, such as DoD Cyber Exchange site </li> <li>Team member uploads the OVAL file to the SCAP tool.  </li> <li>Team member selects the configuration file for the device to be tested in the SCAP tool.  </li> <li>Team member runs the SCAP tool and upon completion selects for output the detailed report for the scan.  </li> <li>Team member uses the report findings to research remediation steps for all vulnerabilities found.  </li> </ul>"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#end-state","title":"End State","text":"<p>All vulnerabilities present in the device configuration file are found.  </p>"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#manual-steps","title":"Manual Steps","text":"<ul> <li>Open SCAP (Admin Account needed).  </li> <li>Under the Content section, right-click on the SCAP Content section &amp; select Delete All  </li> <li>Select Install, then Browse.  </li> <li>Locate and select the downloaded SCAP 1.2 Content (only load the content needed for scanning).  </li> <li>Select Open, then Install.  </li> <li>Ensure the installed SCAP content is highlighted.  </li> <li>Under Stream Details, select the dropdown on MAC-1_Classified and choose MAC-1_Sensitive (this will need to be accomplished for all SCAP content installed).  </li> <li>Select Options, then Show Options.  </li> <li>Under Scanning Options, uncheck \"Perform OCIL Scan\".  </li> <li>Select Output Options, and then under Directory Options, select \"Save Results to a Custom Directory\" and type in where the files will be saved.  </li> <li>Select Save.  </li> <li>Under the Scan section, choose a scan type.  <ul> <li>Local (System you are currently logged into)  </li> <li>Single Remote (Enter the FQDN of the remote system to scan)  </li> <li>Multiple Remote (Uses a host.txt file with fully qualified DNS names)  </li> </ul> </li> <li>Under the Content section, select the SCAP Benchmarks that you want to scan for.  <ul> <li>If content is now shown, select the Show Content button   </li> </ul> </li> <li>Select \"Start Scan\".  </li> <li>Once the scan is complete, results will be available in specified folder.  </li> </ul>"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#dependencies","title":"Dependencies","text":"<p>Latest SCAP tool and scan content <code>MUST</code> be installed  </p>"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#references","title":"References","text":"<p>SCC 5.3 GUI Scanner Cisco OVAL content OVAL Adoption Program Participant information The Security Content Automation Protocol </p>"},{"location":"2.Identification/2.12-Perform_SCAP_Configuration_Scan/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.13-Perform_STIG_Scan/","title":"2.13-Perform STIG SCAN","text":""},{"location":"2.Identification/2.13-Perform_STIG_Scan/#task-perform-stig-scan","title":"Task Perform STIG Scan","text":""},{"location":"2.Identification/2.13-Perform_STIG_Scan/#conditions","title":"Conditions","text":"<p>Given a list of hosts with known operating systems and/or applications, the user will complete a scan using the appropriate STIG (Security Technical Implementation Guide) using assigned tool. These standards follow using Nessus as the tool to perform the scan. SCAP (Security Content Automation Protocol) compliant STIGs should be used when possible.  </p>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#standards","title":"Standards","text":"<ul> <li>Identify appropriate STIG(s) to be used to analyze.  </li> <li>This is dependent upon the Network Owner disclosing their complete IT Inventory  </li> <li>Scan using the chosen STIG using Nessus.  </li> <li>These will likely be conducted several times, one per software target  </li> <li>Export results of the scan.  </li> <li>Standardize naming convention to include Software Target and Time/Date  </li> </ul>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#end-state","title":"End State","text":"<p>Results of the STIG scan baselines the host and identifies any security control weaknesses.  </p>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#manual-steps","title":"Manual Steps","text":"<ul> <li> <p>Navigate to the Mission Directory and view the discovered targets. <pre><code>cd /ios/data/assess/&lt;MISSION_DIR&gt;  \n</code></pre></p> </li> <li> <p>List the output files specifying the discovered targets.  Files with a size &gt; 0 indicate that OS were found in the initial scan. <pre><code>ls \u2013la ./collect/targ  \n</code></pre></p> </li> <li> <p>For the STIG/Compliance scan, run a Nessus STIG scan against each OS type (a.k.a. target): <pre><code>nessus.sh localhost win_&lt;OS Type&gt;_stig ./collect/targ/&lt;OS Type&gt;.ips   \n</code></pre></p> </li> <li> <p>View the output of the above STIG scan: <pre><code>ls -la ./collect/nbe  \n</code></pre></p> </li> <li> <p>Determine the timestamp of win__stig.nbe file by running the nbeSTIG2tab.sh script against the nbe files created in Step 2 <pre><code>nbeSTIG2tab.sh ./collect/nbe/&lt;timestamp&gt;-win_&lt;OS Type&gt;_stig.nbe &gt; win_&lt;OS Type&gt;_stig.tab  \n</code></pre> <li> <p>Organize the results by moving the timestamped tab file into the 'reports' directory: <pre><code>mv ./win_&lt;OS Type&gt;_stig.tab ./report/  \n</code></pre></p> </li>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#nessus-command-line-switches","title":"Nessus Command Line Switches","text":"<pre><code>```  \n-I #Specify the input file for the Nessus client to read when converting between two report formats. You can use nessus to do conversion between formats used for reports. Nessus can take any NSR or NBE reports and change them into HTML, XML, NSR or N  \n\n-o #Specify the output file for the Nessus client to create when converting between two report formats. You can use nessus to do conversion between formats used for reports. Nessus can take any NSR or NBE reports and change them into HTML, XML, NSR  \n\n-p #Uses the Nessus client to obtain the list of plugins available on the Nessus server.  \n\n-P #Uses the Nessus client to obtain the list of server and plugin preferences from the Nessus server.  \n\n-S #Causes the Nessus client to generate SQL syntax for the output of the '-p' (show plugins on the server) and '-P' (show server/plugin preferences) commands.  \n\n-T #Define what format should be used for the report data from a scan. Options are: nbe, html, html_graph, text, xml, old-xml, tex, or nsr.  \n```\n</code></pre>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#nessus-web-interface","title":"Nessus Web Interface","text":"<p>To perform a certified SCAP assessment, follow these high-level steps: * Download certified NIST SCAP content in its zip file format. Note that the entire zip file must be obtained for use with Nessus. * Create a scan or policy using Nessus\u2019 SCAP Compliance Audit library template. Add a scan name, target(s), and credentials for the target system(s). * Upload the SCAP content zip file to the Nessus scan or policy in the appropriate Active SCAP Components section under \u201cSCAP File (zip)\u201d. From the SCAP XML file, select the appropriate data stream, benchmark, and profile to be used in the desired audit. * Perform a vulnerability scan based on the selected scan or policy. * When the scan is completed, view the results within Nessus\u2019 \u201cScans\u201d section  </p>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#downloading-scap-xccdf","title":"Downloading SCAP XCCDF","text":"<p>Nessus users can obtain the various SCAP bundles. Bundles can be downloaded collectively as a single .zip archive depending on the platform to be assessed and the version of SCAP and OVAL desired to be used in an assessment.  </p> <p>NIST Scap Content Stig Viewer </p>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#exporting-scan-results","title":"Exporting Scan Results","text":"<p>To export your scan results for importing into another Nessus instance, choose the \u201cNessus\u201d export format. This provides a .nessus file of the report results. The name of the file will be in the format of _.nessus where the scan name is the actual scan name used in Nessus."},{"location":"2.Identification/2.13-Perform_STIG_Scan/#running-script","title":"Running Script","text":"<p>N/A  </p>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#dependencies","title":"Dependencies","text":"<p>Nessus (Free Trial) * NOTE: The Free version only allows scanning of 16 IPs Nessus Professional * NOTE: You can try Nessus Professional Free for 7 days   * Most likely requires a minimum 1yr subscription  </p>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#other-available-tools","title":"Other available tools","text":"<ul> <li>DISA SCAP tool </li> </ul>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#references","title":"References","text":"<p>Tenable Trial Tenable SCAP Guide * NOTE: Notice the version number on this link. Steps should be similar with different Nessus versions unless noted. Stig Viewer NIST Scap Content </p>"},{"location":"2.Identification/2.13-Perform_STIG_Scan/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/","title":"2.14-Gather AD Structure Information","text":""},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#task-gather-ad-structure-information","title":"Task Gather AD Structure Information","text":""},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#conditions","title":"Conditions","text":"<p>Given a suspected compromised network segment(s), access to a system that can gather the structure of the suspected domain.  </p>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#standards","title":"Standards","text":"<ul> <li>The team member identifies possibly compromised network segment(s).  </li> <li>The team member accesses a system that can enumerate the domain  </li> <li>The team member utilizes various Powershell cmdlets to enumerate the domain structure and/or users  </li> <li>Task 2.14 \u2013 Gather AD structure information  </li> <li>The resulting enumerated data is compared to a known good AD configuration file to determine any anomalies present in the domain.  </li> </ul>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#end-state","title":"End State","text":"<p>The structure of the domain is enumerated based on the specific sub-task accomplished and any anomalies on the domain will be identified.  </p>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#manual-steps","title":"Manual Steps","text":"<ul> <li> <p>Get information of the current domain <pre><code>PS C:\\Users\\btadmin\\Desktop&gt; $adddomain = Get-ADDomain  \nPS C:\\Users\\btadmin\\Desktop&gt; $adddomain  \nAllowedDNSSuffixes    : {}  \nChildDomains          : {}  \nComputersContainer    : CN=Computers,DC=team01,DC=tgt  \n--snipped--  \n</code></pre></p> </li> <li> <p>Get structure of domain <pre><code>PS C:\\Users\\btadmin\\Desktop&gt; Get-ADObject -Filter { ObjectClass -eq 'organizationalunit' } -PropertiesCanonicalName | Select-Object -Property CanonicalName\nCanonicalName\n-------------\nteam01.tgt/Domain Controllers\nteam01.tgt/Microsoft Exchange Security Groups\nteam01.tgt/Groups\nteam01.tgt/Chula Vista\n--snipped--\n</code></pre></p> </li> </ul> <p>Output should be in the format identified in 'output_format_template.csv' and named [mm/dd/yyyy_hhss_AD_Structure_(xx.xx.xx.xx/x)]  </p> <p>Notify mission element lead and intelligence analyst of completion of this battle drill  </p>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#running-script","title":"Running Script","text":"<ul> <li> <p>Download script from 2.14_Gather_AD_Structure_Information  </p> </li> <li> <p>Run scripts <pre><code>PS C:\\Users\\btadmin\\Desktop&gt; .\\2.14_GatherADSTructureInfo.ps1\n[+] Writing Active Directory structure to C:\\Users\\btadmin\\Desktop\\CyberSurfers\\CyberSurfers_ACL_1593261366.22937.txt...\n[+] Done!\n</code></pre></p> </li> <li> <p>The logfile will be saved to CyberSurfers directory for analysis <pre><code>PS C:\\Users\\btadmin\\Desktop&gt; cat .\\CyberSurfers\\CyberSurfers_ACL_1593261366.txt\n[+] Domains infrastructure master: Team01-DC01.team01.tgt\n[+] The Active Directory structure as follows:\nDC=team01,DC=tgt\n--&gt; OU=Alameda\n----&gt; OU=Computers\n----&gt; OU=Groups\n----&gt; OU=Servers\n----&gt; OU=Users\n--snipped--\n</code></pre></p> </li> </ul>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#dependencies","title":"Dependencies","text":"<p>N/A</p>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#other-available-tools","title":"Other available tools","text":"<p>N/A</p>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#references","title":"References","text":"<p>N/A </p>"},{"location":"2.Identification/2.14-Gather_AD_Structure_Information/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/","title":"2.15-AD Configuration Scan with Powershell","text":""},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#task-evaluate-active-directory-ad-configurations-using-powershell","title":"Task Evaluate Active Directory (AD) Configurations using PowerShell","text":""},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#conditions","title":"Conditions","text":"<p>Given an incident response workstation with PowerShell configured, Domain Administrator-level credentials, and a target Domain. Must of knowledged of domain given from network owner.  </p>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#standards","title":"Standards","text":"<ul> <li>Team member verifies connectivity to the Domain Controller with provided credentials  </li> <li>Team member ensures the Active Directory module has been imported into the PowerShell console prior torunning scan.  </li> <li>Team member runs a PowerShell script utilizing ADcommandlets that capturethe following AD-related informationto an output file.  <ul> <li>Domain Controllers(DCs)  </li> <li>Domain Groups  </li> <li>Domain Organizational Units (OUs)  </li> <li>Domain Computers  </li> <li>Domain Users  </li> <li>Domain Service Accounts  </li> <li>Group Membership  </li> <li>OU Membership  </li> </ul> </li> <li>Team member saves the output file for comparison to later evaluations  </li> </ul>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#end-state","title":"End State","text":"<p>AD configuration information for the target domain is output to a text or XML file for later comparison.  </p>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#manual-steps","title":"Manual Steps","text":"<p>Using a team laptop that is not a member of the domain launch ad enumeration script. After launching the script you will be prompted for some additional information.  </p> <ul> <li>Type in domain credentials in the format Domain\\Username. <code>i.e. team02\\Administrator</code> </li> <li>Type in known Domain Controller Name. In the range it looks like something like: <code>i.e. team02-dc01</code> </li> <li>Type in Known Domain name. In the range it looks something like: <code>i.e. team02.tgt</code> </li> <li>Give the script 5-10 minutes to run, then check <code>C:\\Temp\\export.txt</code> </li> </ul> <p>To compare this file save it to a differen directory then run again at a later time and user a program like Notepad++ and the Diff extention  </p>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#script","title":"Script","text":"<p>2.15_AD_Enumeration_FromExternal.ps1  </p>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#dependencies","title":"Dependencies","text":"<ul> <li>PowerShell  </li> </ul>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#other-available-tools","title":"Other available tools","text":"<ul> <li>Windows Command Line  </li> <li>Managed Engine AD Manager and AD Audit Plus  </li> </ul>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#references","title":"References","text":"<p>Microsoft PowerShell Scripting Version 7 </p>"},{"location":"2.Identification/2.15-AD_Configuration_Scan_with_Powershell/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/","title":"2.16-List AD Domain Accounts","text":""},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#task-identify-all-ad-domain-accounts","title":"Task Identify all AD Domain Accounts","text":""},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#conditions","title":"Conditions","text":"<p>Given a suspected compromised network segment(s), access to a system that can access and view the list of AD accounts as is.  </p>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#standards","title":"Standards","text":"<ul> <li>The team member accesses the compromised system    </li> <li>The team member uses this script to output the AD users to a text file for analysis    </li> <li>The resulting scan data is a list of AD users for later analysis    </li> </ul>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#end-state","title":"End State","text":"<p>All users of the domain are enumerated and any newly created accounts that may have happen will be identified.   </p>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#manual-steps","title":"Manual Steps","text":"<ul> <li> <p>Get the users of the current domain:   <pre><code>Get-ADUser -Filter *  \n</code></pre></p> </li> <li> <p>To get the amount of users in the domain:   <pre><code>$dcUsers = Get-ADUser -Filter *\n$dcUsers.Count\n6609\n</code></pre></p> </li> <li> <p>To list all of the disabled AD accounts: <pre><code>Get-ADUser -Filter { Enabled -eq \"False\" } | Select-Object SamAccountName\n</code></pre></p> </li> <li> <p>List of all accounts and attributes:   <pre><code>dsquery * -limit 0\n\"CN=Sochan\\, Carlenel,OU=Users,OU=Santa Ana,DC=team01,DC=tgt\"\n\"CN=Team01-WK4355,OU=Computers,OU=Los Angeles,DC=team01,DC=tgt\"\n</code></pre></p> </li> </ul>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#running-script","title":"Running Script","text":"<p>When the script is ran, it will enumerate all users of the domain and output them into a file named all_ad_domain_accounts.txt later analysis.    <pre><code>PS .\\2.16_ListADDomainAccounts.ps1\n[+] Current Domain: team01.tgt\n[+] There are 6609 users in team01.tgt\n[+] Writing domain users to all_ad_domain_accounts.txt...\n[+] Done!\n</code></pre></p>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#dependencies","title":"Dependencies","text":"<p>N/A</p>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#other-available-tools","title":"Other available tools","text":"<p>N/A</p>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#references","title":"References","text":"<p>N/A </p>"},{"location":"2.Identification/2.16-List_all_AD_Domain_Accounts/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/","title":"2.17-Scan Device for Default Admin Password","text":""},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#task-scan-device-for-default-admin-passwords","title":"Task Scan Device For Default Admin Passwords","text":""},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#conditions","title":"Conditions","text":"<p>Given a suspected compromised network segment(s), access to a system that can access and scan the identified network devices, and scanning software included in the team\u2019s incident response kit.  </p>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#standards","title":"Standards","text":"<p>Team Member Scans network for devices with default passwords Idenitfy devices and notify network owner  </p>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#end-state","title":"End State","text":"<p>All devices on nework with weak or default passwords will be identified.  </p>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#manual-steps","title":"Manual Steps","text":"<p>First thing you want to do is log into nessus via the IP of the nessus server with the port 8834. example https://x.x.x.x:8834 </p> <p>Once Logged in, verify you have the correct plugins enabled: * Scans &gt; New Scan &gt; Advanced Scan * Click the Plugins tab &gt; Click Filter at the top toolbar * Change the drop down to \"Default/Known accounts\" and click apply * The list of 'Enabled' plugins will switch to just the filtered plugins  </p> <p>If there were some that were not enabled for default/known account filter just enable them.  </p> <ul> <li> <p>Once verified create a new scan  </p> <ul> <li>Create advanced Scan  </li> <li>Add the title or name (weak &amp; Known password scan)  </li> <li>Type in the IP range i.e. x.x.x.x/24  </li> </ul> </li> <li> <p>Leave all other settings default  </p> </li> <li>Save  </li> <li>Launch Scan  </li> </ul>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#dependencies","title":"Dependencies","text":"<ul> <li>Nessus Server  </li> </ul>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#other-available-tools","title":"Other available tools","text":"<p>N/A  </p>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#references","title":"References","text":"<p>Nessus Plugins Nessus Default Credentials </p>"},{"location":"2.Identification/2.17-Scan_Device_For_Default_Admin_Password/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/","title":"2.18-Review Organizational User Policies","text":""},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#task-review-organizational-user-policies","title":"Task Review Organizational User Policies","text":""},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#conditions","title":"Conditions","text":"<p>Given an organization user policies and access to information security personnel and knowledge workers.  </p>"},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#standards","title":"Standards","text":"<p>The team member reviews all written policies regarding users of information systems within a given organization. The policies should at a minimum address: * Acceptable Use Policy * Account request process * Account creation/deletion/suspension procedures * Access control methodology (e.g. group membership) * Initial and periodic user training * Process for elevated privilege request and reviewed * Account audit process  </p> <p>The team member will interview information security personnel to ensure complete understanding of policies and technical implementation as necessary. The team member interviews random knowledge workers to ensure user base has full understanding of user requirements and responsibilities.  </p>"},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#endstate","title":"Endstate","text":"<p>All user policies have been reviewed and shortfalls annotated and briefed to the system owner.  </p>"},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#notes","title":"Notes","text":"<ul> <li> <p>Acceptable Use Policy Will be tailored to the organization and include items such as social media, PII and email monitoring. Policy will fall in line with local provider or enclave.  </p> </li> <li> <p>Account Requests: Account forms can be found in a central digital location that is easily accessible for personnel to retrieve. The account request form needs to include information fields for name (first, last), rank/title, organization, reason for request, location/group. Digital copy of completed request forms should be kept in a central database with access restricted to those who need it (account creators, database administrators) Information Assurance (IA) training certification is required as part of account request packet. IA training can be found at https://ia.signal.army.mil. A passing score of 70% is required to gain an account and is an annual requirement to keep the account.  </p> </li> <li> <p>Account suspension: After a lack of use or non-use for 45 days or an AUP violation, user accounts will be placed in suspension (disabled) status. If suspension is in response to an AUP violation, the account will not be placed back into active status until after IA training has been redone and the certification is received by the account managers and noted on the account. If the account in is suspended status due to lack of use, the user will need to speak with the account managers to get it reactivated.  </p> </li> <li> <p>Account deletion: Reasons for account deletion include lack of use, repeat violations of the Acceptable Use Policy and job termination. Lack of use or non-use limit for user accounts is set at 90 days. For account deletion due to violations, users are granted two suspensions before resulting in deletion. All user violations should be noted on their account with the incident date, incident, response results, and date of completion of IA training from the new certification.  </p> </li> <li> <p>Access control methodology:  Access to groups and elevated privileges are treated on an individual basis. Requesters will need to fill out a request form that includes information fields for name, rank/title, organization, requested groups/elevated privileges/access level, why they are requesting it and have supervisor approval to be given access to additional groups and privileges. Periodic review will be conducted to determine continued user access to the groups and privileges.  </p> </li> <li> <p>Initial and periodic review: IA and Information Assurance Security Officer (IASO) training will need to renewed on an annual basis. Any additional certifications will also be reviewed on an annual basis as part of the personnel performance review to ensure any continued education that is needed is being addressed and tracked.</p> </li> <li> <p>Elevated privilege request/review: Elevated privileges will be addressed on an individual basis. The request will use the same form as the group membership request and follow the same process. Elevated privileges will be periodically reviewed for determination of continued usage. Privilege violations will result in one warning before removal. To get privileges returned will require review with the user\u2019s supervisor to determine if privileges will be returned due to required job duties.  </p> </li> <li> <p>Account audit process: Accounts will be audited on a monthly schedule and compared against various variables to determine account usage, status and IA/IASO certification expiration.  </p> </li> </ul>"},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#references","title":"References","text":"<p>NIST 800-53 Controls DISA IAWIP Policy References </p>"},{"location":"2.Identification/2.18-Review_Organizational_User_Policies/#revision-history","title":"Revision History","text":""},{"location":"2.Identification/2.19-Create_firewall_rule_list/","title":"2.19-Create Firewall Rule List","text":""},{"location":"2.Identification/2.19-Create_firewall_rule_list/#task-create-firewall-rule-list","title":"Task Create Firewall Rule List","text":""},{"location":"2.Identification/2.19-Create_firewall_rule_list/#conditions","title":"Conditions","text":"<p>Given access to suspected compromised hosts, and appropriate credentials.  </p>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#standards","title":"Standards","text":"<ul> <li>The team member establishes a start point baseline of local firewall rules.  </li> <li>The team member periodically reruns the local rules check and compares to established baseline.  </li> <li>The team member reviews established baseline to identify possible security gaps and/or misconfigurations.  </li> </ul>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#end-state","title":"End State","text":"<p>Local firewall rules baseline is established, periodically checked against, and audited for security gaps/misconfigurations.  </p>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#manual-steps","title":"Manual Steps","text":"<ul> <li> <p>Show all rules: <pre><code>netsh advfirewall firewall show rule name=all\n</code></pre></p> </li> <li> <p>Setfirewall on/off: <pre><code>netsh advfirewall set currentprofile state on\nnetsh advfirewall set currentprofile firewallpolicy blockinboundalways,allowoutbound\nnetsh advfirewall set publicprofile state on\nnetsh advfirewall set privateprofile stateon\nnetsh advfirewall set domainprofile state on\nnetsh advfirewall set allprofile state on\nnetsh advfirewall set allprofile state off\n</code></pre></p> </li> </ul> <p>ENSURE CHANGES HAVE BEEN APPROVED BY COMMAND BEFORE CONTINUING  </p> <ul> <li> <p>Set firewall rules examples: <pre><code>netsh advfirewall firewall add rule name=\"Open Port 80\" dir=in action=allow protocol=TCP localport=80\nnetsh advfirewall firewall add rule name=\"My Application\" dir=in action=allow program=\"C:\\MyApp\\MyApp.exe\" enable=yes\nnetsh advfirewall firewall add rule name=\"My Application\" dir=in action=allow program=\"C:\\MyApp\\MyApp.exe\" enable=yes remoteip=157.60.0.1,172.16.0.0/16,LocalSubnet profile=domain\nnetsh advfirewall firewall add rule name=\"My Application\" dir=in action=allow program=\"C:\\MyApp\\MyApp.exe\" enable=yes remoteip=157.60.0.1,172.16.0.0/16,LocalSubnet profile=domain\nnetsh advfirewall firewall add rule name=\"My Application\" dir=in action=allow program=\"C:\\MyApp\\MyApp.exe\" enable=yes remoteip=157.60.0.1,172.16.0.0/16,LocalSubnet profile=private\nnetsh advfirewall firewall delete rule name=rule name program=\"C:\\MyApp\\MyApp.exe\"\nnetsh advfirewall firewall delete rule name=rule name protocol=udp localport=500\nnetsh advfirewall firewall set rule group=\"remote desktop\" new enable=Yes profile=domain\nnetsh advfirewall firewall set rule group=\"remote desktop\" new enable=No profile=publicSetup logging location:\nnetsh advfirewall set currentprofile logging C:\\&lt;LOCATION&gt;\\&lt;FILE NAME&gt;\n</code></pre></p> </li> <li> <p>Windows firewall log location and settings: <pre><code>more %systemroot%\\system32\\LogFiles\\Firewall\\pfirewall.log\nnetsh advfirewall set allprofile logging maxfilesize 4096\nnetsh advfirewall set allprofile logging droppedconnections enable\nnetsh advfirewall set allprofile logging allowedconnections enable\n</code></pre></p> </li> <li> <p>Get full list of firewall cmdlets in PowerShell: <pre><code>Get-Command *-*firewall*\n</code></pre></p> </li> </ul>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#running-script","title":"Running Script","text":"<ul> <li>Transfer powershell script to target host.  </li> <li>Navigate to containing folder and run <code>2.19_CreateFirewallRuleList.ps1</code> </li> </ul>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#dependencies","title":"Dependencies","text":"<ul> <li>Windows</li> <li>Powershell  </li> </ul>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#other-available-tools","title":"Other available tools","text":"<p>N/A</p>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#references","title":"References","text":"<p>PowerShell NetSecurity </p>"},{"location":"2.Identification/2.19-Create_firewall_rule_list/#revision-history","title":"Revision History","text":""},{"location":"3.Containment/","title":"3.Containment","text":""},{"location":"3.Containment/#containment-tasks","title":"Containment Tasks","text":"<p>Develop and implement appropriate safeguards to ensure delivery of critical services.  The Containment Function supports the ability to limit or contain the impact of a potential cybersecurity event. Examples of outcome Categories within this Function include: Identity Management and Access Control; Awareness and Training; Data Security; Information Protection Processes and Procedures; Maintenance; and Protective Technology.  </p>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/","title":"3.01-Export Users from Active Directory","text":""},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#task-export-list-of-users-from-active-directory","title":"Task Export List of Users from Active Directory","text":""},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#conditions","title":"Conditions","text":"<p>Given domain credentials with the appropriate permissions, and an incident response workstation with necessary tools  </p>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#standards","title":"Standards","text":"<ul> <li>Team member checks the schema of the Active Directory (AD) structure and determines best grouping for exporting users (i.e., all to one file; by OU; other breakdown)  </li> <li>Team member obtains Domain user information that may include the following:  </li> </ul> Expiration date badPwdCount Distinguished name Enabled Given Name LastBadPasswordAttempt Last Logon Date/Time LockedOut Group membership Name Globally Unique Identifier (GUID) PasswordExpired PasswordLastSet PasswordNeverExpires PasswordNotRequired sAMAccountName Security Identifier (SID) Surname User Principal Name When Created <ul> <li>User data is exported to a CSV file and stored according to team SOP  </li> </ul>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#end-state","title":"End State","text":"<p>All Domain User accounts have been exported to a CSV file with information required to allow for detection of malicious activity.  </p>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#notes","title":"Notes","text":"<p>The tool chosen can limit the amount and type of information exported and is an important consideration for this task. In an incident response scenario, information such as creation time/date; account expiration date or when the account password was last set, can all be vital information in tracking user accounts modified for or by malicious processes.  unless the Domain Controller is a version that does not support it, PowerShell is the best choice for this task. While not necessary, retrieving all of the user account name properties enables the responder to determine anomalies in the naming of accounts that may indicate those accounts were created by a malicious actor unfamiliar with the domain naming convention or policy. Muli-Valued Properties do not pipe data to 'export-csv' correctly unless a separate hashtable is created (ex:MemberOf). Therefore the following command does not meet the standard set forth in this battle drill: <pre><code>Get-ADUser -filter * -Properties * | Export-Csv UnSat.csv\n</code></pre></p>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#manual-steps","title":"Manual Steps","text":"<ul> <li> <p>Open PowerShell ISE:  </p> <ul> <li>Press: <code>Windows key</code> + <code>R</code> </li> <li>Type: <code>PowerShell_ISE.exe</code> </li> <li>Press: <code>ENTER</code> </li> </ul> </li> <li> <p>Perform a PowerShell Functions-Check (Version, Architecture, Execution-Policy):  </p> <ul> <li><code>Version 2.0</code> or higher required for the scripted portion of this Task <pre><code>echo $PSVersionTable\n</code></pre></li> </ul> </li> <li> <p>Architecture <pre><code>[Environment]::Is64BitProcess\n</code></pre></p> </li> <li> <p><code>ByPass</code> or <code>Unrestricted</code> required for this Task.  Use <code>Set-ExecutionPolicy</code> to alter this setting if necessary  <pre><code>Get-ExecutionPolicy\n</code></pre></p> </li> <li> <p>Load Active Directory Module (skip step on Windows Server 2012): <pre><code>import-module ActiveDirectory\n</code></pre></p> </li> <li> <p>{OPTION A \u2013 PREFERRED METHOD} Use PowerShell to enumerate user locations by OU:  </p> <ul> <li> <p>Paste Code into Script Pane: <pre><code>$output = Read-Host \"'Y' for output to file or any key for output in GUI table view\" -foreground Cyan\n$fqdn = Read-Host \"Enter FQDN domain\"\n$cred = Get-Credential\n\nWrite-Host \"Contacting $fqdn domain...\" -ForegroundColor Yellow\n$domain = (get-addomain $fqdn -Credential $cred | select\ndistinguishedName,pdcEmulator,DNSroot,DomainControllersContainer)\nWrite-Host \"Completed. Enumerating OUs..\" -ForegroundColor Yellow\n\n$OUlist = @(Get-ADOrganizationalUnit -filter * -Credential $cred -SearchBase $domain.distinguishedName -SearchScope\nSubtree -Server $domain.DNSroot)\nWrite-Host \"Completed. Counting users...\" -ForegroundColor Yellow\nfor($i = 1; $i -le $oulist.Count; $i++)\n{write-progress -Activity \"Collecting OUs\" -Status \"Finding OUs $i\" -PercentComplete ($i/$OUlist.count*100)}\n$newlist = @{}\nforeach ($_objectitem in $OUlist) {\n$getUser = Get-ADuser -Filter * -Credential $cred -SearchBase $_objectItem.DistinguishedName -SearchScope OneLevel -\nServer $domain.pdcEmulator | measure | select Count\nfor($i = 1; $i -le $getUser.Count; $i++)\n{write-progress -Activity \"Counting users\" -Status \"Finding users $i in $_objectitem\" -PercentComplete\n($i/$getUser.count*100)}\n$newlist.add($_objectItem.DistinguishedName, $getUser.Count)\n}\nif ($output -eq \"Y\") {\n$newlist | ft -AutoSize | Out-File .\\UsersByOU.txt\nWrite-Host \"All done!\" -ForegroundColor yellow\n} else {\n$newList | Out-GridView\n}\n</code></pre></p> </li> <li> <p>Save script as UsersByOU.PS1  </p> </li> <li>Execute Script  </li> </ul> </li> <li> <p>{OPTION B \u2013 NON-PREFERRED METHOD} Use RSAT Tools to enumerate user locations by OU.  </p> <ul> <li>{Domain Joined Workstation} Open ActiveDirectory Users &amp; Computers:  <ul> <li>Press: <code>Windows Key</code> + <code>R</code> </li> <li>Type: dsa.msc  </li> <li>Press: <code>ENTER</code> </li> </ul> </li> <li>{Non-Domain Joined Workstation} Open ActiveDirectory Users &amp; Computers:  <ul> <li>Click <code>START</code> </li> <li>Type dsa.msc (DO NOT PRESS \"ENTER\")  </li> <li>Hold \"SHIFT\" and Right-click the resultant dsa.msc program  </li> <li>Select <code>Run as Different User</code> </li> <li>Enter Provided Domain Credentials  </li> </ul> </li> <li>Ensure that the correct domain is displayed in the left column of the snap-in. If not:  <ul> <li>In the top, left corner of the left column, Click <code>Active Directory Users and Computers</code> </li> <li>Select the <code>Action</code> pull-down menu  </li> <li>Select <code>Change Domain</code> </li> <li>Enter the correct domain name  </li> <li>Click <code>OK</code> </li> </ul> </li> <li>Enumerate user locations:  <ul> <li>In the left column, click the domain  </li> <li>Select the <code>Action</code> pull-down menu  </li> <li>Select <code>Find\u2026</code> </li> <li>Click <code>Find Now</code> </li> <li>Select the <code>View</code> pull-down menu  </li> <li>Select <code>Choose Columns\u2026</code> </li> <li>Add <code>Published At</code> </li> <li>Click <code>OK</code> </li> <li>Click the header of the <code>Published At</code> column to sort results  </li> <li>Make note of each location which contains users  </li> </ul> </li> </ul> </li> <li> <p>Enumerate Users:  </p> <ul> <li> <p>Dump all users into the same file: <pre><code>Get-ADUser -filter * -Properties * | select ObjectGUID, whenCreated, AccountExpirationDate, lastLogonTimestamp, @{name=\u201dMemberOf\u201d;expression={$_.memberof -join \u201c;\u201d}}, PasswordExpired, PasswordLastSet, PasswordNeverExpires, PasswordNotRequired, LastBadPasswordAttempt, badPwdCount, LockedOut |Export-Csv PrivateSnuffysScript.csv\n</code></pre></p> </li> <li> <p>Dump users from a specific OU into a file {\u2018searchbase\u2019 property must be tailored to environment}: <pre><code>Get-ADUser -SearchBase \u2018OU=Users,DC=Army,DC=Mil\u2019 -filter * -Properties * | select ObjectGUID, whenCreated, AccountExpirationDate, lastLogonTimestamp, @{name=\u201dMemberOf\u201d;expression={$_.memberof -join \u201c;\u201d}} ,PasswordExpired, PasswordLastSet, PasswordNeverExpires, PasswordNotRequired, LastBadPasswordAttempt, badPwdCount, LockedOut |Export-Csv ChiefSnuffysScript.csv\n</code></pre></p> </li> </ul> </li> </ul>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#running-script","title":"Running Script","text":""},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#dependencies","title":"Dependencies","text":""},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#other-available-tools","title":"Other available tools","text":""},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#references","title":"References","text":"<p>How Security Identifiers Work SID vs. GUID List of PowerShell Scripts that will accomplish the tasks </p>"},{"location":"3.Containment/3.01_Export_users_from_Active_Directory/#revision-history","title":"Revision History","text":""},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/","title":"3.02-Export Groups from Active Directory","text":""},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#task-export-list-of-groups-from-active-directory","title":"Task Export List of Groups from Active Directory","text":""},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#conditions","title":"Conditions","text":"<p>Given domain credentials with the appropriate permissions, and an incident response workstation with necessary tools and access to the Primary Domain Controller for the target domain  </p>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#standards","title":"Standards","text":"<ul> <li>Team selects the best method to connect to the Domain Controller (DC) and tool that will provide the required information  </li> <li>Team member obtains Domain group information that may include the following:  <ul> <li>Canonical Name  </li> <li>Display Name  </li> <li>Distinguished Name  </li> <li>Group Category  </li> <li>Group Scope  </li> <li>Object GUID  </li> <li>sAMAccountName  </li> <li>Security Identifier (SID)  </li> <li>Creation Date/Time  </li> <li>Modified Date/Time  </li> </ul> </li> <li>Group data is exported to a CSV file and stored according to team SOP  </li> </ul>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#end-state","title":"End State","text":"<p>All Domain Groups have been exported to a CSV file with information required to allow for detection of malicious activity.  </p>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#notes","title":"Notes","text":"<p>The tool chosen can limit the amount and type of information exported and is an important consideration for this task. In an incident response scenario, information such as creation time/date or modified date can all be vital information in determining malicious activity. Unless the Domain Controller is a version that does not support it, PowerShell is the best choice for this task.  </p> <p>While not necessary, retrieving all of the group name properties enables the responder to determine anomalies in the naming of groups that may indicate they were created by a malicious actor unfamiliar with the domain naming convention or policy.  </p> <p>There are various Active Directory (AD) PowerShell commands that can be combined to provide a comprehensive script that combines group property information along with a list of users that are members of the group. While not part of this task, this is important information when monitoring changes in AD during an incident.  </p>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#running-script","title":"Running Script","text":""},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#dependencies","title":"Dependencies","text":""},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#other-available-tools","title":"Other available tools","text":""},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#references","title":"References","text":"<p>Get-ADGroup PowerShell syntax Get-ADGroupMember syntax Compare-Object syntax </p>"},{"location":"3.Containment/3.02_Export_groups_from_Active_Directory/#revision-history","title":"Revision History","text":""},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/","title":"3.03-Export Group Policy Objects from Active Directory","text":""},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#task-export-group-policy-objects-gpos-from-active-directory","title":"Task Export Group Policy Objects (GPOs) from Active Directory","text":""},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#conditions","title":"Conditions","text":"<p>Given a Domain Controller (DC), a domain account with required permissions, and a workstation with Remote Server Administration Tools (RSAT)  </p>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#standards","title":"Standards","text":"<ul> <li>Team member runs the Group Policy Management Console on the workstation and locates a GPO for export  </li> <li>Team member saves the report for the GPO to the local workstation.  </li> </ul> <p>OR  </p> <ul> <li>Team member opens a PowerShell console and selects or creates a script using the Group Policy Cmdlets to export one or more GPOs to a local file  </li> </ul>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#end-state","title":"End State","text":"<p>All Group Policy Objects have been exported to a local file for review  </p>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#notes","title":"Notes","text":"<p>The Group Policy Cmdlets for PowerShell are only available for Windows Server 2008 R2 and higher or Windows 7 or higher with the RSAT tools installed</p>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#manual-steps","title":"Manual Steps","text":"<p>Example: <pre><code>$GPOs = Get-GPO -All -Server $Server | Select-Object ID, Path, DisplayName, GPOStatus, WMIFilter, CreationTime, ModificationTime, User, Computer\n</code></pre></p>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#running-script","title":"Running Script","text":""},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#dependencies","title":"Dependencies","text":""},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#other-available-tools","title":"Other available tools","text":""},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#references","title":"References","text":"<p>Group Policy Cmdlets List of PowerShell Scripts that will accomplish the tasks </p>"},{"location":"3.Containment/3.03_Export_Group_Policy_Objects_from_Active_Directory/#revision-history","title":"Revision History","text":""},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/","title":"3.04-Export Trust Relationship from Active Directory","text":""},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#task-export-trust-relationships-from-active-directory","title":"Task Export Trust Relationships from Active Directory","text":""},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#conditions","title":"Conditions","text":"<p>Given a Domain Controller (DC), a domain account with required permissions, and a domain workstation with Remote Server Administration Tools (RSAT)  </p>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#standards","title":"Standards","text":"<ul> <li>Team member obtains the correct name for the target domain  </li> <li>Team member creates or chooses a script using Microsoft command line tools to extract domain trust information to a local file  </li> </ul> <p>OR</p> <ul> <li>Team member opens a PowerShell console and selects or creates a script using the Active Directory Domain Services (AD DS) to export one or more GPOs to a local file  </li> </ul>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#end-state","title":"End State","text":"<p>All Domain trust information been exported to a local file for review  </p>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#notes","title":"Notes","text":"<p>The AD DS Cmdlets for PowerShell are only available for Windows Server 2012 R2 or Windows 8.1 or higher with the RSAT tools installed  </p>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#manual-steps","title":"Manual Steps","text":"<p>Example: <pre><code>Get-WmiObject -Class Microsoft_DomainTrustStatus -Namespace ROOT\\MicrosoftActiveDirectory | Select-Object PSComputername, TrustedDomain, TrustAttributes, TrustDirection, TrustType |fl\n</code></pre></p> <ul> <li>Understanding the output of the above command  </li> </ul> <p>TrustedAttributes = Direction of Trust (1 = Non-Transitive, 2 = Transitive)  </p> <p>TrustedDirection = Direction of Trust (1 = Incoming Only, 2 = Outgoing Only, 3 = Two-way)  </p>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#running-script","title":"Running Script","text":""},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#dependencies","title":"Dependencies","text":""},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#other-available-tools","title":"Other available tools","text":""},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#references","title":"References","text":"<p>AD DS Cmdlets Get-DomainTrusts </p>"},{"location":"3.Containment/3.04_Export_Trust_relationships_from_Active_Directory/#revision-history","title":"Revision History","text":""},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/","title":"3.05-Export-OU Structure from Active Directory","text":""},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#task-export-organizational-unit-ou-structure-from-active-directory","title":"Task Export Organizational Unit (OU) structure from Active Directory","text":""},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#conditions","title":"Conditions","text":"<p>Given a Domain Controller (DC), a domain account with required permissions, and a workstation with Remote Server Administration Tools (RSAT)  </p>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#standards","title":"Standards","text":"<ul> <li>Team member obtains the correct name for the target domain  </li> <li>Team member determines the appropriate tool to connect to the domain controller and export the OU structure to a file on the local workstation  </li> </ul>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#end-state","title":"End State","text":"<p>All Organizational Unit (OU) information been exported to a local file for review  </p>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#notes","title":"Notes","text":"<p>There are multiple tools available for this task, including dsquery and PowerShell. There are multiple examples of scripts using these tools available via Microsoft Technet and other forums.  </p>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#manual-steps","title":"Manual Steps","text":"<p>Useful Commands: Windows * Get all of the OUs in a domain: <pre><code>Get-ADOrganizationalUnit -Filter * | Select-Object -ExpandProperty DistinguishedName\n\nGet-ADOrganizationalUnit -Filter 'Name -like \"*\"' | Format-Table Name, DistinguishedName -A\n</code></pre></p> <ul> <li> <p>List all OUs: <pre><code>dsquery ou DC=&lt;DOMAIN&gt;,DC=&lt;DOMAIN EXTENSION&gt;\n</code></pre></p> </li> <li> <p>List of workstations in the domain:     <pre><code>netdom query WORKSTATION\n</code></pre></p> </li> <li> <p>List of servers in the domain: <pre><code>netdom query SERVER\n</code></pre></p> </li> <li> <p>List of domain controllers: <pre><code>netdom query DC\n</code></pre></p> </li> <li> <p>List of organizational units under which the specified user can create a machine object: <pre><code>netdom query OU\n</code></pre></p> </li> <li> <p>List of primary domain controller: <pre><code>netdom query PDC\n</code></pre></p> </li> </ul>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#running-script","title":"Running Script","text":""},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#dependencies","title":"Dependencies","text":""},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#other-available-tools","title":"Other available tools","text":""},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#references","title":"References","text":"<p>Get-ADOrganizationalUnit PowerShell Cmdlet Get-OU_Permissions Dsquery OU command line reference LDIFDE.EXE command line tool CSVDE.EXE command line tool </p>"},{"location":"3.Containment/3.05_Export_OU_Structure_from_Active_Directory/#revision-history","title":"Revision History","text":""},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/","title":"3.06-Monitor Active Directory New Account Creation","text":""},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#task-monitor-ad-new-account-creation","title":"Task Monitor AD New Account Creation","text":""},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#conditions","title":"Conditions","text":"<p>Given a Domain Controller (DC), a domain account with required permissions, and a workstation with Remote Server Administration Tools (RSAT)  </p>"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#standards","title":"Standards","text":"<ul> <li>Team member obtains the correct name for the target domain  </li> </ul>"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#end-state","title":"End State","text":"<p>Monitor for creation of any new accounts that are created  </p>"},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#notes","title":"Notes","text":""},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#manual-steps","title":"Manual Steps","text":""},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#running-script","title":"Running Script","text":""},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#dependencies","title":"Dependencies","text":""},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#other-available-tools","title":"Other available tools","text":""},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#references","title":"References","text":""},{"location":"3.Containment/3.06_Monitor_AD_New_Account_Creation/#revision-history","title":"Revision History","text":""},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/","title":"3.07-Create Team Admin Account in Active Directory","text":""},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#task-create-team-admin-account-in-active-directory-ad","title":"Task Create Team Admin Account in Active Directory (AD)","text":""},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#conditions","title":"Conditions","text":"<p>Given a target Domain, a Domain Controller (DC), a user account with appropriate rights and privileges to modify user accounts, and a workstation with the Windows Remote Server Administration Tools (RSAT) installed.  </p>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#standards","title":"Standards","text":"<ul> <li>Team member coordinates the requirement to modify the Administrator Group on the Domain  </li> <li>Team member creates User Account in Active Directory on target Domain  </li> <li>Team member opens the Active Directory Users and Computers (ADUC) console on the workstation or Server and locates the Domain Admins Group account within the Organizational Unit (OU) structure  </li> <li>Team member resets the password and closes ADUC  </li> </ul> <p>OR  </p> <ul> <li>Team member coordinates the requirement to modify the creation of Team Accounts and addition of accounts to Domain Admin Group with enclave administrators.  </li> <li>Team member utilizes Active Directory Users and Computers (ADUC) or PowerShell cmdlets to create user accounts and modification of Domain Group membership  </li> </ul>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#end-state","title":"End State","text":"<p>New user account is created in Active Directory with Domain Admin credentials that the Team can utilize to carry out protection tasks.  </p>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#notes","title":"Notes","text":"<p>Mission Element lead ought to request this capability of the business owner in order to secure accounts and organizational units  </p>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#manual-steps","title":"Manual Steps","text":"<ul> <li>Create Active Directory User  </li> <li>Click Start, click Administrative Tools, and then click Active Directory Users and Computers. The Active Directory Users and Computers MMC opens. If it is not already selected, click the node for your domain. For example, if your domain is example.com, click example.com.  </li> <li>In the details pane, right-click the folder in which you want to add a user account.  </li> <li>Active Directory Users and Computers/domain node/folder  </li> <li>Point to New, and then click User.  </li> <li>In First name, type the user's first name.  </li> <li>In Initials, type the user's initials.  </li> <li>In Last name, type the user's last name.  </li> <li>Modify Full name to add initials or reverse the order of first and last names.  </li> <li>In User logon name, type the name that will be used to log on to the Active Directory domain. Click Next.  </li> <li>In the New Object - User window, in Password and Confirm password, type the user's password, and then select the appropriate password options.  </li> <li> <p>Click Next. The last window allows you to review the parameters provided by on the previous steps. If you wish to modify any parameters, click Back; otherwise, click Finish to create the domain administrator account.  </p> </li> <li> <p>Assign Group Membership  </p> </li> <li>Click Start, click Administrative Tools, and then click Active Directory Users and Computers. The Active Directory Users and Computers MMC opens. If it is not already selected, click the node for your domain. For example, if your domain is example.com, click example.com.  </li> <li>In the details pane, double-click the folder that contains the group to which you want to add a member.  </li> <li>Active Directory Users and Computers/domain node/folder that contains the group  </li> <li>In the details pane, right-click the group to which you want to add a member, and then click Properties. The group Properties dialog box opens.  </li> <li>Select the Members of tab, then click Add.  </li> <li>In Enter the object names to select, type the name of the user, group, or computer that you want to add, and then click OK.  </li> <li>To assign group membership to other users, groups or computers, repeat steps 4 and 5 of this procedure.  </li> </ul>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#running-script","title":"Running Script","text":""},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#dependencies","title":"Dependencies","text":""},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#other-available-tools","title":"Other available tools","text":""},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#references","title":"References","text":"<p>Create user in Active Directory Assign Group Membership </p>"},{"location":"3.Containment/3.07_Create_team_admin_account_in_AD/#revision-history","title":"Revision History","text":""},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/","title":"3.08-Change Domain Administrator Account","text":""},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#task-change-local-administrator-account-password-on-domain-controller-dc","title":"Task Change Local Administrator Account Password on Domain Controller (DC)","text":""},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#conditions","title":"Conditions","text":"<p>Given a target Domain, a Domain Controller (DC), a user account with appropriate rights and privileges to modify user accounts, and a workstation with the Windows Remote Server Administration Tools (RSAT) installed  </p>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#standards","title":"Standards","text":"<ul> <li>Team member coordinates the requirement to modify the Administrator account on the DC  </li> <li>Team member opens the Active Directory Users and Computers (ADUC) console on the workstation and locates the built-in Administrator account within the Organizational Unit (OU) structure  </li> <li>Team member resets the password and closes ADUC  </li> </ul> <p>OR  </p> <ul> <li>Team member coordinates the requirement to modify the Administrator account on the DC  </li> <li>Team member utilizes AD PowerShell cmdlets to modify the Administrator account  </li> </ul>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#end-state","title":"End State","text":"<p>Target domain Administrator account password has been modified  </p>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#notes","title":"Notes","text":"<p>Mission Element lead ought to request this capability of the business owner in order to secure accounts and organizational units  </p>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#manual-steps","title":"Manual Steps","text":"<p>Caution should be used when changing the domain Administrator password. In some environments the domain Administrator account may be tied to various services which may or not be affected. In a response scenario, this action should be closely coordinated with the system owner who can assist in monitoring the impact to the enclave. * Example PowerShell Command:     * Using CNAME <pre><code>Set-ADAccountPassword 'CN=&lt;CN Name&gt;,OU=&lt;OU&gt;,DC=&lt;domain&gt;,DC=&lt;DC&gt;' -Reset -NewPassword (ConvertTo-SecureString -AsPlainText \"&lt;NewPassword&gt;\" -Force)\n</code></pre></p> <pre><code>* Using SAM Account Name  \n    ```powershell  \n    Set-ADAccountPassword -Identity &lt;SAMAccountName&gt; -OldPassword (ConvertTo-SecureString -AsPlainText \"&lt;old password&gt;\" -Force) -NewPassword (ConvertTo-SecureString -AsPlainText \"&lt;new password&gt;\" -Force)\n    ```\n</code></pre>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#running-script","title":"Running Script","text":""},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#dependencies","title":"Dependencies","text":""},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#other-available-tools","title":"Other available tools","text":""},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#references","title":"References","text":"<p>PowerShell Set-ADAccountPassword documentation </p>"},{"location":"3.Containment/3.08_Change_Domain_Administrator_account/#revision-history","title":"Revision History","text":""},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/","title":"3.09-Disable Domain Administrator Account","text":""},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#task-protect-domain-administrator-account","title":"Task Protect Domain Administrator Account","text":""},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#conditions","title":"Conditions","text":"<p>Given a target Domain, a Domain Controller (DC), a user account with appropriate rights and privileges to modify user accounts, and a workstation with the Windows Remote Server Administration Tools (RSAT) installed  </p>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#standards","title":"Standards","text":""},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#end-state","title":"End State","text":"<p>Target domain Administrator account has been renamed and alternate dummy account named \u201cAdministrator\u201d with no rights or privileges has been created  </p>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#notes","title":"Notes","text":"<p>Mission Element lead ought to request this capability of the business owner in order to secure accounts and organizational units  </p> <p>The specific DCO-E MET that drives this task requires the domain Administrator account to be disabled; however, Microsoft recommends the steps as provided in this task. Disabling the Domain Administrator account can cause issues across a range of services and assets. While this task does not totally protect against specific attack vectors, it is part of the Center for Information Security (CIS) Benchmarks and Defense Information Systems Agency (DISA) Security Technical Implementation Guide (STIG) requirements for Microsoft Operating Systems. These tasks can also be accomplished using PowerShell scripts using the PowerShell AD Cmdlets.  </p>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#manual-steps","title":"Manual Steps","text":"<p>Useful commands:  </p> <ul> <li> <p>Open Active Directory Users and Computers(GUI): <pre><code>dsa.msc  \n</code></pre></p> </li> <li> <p>Rename local administrator account: <pre><code>wmic useraccount where name='Administrator' call rename name='NewAdminName'\n</code></pre></p> </li> <li> <p>Create account named Administrator, but with no permissions, and only after default Administrator accounts is renamed(Warning if done wrong, could result in lockout): <pre><code>net user Administrator C0mplex_P@ssword /ADD /PASSWORDCHG:NO\n</code></pre></p> </li> <li> <p>Disable Administrator account: <pre><code>Net user Administrator /active:no\n</code></pre></p> </li> <li> <p>Remove Administrator account description(beta): <pre><code>Set-ADUser Administrator -Description \"\"\nSet-ADUser -Identity Administrator -City \"\" -Clear \"\" -Company \"\" -Country \"\" -Department \"\" -Description \"\" -DisplayName \"\" -Division \"\" -EmailAddress \"\" -EmployeeID \"\" -EmployeeNumber \"\" -Fax \"\" -GivenName \"\" -HomeDirectory \"\" -HomeDrive \"\" -HomePage \"\" -HomePhone \"\" -Initials \"\" -LogonWorkstations \"\" -MobilePhone \"\" -Office \"\" -OfficePhone \"\" -Organization \"\" -OtherName \"\" -POBox \"\" -PostalCode \"\" -ProfilePath \"\" -SamAccountName \"\" -ScriptPath \u201c\u201d -State \"\" -StreetAddress \"\" -Surname \"\" -Title \"\" -UserPrincipalName \"\" -Partition \"\" -Server \"\"\n</code></pre></p> </li> </ul>"},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#running-script","title":"Running Script","text":""},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#dependencies","title":"Dependencies","text":""},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#other-available-tools","title":"Other available tools","text":""},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#references","title":"References","text":""},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#disa-stigs","title":"DISA STIGS","text":""},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#cis-benchmark-downloads","title":"CIS Benchmark downloads","text":""},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#securing-ad-administrative-groups-and-accounts","title":"Securing AD Administrative Groups and Accounts","text":""},{"location":"3.Containment/3.09_Disable_Domain_Administrator_password/#revision-history","title":"Revision History","text":""},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/","title":"3.10-Change or Disable Workstation Local Administrators","text":""},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#task-change-or-disable-workstation-local-administrator-account","title":"Task Change or Disable Workstation Local Administrator Account","text":""},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#conditions","title":"Conditions","text":"<p>Given domain credentials with the appropriate permissions, and an incident response workstation with necessary tools and accounts.  </p>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#standards","title":"Standards","text":"<p>The built-in administrator account is a well-known account subject to attack. It also provides no accountability to individual administrators on a system.  </p> <ul> <li>Team member coordinates the requirement of Disabling the Local Workstation Administrator Account.  </li> <li>Team member creates Group Policy Object (GPO) in Group Policy Management Console (GPMC) to disable the Local Workstation Local Administrator account  </li> <li>Team member links Group Policy Object (GPO) to workstation Organizational Unit (OU) in Active Directory  </li> </ul>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#end-state","title":"End State","text":""},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#manual-steps","title":"Manual Steps","text":"<p>Group Policy Object (GPO) is the recommend course of action to complete this task. GPO can be created by using the Computer Policy -&gt; Windows Settings -&gt; Security Settings -&gt; Local Policies -&gt; Security Options and then Accounts:Administrator account settings to Disabled Once GPO is created it should be linked to all Workstation Objects in the Domain. Once this GPO is linked it will effectively disable all Local Administrator Account where it is linked  </p> <p>OR  </p> <p>Use the net user command to disable the Administrator account <pre><code>net user administrator /active:no\n</code></pre></p>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#running-script","title":"Running Script","text":""},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#dependencies","title":"Dependencies","text":""},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#other-available-tools","title":"Other available tools","text":""},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#references","title":"References","text":"<p>Windows 7 Security Technical Implementation Guide Enable / Disable Administrator account Creating Group Policy Object </p>"},{"location":"3.Containment/3.10_Change_or_disable_Workstation_local_Administrators/#revision-history","title":"Revision History","text":""},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/","title":"3.11-Verify Patch Compliance on all hosts","text":""},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#task-verify-patch-compliance-on-all-hosts-systems","title":"Task Verify Patch Compliance on all Hosts systems","text":""},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#conditions","title":"Conditions","text":"<p>Given domain credentials with the appropriate permissions, and a vulnerability scanner perform a vulnerability scan from an incident response workstation.  </p>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#standards","title":"Standards","text":"<ul> <li>Detect. Use approved scanning tool to scan your systems for missing security patches.  </li> <li>Assess. If necessary updates are not installed, determine the severity of the issue(s) addressed by the patch and the mitigating factors that may influence your decision. By balancing the severity of the issue and mitigating factors, you can determine if the vulnerabilities are a threat to your current environment.  </li> <li>Approval. Obtain appropriate approval on enclave prior to proceeding with remediation procedures  </li> <li>Document. Document actions and approval through change management procedures.  </li> <li>Acquire. If the vulnerability is not addressed by the security measures already in place, download the patch for testing.  </li> <li>Test. Install the patch on a test system to verify the ramifications of the update against your production configuration.  </li> <li>Deploy. Deploy the patch to production computers. Make sure your applications are not affected. Employ your rollback or backup restore plan if needed.  </li> </ul>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#end-state","title":"End State","text":"<p>Perform a Vulnerability scan on targeted systems in enclave and verify patch compliance is within standards with local policy requirements.  </p>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#notes","title":"Notes","text":""},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#manual-steps","title":"Manual Steps","text":"<p>Detect open vulnerabilities using OpenVAS Security scanner  </p> <ul> <li>Access OpenVAS web front-end at https://x.x.x.x:9392 </li> <li>Enter the IP address or host name of the system(s) you wish to scan and press <code>Start Scan</code> <ul> <li>You will be presented with an updated progress bar as the scan progresses through the scan  </li> <li>Once the scan is completed you will be presented with a results page  </li> </ul> </li> <li>Verify results are in compliance with enclave SOP and local policy  </li> <li>Review the report \u2013 The complete report as well as only filtered results can be viewed and downloaded. By default only the High and Medium risks are displayed.  </li> </ul> <p>OR  </p> <p>To manually detect missing updates using the MBSA graphical interface  </p> <ul> <li>Run MBSA by double-clicking the desktop icon or by selecting it from the Programs menu.  </li> <li>Click Scan a computer. MBSA defaults to the local computer. To scan multiple computers, select Scan more than one computer and select either a range of computers to scan or an IP address range.  </li> <li>Clear all check boxes except Check for security updates. This option detects uninstalled patches and updates.  </li> <li>Click Start scan. Your server is now analyzed. When the scan is complete, MBSA displays a security report and also writes the report to the %userprofile%\\SecurityScans directory.  </li> <li>Download and install the missing updates. Click the Result details link next to each failed check to view the list of uninstalled security updates. A dialog box displays the Microsoft security bulletin reference number. Click the reference to find out more about the bulletin and to download the update.  </li> </ul> <p>OR  </p> <p>Windows: To detect missing updates using the MBSA command line interface  </p> <ul> <li> <p>From a command window, change directory to the MBSA installation directory, and type the following command <pre><code>mbsacli /i 127.0.0.1 /n OS+IIS+SQL+PASSWORD\n</code></pre></p> </li> <li> <p>You can also specify a computer name. For example: <pre><code>mbsacli /c domain\\machinename /n OS+IIS+SQL+PASSWORD\n</code></pre></p> </li> <li> <p>You can also specify a range of computers by using the /r option. For example: <pre><code>mbsacli /r 192.168.0.1-192.168.0.254 /n OS+IIS+SQL+PASSWORD\n</code></pre></p> </li> <li> <p>Finally, you can scan a domain by using the /d option. For example: <pre><code>mbsacli /d NameOfMyDomain /n OS+IIS+SQL+PASSWORD\n</code></pre></p> </li> </ul> <p>To analyze the generated MSBA report  </p> <ul> <li>Run MBSA by double-clicking the desktop icon or by selecting it from the Programs menu.  </li> <li>Click Pick a security report to view and open the report or reports, if you scanned multiple computers.  </li> <li> <p>To view the results of a scan against the target machine, mouse over the computer name listed. Individual reports are sorted by the timestamp of the report.  </p> </li> <li> <p>Ubuntu:  </p> <ul> <li> <p>Fetch list of available updates: <pre><code>apt-get update\n</code></pre></p> </li> <li> <p>Strictly upgrade the current packages: <pre><code>apt-get upgrade\n</code></pre></p> </li> <li> <p>Install updates (new ones): <pre><code>apt-get dist-upgrade\n</code></pre></p> </li> </ul> </li> <li> <p>Red Hat Enterprise Linux 2.1,3,4:  </p> <ul> <li> <p>Install updates (new ones): <pre><code>up2date\n</code></pre></p> </li> <li> <p>To update non-interactively: <pre><code>up2date-nox --update\n</code></pre></p> </li> <li> <p>To install a specific package: <pre><code>up2date &lt;PACKAGE NAME&gt;\n</code></pre></p> </li> <li> <p>To update a specific package: <pre><code>up2date -u &lt;PACKAGE NAME&gt;\n</code></pre></p> </li> </ul> </li> <li> <p>Red Hat Enterprise Linux 5: <pre><code>pup\n</code></pre></p> </li> <li> <p>Red Hat Enterprise Linux 6:  </p> <ul> <li> <p>Fetch list of available updates: <pre><code>yum update\n</code></pre></p> </li> <li> <p>To list a specific installed package: <pre><code>yum list installed &lt;PACKAGE NAME&gt;  \n</code></pre></p> </li> <li> <p>To install a specific package: <pre><code>yum install &lt;PACKAGE NAME&gt;\n</code></pre></p> </li> <li> <p>To update a specific package: <pre><code>yum update &lt;PACKAGE NAME&gt;\n</code></pre></p> </li> </ul> </li> <li> <p>Kali: <pre><code>apt-get update &amp;&amp; apt-get upgrade\n</code></pre></p> </li> </ul>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#running-script","title":"Running Script","text":""},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#dependencies","title":"Dependencies","text":""},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#other-available-tools","title":"Other available tools","text":""},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#references","title":"References","text":"<p>OpenVAS setup instructions OpenVAS Documentation Microsoft Baseline Security Analyzer NIST SP 800-42, Guidelines on Network Security Testing NIST SP 800-40, Creating a Patch and Vulnerability Management Program </p>"},{"location":"3.Containment/3.11_Verify_patch_compliance_on_all_hosts/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/","title":"4.Eradication","text":""},{"location":"4.Eradication/#eradication-tasks","title":"Eradication Tasks","text":"<p>Develop and implement appropriate activities to eradicate the occurrence of a cybersecurity event.  </p>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/","title":"4.01-Synchronize Time on all hosts","text":""},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#synchronize-all-host-clocks","title":"Synchronize all host clocks","text":""},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#conditions","title":"Conditions","text":"<p>Given a known network configuration, an NTP data source(s), and system owner preferences on time synchronization within their enclave  </p>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#standards","title":"Standards","text":"<ul> <li>Identify or stand up Network Time Protocol (NTP) server.  </li> <li>Ensure NTP server is set to synchronize from a known good time source (ex: time.nist.gov).  </li> <li>Configure all non-Windows systems to synchronize from the local NTP server.  </li> <li>Configure all Windows systems which are not members of a domain to synchronize from the local NTP server.  </li> <li>Configure Windows primary domain controller to synchronize from the local NTP server and configure GPO settings for domain.  </li> </ul>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#end-state","title":"End State","text":"<p>All host clocks in the environment are synchronized from a known good time source, enabling operations and accurate forensic log analysis.  </p>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#notes","title":"Notes","text":"<p>Windows domain member systems will automatically synchronize their time based on the primary domain controller (PDC).  Best Practices for NTP configuration include filtering the NTP protocol at the firewall and blocking outbound NTP (to prevent being used in a Distributed Denial-of-Service (DDOS) attack).  </p>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#windows","title":"Windows","text":"<ul> <li> <p>Check NTP Status: <pre><code>w32tm /query /status\n</code></pre></p> </li> <li> <p>Check NTP Configuration: <pre><code>w32tm /query /configuration\n</code></pre></p> </li> <li> <p>Start NTP Windows: <pre><code>net start w32time\n</code></pre></p> </li> <li> <p>Check NTP sever settings in registry: <pre><code>reg QUERY HKLM\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Parameters\n</code></pre></p> </li> <li> <p>Check NTP settings in registry: <pre><code>reg QUERY HKLM\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Config\nw32tm /dumpreg\n</code></pre></p> </li> <li> <p>Get Date and Time:     <pre><code>Get-Date -F o\n</code></pre></p> </li> <li> <p>Set NTP Server: <pre><code>w32tm /config /manualpeerlist:time.nist.gov /syncfromflags:manual /reliable:yes /update\n</code></pre></p> </li> <li> <p>Restore NTP settings back to default: <pre><code>net stop w32time\nw32tm /unregister\nw32tm /unregister (Yes run twice)\nw32tm /register\nnet start w32time\n</code></pre></p> </li> </ul>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#linux","title":"Linux","text":"<ul> <li> <p>Check synchronized clock status: <pre><code>systemctl status systemd-timesyncd.service\n</code></pre></p> </li> <li> <p>Check NTP Status: <pre><code>timedatectl status\n</code></pre></p> </li> <li> <p>Configure NTP Server selection options: <pre><code>/etc/systemd/timesyncd.conf\n</code></pre></p> </li> <li> <p>Current NTP settings: <pre><code>cat /etc/ntp.conf\n</code></pre></p> </li> <li> <p>Restart NTP service after configuration changes: <pre><code>/etc/init.d/ntp restart\n</code></pre></p> </li> <li> <p>Check NTP synchronized servers: <pre><code>ntpq -p\nsystemctl status systemd-timesyncd.service\n</code></pre></p> </li> <li> <p>Check NTP Status: <pre><code>timedatectl status\n</code></pre></p> </li> <li> <p>Configure NTP Server selection options: <pre><code>/etc/systemd/timesyncd.conf\n</code></pre></p> </li> <li> <p>Current NTP settings: <pre><code>cat /etc/ntp.conf\n</code></pre></p> </li> <li> <p>Restart NTP service after configuration changes: <pre><code>/etc/init.d/ntp restart\n</code></pre></p> </li> <li> <p>Check NTP synchronized servers: <pre><code>ntpq -p\n</code></pre></p> </li> </ul>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#running-script","title":"Running Script","text":""},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#other-available-tools","title":"Other available tools","text":""},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#references","title":"References","text":"<p>Good information on implementing NTP VMWare info on NTP for Windows Guest operating systems Cisco Best Practices </p>"},{"location":"4.Eradication/4.01_Synchronize_all_host_clocks/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/","title":"4.02-Enable Account Usage Auditing","text":""},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/#task-enable-account-usage-auditing","title":"Task Enable Account Usage Auditing","text":""},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/#conditions","title":"Conditions","text":"<p>Given a user account with necessary rights to modify audit policies and a target computer    </p>"},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/#standards","title":"Standards","text":"<ul> <li>Team member enables of the following auditing  </li> <li>Credential validation - Success  </li> <li>Logon events - Success and Failure  </li> <li>Logoff events - Success  </li> <li>Computer account management - Success and Failure etc  </li> <li>Team member checks Windows Security event logs to ensure expected log entries are present        </li> </ul>"},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/#end-state","title":"End State","text":"<p>System is configured to log account usage events in support of operational and forensic auditing that are compliant with the system owner's needs and meet regulatory compliance requirements for the enclave.   </p>"},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/#notes","title":"Notes","text":"<p>Mission Element lead ought to request this capability of the business owner in order to secure accounts and organizational units  </p>"},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/#manual-steps","title":"Manual Steps","text":"<ul> <li> <p>Set log auditing on for success and/or failure on subcategories. This will be for all subcategories   <pre><code>auditpol /set /subcategory:\"Logon\" /success:enable /failure:enable    \nThe command was successfully executed.     \n</code></pre></p> </li> <li> <p>View the available log files, size, and retention limit   <pre><code>Get-EventLog -List\n  Max(K) Retain OverflowAction        Entries Log                                                                              \n  ------ ------ --------------        ------- ---                                                                              \n--snipped--                                                        \n  20,480      0 OverwriteAsNeeded      16,209 Security                                                                         \n  20,480      0 OverwriteAsNeeded       2,722 System                                                                           \n--snipped--\n</code></pre></p> </li> <li> <p>Partial list of Key Security Log Auditing events to monitor   <pre><code>Get-EventLog -Newest 3 -LogName Security \n\n  Index Time          EntryType   Source                 InstanceID Message                                                   \n  ----- ----          ---------   ------                 ---------- -------                                                   \n  407734 Aug 15 10:36  SuccessA... Microsoft-Windows...         4703 A token right was adjusted....                            \n  407733 Aug 15 10:36  SuccessA... Microsoft-Windows...         4703 A token right was adjusted....                            \n  407732 Aug 15 10:36  SuccessA... Microsoft-Windows...         4703 A token right was adjusted....\n</code></pre></p> </li> <li> <p>After running the script, you will see the following output:   <pre><code>--snipped--\n[+] There are 59 categories/subcategories.\n[+] Enabling logs for success and failure for: Security System Extension\n[+] Enabling logs for success and failure for: System Integrity\n--snipped--\n[+] There are 7 available logs:\n    --&gt; Information for Application\n            OverflowAction: OverwriteAsNeeded\n    --&gt; Information for HardwareEvents\n            OverflowAction: OverwriteAsNeeded\n--snipped--\n</code></pre></p> </li> </ul>"},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/#references","title":"References","text":"<p>Windows Commands AuditPol </p>"},{"location":"4.Eradication/4.02_Enable_Account_Usage_Auditing/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/","title":"4.03-Deploy Network Intrusion Detection System","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#task-deploy-network-intrusion-detction-system","title":"Task Deploy Network Intrusion Detction System","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#conditions","title":"Conditions","text":"<p>Deploy:  IR Team supporting a mission partner or Guardnet/DoDIN enclave without appropriate Network IDS or IPS installations. Evaluate: IR Team supporting a mission partner or Guardnet/DoDIN enclave with access to appropriate systems / capabilities to evaluate existing Network IDS or IPS installations.  </p>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#standards","title":"Standards","text":"<p>Deploy: Same as Evaluate (below) with the exception of assessing mission partner or Guardnet/DoDin enclave networks for placement of IDPS capabilities. Additionally, as requested or directed deploy IDPS capabilities. Once deployed, conduct the Evaluate process to assess operational effectiveness.  </p> <ul> <li>Identify and prepare Detection Systems.  <ul> <li>Find what systems are available or what is necessary to Mission (likely to be directed if Unit is not allowed).  </li> <li>Identify/Rate strengths and weaknesses of systems.  </li> <li>Install necessary programs/systems critical to Mission.  </li> </ul> </li> <li>Identify or Obtain login credentials  <ul> <li>Obtain IP path to login.  </li> <li>Obtain/create User ID to login.  </li> <li>Obtain/create Password (ensure strong password creation).  </li> </ul> </li> <li>Test accessibility.  <ul> <li>Connect to the system with credentials.  </li> <li>Report inconsistencies  </li> </ul> </li> <li>Develop the detection scheme.  <ul> <li>Establish detection plan following the evaluation of the network (see below).  </li> <li>Re-evaluate and continue to develop improved detection throughout the mission.  </li> </ul> </li> </ul> <p>Evaluate (and assess):  </p> <ul> <li>Identify and correlate current system to typical components and network architectures. Build or utilize a Common Operating Picture for the team. (see Figures 4-2 and 4-3, below)  </li> <li>Identify/locate potential entry points to network.  <ul> <li>Identify Internet entry points.  </li> <li>Identify \u201ccontained\u201d wireless connections within the network.  </li> </ul> </li> <li>Identify/locate choke points and fire walls.  <ul> <li>Identify locations on the network where information traffic must travel.  </li> <li>Identify fire wall control points and what is \"protected by\" the wall.  </li> <li>Grade firewalls on placement. (use Figures 4-2 and 4-3 to determine standards)  </li> <li>Grade protection of zones with independent fail conditions as safer. (i.e. if Zone A\u2019s Firewall is lost is Zone B compromised as well? Does compromise fail a switch/router critical to multiple Zones?)  </li> </ul> </li> <li>Identify/locate current detection systems, and sensors.  <ul> <li>Identify where detection systems are located on the network.  </li> <li>Identify where on the system sensors are installed.  </li> <li>Identify path(s) from the IR Team entry point to the detection system(s).  </li> <li>Identify paths from the detection system(s) to the network sensors.  </li> <li>Grade said sensors based on choke point vulnerabilities and Zones covered.  </li> </ul> </li> <li>Identify full system maintenance schedule.  <ul> <li>Patch schedule for network component firmware (routers, switches, etc.).  </li> <li>Patch schedule for each firewall.  </li> <li>Patch/update schedule for detection system.  </li> <li>Grade how often each related patch update is available and equivalent components are capable thereof.  </li> </ul> </li> </ul> <p>Components and Architecture  </p> <ul> <li>Typical Components  </li> <li>Network Architectures  </li> </ul> <p>Security Capabilities  </p> <ul> <li>Information Gathering Capabilities  </li> <li>Logging Capabilities  </li> <li>Detection Capabilities  </li> <li>Prevention Capabilities  </li> </ul> <p>Management  </p> <ul> <li>Implementation  </li> <li>Operation and Maintenance  </li> </ul> <p>Considerations include both Wired and Wireless network IDPS capabilities  </p>"},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#end-state","title":"End State","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#notes","title":"Notes","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#running-script","title":"Running Script","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#other-available-tools","title":"Other available tools","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#references","title":"References","text":""},{"location":"4.Eradication/4.03_Deploy_network_intrusion_detection_system/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/","title":"4.04-Monitor NIDS and Report Threats","text":""},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#task-monitor-network-intrusion-detection-system-nids-and-report-threats","title":"Task Monitor Network Intrusion Detection System (NIDS) and Report Threats","text":""},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#conditions","title":"Conditions","text":"<p>Given a fully installed NIDS, e.g. Security Onion, connected to a span port or tap that monitors key terrain, an account for the NIDS, a known network topology and list of computers and provided services, and access to a second computer with Internet access for investigation.  </p>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#standards","title":"Standards","text":"<ul> <li>Scan anomalies and irregularities within the interface to find possible malicious activity  </li> <li>Investigate suspicious anomalies to make a reasonable determination the NIDS information represents malicious activity  </li> <li>Use other tools (e.g. Bro/Zeke, Wireshark, Snort/Suricata) to validate the incident and rule out false positives  </li> <li>Report the incident to the intelligence team and the team leader  </li> <li>Collect all information relevant to the incident for a detailed report  </li> </ul>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#end-state","title":"End State","text":"<p>After investigating NIDS report and malicious activity is determined, the intelligence team and team leader are informed. The team leader then informs the network owner of the incident and begins the response process.  </p>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#notes","title":"Notes","text":""},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#manual-steps","title":"Manual Steps","text":"<ul> <li>Login to the NIDS interface, e.g. Security Onion.  </li> <li>Scan through dashboards, visualizations, alerts, and individual documents/logs to find suspicious network activity.  </li> <li>Investigate each suspicious action on the network. The goal at this point is to quickly eliminate false positives and prioritize positive reports for further investigation. This is likely where defenders will spend most of their time and effort.  </li> <li>Once activity is determined to likely be malicious, use other available tools to corroborate the information and establish certainty about the nature of the activity. False positives are still eliminated and positives reprioritized.  </li> <li>When the defender is reasonably certain the suspicious activity is actually malicious, they alert the intelligence team and team leader. This begins the parallel processes for addressing network incidents, e.g. collecting intelligence, corroborating information with other team members, identifying patterns of malicious activity.  </li> <li>Continue to collect information about the activity and move on to the next steps in the investigation.  </li> </ul>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#running-script","title":"Running Script","text":"<p>N/A  </p>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#dependencies","title":"Dependencies","text":"<ul> <li>Security Onion  <ul> <li>Zeek (formerly Bro)  </li> <li>Snort/Suricata  </li> <li>SGUIL  </li> <li>SO-forwarders  </li> </ul> </li> </ul>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#other-available-tools","title":"Other available tools","text":"<ul> <li>Splunk  </li> </ul>"},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#references","title":"References","text":""},{"location":"4.Eradication/4.04_Monitor_NIDS_and_Report_Threats/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/","title":"4.05-SIEM Events to IDS and Network Logs","text":""},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#task-investigate-alerts-from-network-security-information-and-event-management-siem-using-ids-and-other-logs","title":"Task Investigate Alerts from Network Security Information and Event Management (SIEM) using IDS and other Logs","text":""},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#conditions","title":"Conditions","text":"<p>Given a fully installed SIEM (e.g., Graylog or similar) configured to accept logs from network hosts, a logon account for the SIEM, and a known network topology  </p>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#standards","title":"Standards","text":"<ul> <li>Logon to the SIEM interface.  </li> <li>Scan for potential malicious or abnormal user or system activity, possibly by filtering events by certain category (e.g., logon/logoff of privileged users) to locate abnormal or suspected malicious behavior.  </li> <li>Using the reported information (user logon; privilege escalation; source/destination IP addresses, ports; file download information), conduct initial investigative steps to determine if activity can be deemed malicious.  </li> <li>If necessary, coordinate with other team members or system owner to determine if the activity is normal.  </li> <li>Notify Team Leader of suspected malicious activity and provide detailed information gathered from initial investigative steps.  </li> </ul>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#end-state","title":"End State","text":"<p>Suspected abnormal activity reported by SIEM is investigated, determined to be malicious activity and reported to team intel member and Team Lead for further action.  </p>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#notes","title":"Notes","text":"<p>Rarely will an alert displayed by a SIEM be sufficient to determine a course of action for the team. The SIEM operator must correlate reported activity against normal network and host activity often without the time to establish a proper baseline. As with NIDS monitoring, SIEM activity is only a piece of the puzzle that may lead to establishing the presence of malicious activity on the network. The SIEM operator should be aware of the cyber key terrain including servers, administrator accounts, file storage and database locations to name a few that will be likely targets. If Host-based Intrusion Detection systems are not being aggregated to the SIEM, the operator must coordinate with other Blue Team members and/or the system owner to access those logs to cross-check events in the SIEM.  </p>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#running-script","title":"Running Script","text":""},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#other-available-tools","title":"Other available tools","text":""},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#references","title":"References","text":"<p>Security Onion Splunk Enterprise Security SIEM </p>"},{"location":"4.Eradication/4.05_SIEM_Events_to_IDS_and_network_logs/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/","title":"Task Evaluate Host Kernel to Check for Rootkits","text":""},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#conditions","title":"Conditions","text":"<p>Given a suspected compromised Windows desktop computer system, a local administrator account, incident response tools, and one or more Indicators of Compromise (IOCs).  </p>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#standards","title":"Standards","text":"<ul> <li>The team member annotates the system name, serial number, manufacturer, and time of action in the Incident Log.   </li> <li>The team member inserts media that contains the rootkit detection application.   </li> <li>The team member runs the rootkit detection application with the correct parameters and exports the data to the local drive, external USB media, or network share. a. Removal of the rootkit is not part of this evaluation, only identification. Removal is part of Task 4.25: Stop Malware \u2013 Rootkit.  </li> <li>Review screen or tool log file for indicators of the presence of a rootkit against provided IOCs  </li> </ul>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#end-state","title":"End State","text":"<p>rootkit-related elements are identified  </p>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#notes","title":"Notes","text":"<p>When a rootkit is suspected, there are various considerations to consider when determining the best method to complete this task. Based on the IOCs some research of the suspected rootkit may preclude the connection of USB drives which may in turn be compromised. This task can be accomplished remotely using PSExec or batch file. Some tools require renaming before being copied to the compromised machine and should be covered in their documentation.   </p>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#manual-steps-for-linux","title":"Manual Steps for Linux","text":""},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#chkrootkit","title":"Chkrootkit","text":"<ul> <li> <p>Install chkrootkit <pre><code>sudo apt-get install chkrootkit\n</code></pre></p> </li> <li> <p>You can run chkrootkit once installation has been complete. <pre><code>chkrootkit\n</code></pre></p> </li> <li> <p>Investigate any findings  To view the help section for chkrootkit use the following command <pre><code>chkrootkit -h\n</code></pre></p> </li> </ul>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#rkhunter","title":"Rkhunter","text":"<ul> <li> <p>Install rkhunter <pre><code>sudo apt-get install rkhunter\n</code></pre></p> </li> <li> <p>View the options for rkhunter by typing the following command <pre><code>rkhunter\n</code></pre></p> </li> <li> <p>Run rkhunter <pre><code>rkhunter -c\n</code></pre></p> </li> <li> <p>View results in the terminal or read the log file. The location for the log file is located in /var/log/rkhunter.log <pre><code>cat /var/log/rkhunter.log\n</code></pre></p> </li> <li> <p>Investigate any findings  </p> </li> </ul>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#references","title":"References","text":"<p>chkrootkit - Linux rkhunter - Linux GMER Windows Defender Offline (32-bit and 64-bit downloads from Microsoft.com)  TDSSKiller - Kaspersky McAfee Rootkit Remover OSSEC </p>"},{"location":"4.Eradication/4.06_Evaluate_Host_Kernel_to_Check_for_Rootkits/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/","title":"4.07-Use Host Log Data to Evaluate System Processes","text":""},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#task-use-host-log-data-to-evaluate-system-processes","title":"Task Use Host Log Data to Evaluate System Processes","text":""},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#conditions","title":"Conditions","text":"<p>Given a suspected compromised Windows desktop computer system, local administrator account credentials, one or more Indicators of Compromise (IOCs) and incident response software  </p>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#standards","title":"Standards","text":"<ul> <li>The team member annotates the system name, serial number, manufacturer, and time of action in the Incident Log.  </li> <li>The team member logs into or connects remotely using the credentials of an account with local administrator privileges.  </li> <li>The team member obtains an image of the target computer physical memory to an external USB drive or network share.   </li> <li>The team member obtains a cryptographic hash (MD5 or SHA1) of the physical memory image and saves to a file on an external USB drive or network share.  </li> <li>The team member utilizes a file hashing utility to gather the MD5 and/or SHA1 hashes of all files on the target computer and saves to a file on an external USB drive or network share.  </li> <li>The team member utilizes the tools from the selected incident response software to obtain the following information from the target system and saves the data to an external USB drive or network share:  <ul> <li>System date/time with time zone  </li> <li>Operating System version plus Service pack, if any  </li> <li>Memory capacity (RAM)  </li> <li>Listing of hard drives and sizes  </li> <li>Current and previous file system mount information  </li> <li>USB connection history  </li> <li>List of auto-run software (registry keys, Startup folder, etc.)  </li> <li>Listing of services and status  </li> <li>List of installed software  </li> <li>List of scheduled tasks  </li> <li>List of local user accounts and group membership  </li> <li>List of network interfaces with IP and MAC addresses  </li> <li>Routing table  </li> <li>Arp cache  </li> <li>DNS cache  </li> <li>Network connections with associated processes  </li> <li>Loaded drivers  </li> <li>Open files and handles  </li> <li>Running processes with Process ID (PID) and runtime information  </li> <li>All Windows event logs  </li> <li>Antivirus, firewall or HIDS logs if available  </li> </ul> </li> <li>The team member reviews the log and text files obtained in Step 6 for entries that match one or more IOCs.  </li> </ul>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#end-state","title":"End State","text":"<p>Log and text file entries are found that match provided IOCs  </p>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#manual-steps","title":"Manual Steps","text":"<p>NA</p>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#running-script","title":"Running Script","text":"<p>After downloading script, Launch powershell with Administrative Privileges, select options to run and press q to quit  </p>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#dependencies","title":"Dependencies","text":"<ul> <li>Download Powershell  </li> <li>Windows Operating System  </li> </ul>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#other-available-tools","title":"Other available tools","text":"<p>NA  </p>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#references","title":"References","text":"<p>PowerShell Overview </p>"},{"location":"4.Eradication/4.07_Use_Host_Log_Data_to_Evaluate_System_Processes/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/","title":"4.08-Deploy or Evaluate Host Sensors","text":""},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#task-deploy-or-evaluate-host-sensors-prepare-security-onion-to-listen-for-wazuh-agents-on-the-network","title":"Task Deploy or Evaluate Host Sensors (Prepare Security Onion to listen for Wazuh agents on the network)","text":""},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#conditions","title":"Conditions","text":"<p>Given access to a network and the ability to install and configure Security Onion  </p>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#standards","title":"Standards","text":"<ul> <li>Prepare Security Onion to listen for and recieve sysmon logs through deployed Wazzuh agents  </li> <li>Configure Wazzuh agents to forward local sysmon logs on compromised hosts to Security Onion NIDS  </li> </ul>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#end-state","title":"End State","text":"<p>Hosts on compromised network utilize wazzuh to forward sysmon and event logs to Security Onion NIDS for parsing in Kibana  </p>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#notes","title":"Notes","text":""},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#set-up","title":"Set Up","text":"<ul> <li><code>Security Onion Host (Linux - NIDS)</code>: This is the security onion box that we bring to the environment.  </li> <li><code>Windows Workstations</code>: Client hosts at the incident site.  </li> </ul>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#configure-security-onion-to-receive-logs","title":"Configure Security Onion to receive logs.","text":"<p>On the Security Onion system, log into the local system. Open two Terminal windows, further referred to as Terminal A and B.  </p> <p></p> <p>In Terminal A: <pre><code>sudo so-wazuh-stop\n</code></pre></p> <p>In Terminal B, run the command to bring \"ossec-authd\" to the foreground: <pre><code>sudo /var/ossec/bin/ossec-agentd -f \n</code></pre></p> <p>In Terminal A, start ossec again: <pre><code>sudo so-wazuh-start \n</code></pre></p>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#install-software-on-windows-hosts","title":"Install Software on windows hosts","text":"<ul> <li>The repository comes with all the necessary files for deployment, but it is preferable to download the Wazuh agent from Security Onion system currently deployed for the mission  </li> <li>Login into Security Onion, select <code>Downloads</code> from the menu on the left, and download the Wazuh agent for Windows.  Ensure the file is unblocked once downloaded  </li> </ul> <ul> <li>Modify files:  Edit /scripts/install-sysmon.bat Edit IP address to reflect your Security Onion IP address: <code>/scripts/install-sysmon.bat</code> </li> </ul> <p>Edit ossec.conf  Change IP address to reflect your Security Onion address  </p> <p> </p> <ul> <li>Running PowerShell script on Windows hosts  </li> <li> <p>Run the PowerShell script: <pre><code>scripts\\Software_Push.ps1\n</code></pre></p> </li> <li> <p>Enter domain credentials User: Administrator@domain.name </p> </li> <li> <p>Enter Install Parameters IP Address: The Ip address of the machine that you are running the script from Domain Admin Password: Enter Domain Admin Password Domain: Domain name  </p> </li> <li> <p>Click <code>Run</code> to allow psexec to execute  </p> </li> </ul> <p> </p> <ul> <li>Listing Wazuh agents <pre><code>so-wazuh-agent-manage\n</code></pre></li> </ul>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#dependencies","title":"Dependencies","text":"<ul> <li>Security Onion NIDS  </li> <li>Privileged access to target network hosts.  </li> </ul>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#other-available-tools","title":"Other available tools","text":"<ul> <li>Ossec in place of Wazzuh  </li> </ul>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#references","title":"References","text":"<p>Installing Wazuh Wazuh </p>"},{"location":"4.Eradication/4.08_Deploy_or_evaluate_host_sensors/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/","title":"4.09-Install and Deploy Security Onion","text":""},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#task-install-and-deploy-security-onion","title":"Task Install and Deploy Security Onion","text":""},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#conditions","title":"Conditions","text":"<p>Given a Linux Security Onion machine.  </p>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#standards","title":"Standards","text":"<ul> <li>Configuring Security Onion (SO) from an instantiated virtual machine.  </li> <li>Setup Security Onion firewall rules.  </li> <li>Connecting to security onion from another box  </li> </ul>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#end-state","title":"End State","text":"<p>Fully functioning Security Onion NIDS recieving and parsing logs from target network segments.  </p>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#manual-steps","title":"Manual Steps","text":"<ul> <li>Configuring Security Onion (SO) from an instantiated virtual machine.  </li> <li> <p>Login to SO     Note: for range use creds from SharePoint  </p> <ul> <li>Open Terminal \u2013 click on <code>Applications</code> in the top left corner, scroll down to \"Utilities\" then scroll and click on <code>Terminal</code>, leave this off to the side (id=TERM)  </li> <li>Launch setup \u2013 Double click setup icon on desktop  Note: use password from step 1.1 in setup  </li> <li>Select <code>Yes, Continue!</code> \u2013  </li> <li>Select <code>Yes, configure /etc/\u2026.</code> \u2013  </li> <li>Select the management interface \u2013 in TERM type ip address and verify that the interface has an ipv4 configured on it and is the same as the one selected  </li> <li>Set a static ip \u2013 make sure static is selected and select <code>ok</code> </li> <li>Input the ipv4 address for the interface selected in step 1.6 then select <code>ok</code> \u2013 refer to TERM  </li> <li>Input your network subnet \u2013 refer to TERM for subnet CIDR notation of interface selected in step 1.6  </li> <li>Input your gateway IP Address \u2013 in TERM type ip route use ip after <code>default route ..&lt;gateway&gt;</code> </li> <li>Input your DNS \u2013 in TERM type nslookup then input any character and select <code>enter</code>, add both DNS servers  </li> <li>Input your Domain Name -  in TERM press <code>ctrl c</code> then type hostname -f  input everything after the first period, select ok  </li> <li>Select <code>Yes, configure\u2026</code> to  \u2013 configure sniffing  interfaces  </li> <li>Verify that the interface selected in step 1.6 is not selected and select <code>ok</code> </li> <li>Select <code>Yes, make changes!</code> \u2013 to confirm changes  </li> <li>Select <code>Yes, Reboot!</code> </li> <li>Log into Security Onion - Re-enter login credentials (step 1.1)  </li> <li>Re-launch setup \u2013 double click setup icon on desktop  </li> </ul> </li> <li> <p>input system logon password  </p> <ul> <li>Select <code>Yes, Continue</code> to configure services  </li> <li>Select <code>Yes, skip\u2026</code> to skip previously setup options  </li> <li>Select <code>Production mode</code> </li> <li>Select <code>New</code> </li> <li>Input first user account \u2013 don\u2019t use default &amp; remember for troubleshooting Note: input the password twice  </li> <li>Select <code>Best Practices</code> </li> <li>Select <code>Emerging Threats Open</code> </li> <li>Select <code>Snort</code> </li> <li>Select <code>Enable our sensors</code> </li> <li>Select <code>Ok</code> \u2013 accept default port configurations  </li> <li>Review monitoring interfaces \u2013 Select <code>Ok</code> once you have reviewed to make sure the management interface isn\u2019t selected  </li> <li>For HOME_net input each subnet that is considered to be on the local subnet   </li> <li>Enter subnet scope \u2013 for each subnet found in network use CIDR notation separated by comma to list out subnets, click <code>Ok</code> </li> <li>Select <code>Yes, store..</code> to store logs locally  </li> <li>Select <code>Ok</code> to accept default log size </li> <li>Select <code>Yes, proceed..</code> to finish configuration  </li> <li>Once complete, select <code>ok</code> six times   </li> </ul> </li> <li>Setup Security Onion firewall rules.  <ul> <li>Once previous task is completed, reopen TERM, refer to step 1.2  </li> <li>Allow analyst system/range to access SO \u2013 for each device/range Note: so-allow is the utility that will allow connections in the local firewall. This is used to allow analysts to connect, Wazzuh/Ossec agents to check in and forward logs, down-stream SO sensors to communicate, and more.  Be mindful of your scope as this is creating holes in the firewall and remember DAPE (Deny All Permit by Exception) <pre><code>sudo so-allow \n</code></pre></li> </ul> </li> </ul> <p> </p> <pre><code>a \n</code></pre> <ul> <li>Enter ip address or subnet range in CIDR notation  </li> <li>Allow communication with Elastic Search \u2013 for each device/range  <pre><code>sudo so-allow \n</code></pre></li> </ul> <p></p> <pre><code>e \n</code></pre> <ul> <li>Enter Subnet range in CIDR notation   <ul> <li>limit this to the subnets that the business workstations are on &amp; also the subnets with the analyst devices   </li> </ul> </li> <li>Add the syslog device for PAN logs  </li> </ul> <pre><code>sudo so-allow \n</code></pre> <p></p> <pre><code>l \n</code></pre> <ul> <li>Add Wazzuh/Ossec agents \u2013 typically workstation devices for each subnet  <pre><code>sudo so-allow  \n</code></pre></li> </ul> <p></p> <pre><code>o  \n</code></pre> <ul> <li>Enter the subnet where workstations are located  </li> <li>Register Wazzuh/Ossec agents \u2013 do this for each subnet inputted in previous step  </li> </ul> <pre><code>sudo so-allow  \n</code></pre> <p></p> <pre><code>r \n</code></pre> <ul> <li>Connecting to security onion from another box  <ul> <li>On cyber laptop \u2013 open web browser  </li> <li>Go to the ip of the security onion management interface step 1.6  </li> <li>If you cannot get to the website make sure laptop is in the subnet from step 2.5  </li> </ul> </li> </ul> <pre><code>sudo ufw status numbered {get number of rule} \n</code></pre> <pre><code>sudo ufw delete {rule to delete}  \n</code></pre> <ul> <li>From webpage click on Kibana  </li> <li>Use credentials created in step 1.15  </li> </ul>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#dependencies","title":"Dependencies","text":"<p>Security Onion  </p>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#references","title":"References","text":"<p>Security Onion Docs Security Onion Docs - Local Security Onion Walkthrough </p>"},{"location":"4.Eradication/4.09_Install_and_Deploy_Security_Onion/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/","title":"4.10-PAN Forward Syslog to SecurityOnion","text":""},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#task-configure-palo-alto-networking-device-to-forward-all-alerts-and-logs-to-syslog-server","title":"Task: Configure Palo Alto Networking Device to forward all Alerts and Logs to SysLog Server","text":""},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#conditions","title":"Conditions","text":"<p>Given a Palo Alto Networking device and Syslog server.  </p>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#standards","title":"Standards","text":"<ul> <li>Team member validates Palo Alto device is 'seeing' traffic as intended on target network segments.  </li> <li>Team member configures log forwarding to Security Onion device appropriately.  </li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#end-state","title":"End State","text":"<p>Logs are forwarded and parsed by Security Onion NIDS and searchable in Kibana.  </p>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#notes","title":"Notes","text":""},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#manual-steps","title":"Manual Steps","text":"<ul> <li>Log into Palo Alto Networking WebUI  <ul> <li>Username: Admin </li> <li>Password:  <li>Ensure PAN Service route for Syslog messages is set to same subnet as Syslog/SO/SIEM servers  <ul> <li>Open Service routes under Device &gt; Setup &gt; Services tab  </li> <li>Select [Service Route Configuration]  </li> <li>Change Service Route Configuration to [Customize]  <ul> <li>Either select All Services, or you can define which Interface the respective services use.  </li> </ul> </li> <li>Change the service route IP address to Custom  </li> <li>Click <code>Syslog</code> under Services  <ul> <li>Change <code>Source Interface</code> to ethernet interface connected to Syslog servers  </li> <li>Change <code>Source Address</code> to IP Address on same subnet of Syslog server  </li> </ul> </li> </ul> </li> <ul> <li>Create Syslog Server Profile.  This profile should identify the IP of the Syslog server on the network and Port the Syslog server will be listening on for incoming logs.  <ul> <li>Device &gt; Server Profiles &gt; Syslog  </li> <li>Select the <code>Add</code> button at the bottom  </li> <li>Create any name for the Syslog Profile  </li> <li>Click <code>Add</code> button under the newly created profile, and fill in:  <ul> <li>Name: Can be anything  </li> <li>Syslog Server: Can be IP or FQDN  </li> <li>Transport: UDP (Default) or TCP \u2013 Based on capabilities of network.   <ul> <li>Ensure Syslog Server has Firewall configured to accept Syslogs over UDP or TCP  </li> <li>UDP may result in loss of logs due to connectionless communication.   </li> <li>TCP may cause resource exhaustion of networking devices due to increased communication requirements.  </li> </ul> </li> <li>Port: 514 (Default)  <ul> <li>Ensure Syslog Server has firewall configured to accept Syslogs over port 514.  </li> </ul> </li> </ul> </li> </ul> </li> </ul> <ul> <li>Create a Security Profile to Log alerts on ALL network  traffic  <ul> <li>Objects &gt; Security Profiles  </li> <li>Create rules to Alert for each of the following:  <ul> <li>Antivirus  <ul> <li>Add a name for the rule  </li> <li>Change all Actions and Wildfire Actions to Alert  </li> </ul> </li> </ul> </li> </ul> </li> </ul> <ul> <li>Create a Security Profile - Continued <ul> <li>Anti-Spyware  <ul> <li>Add Profile Name  </li> <li>Click Action drop-down and select <code>Alert</code> </li> <li>Click <code>OK</code> </li> </ul> </li> </ul> </li> </ul> <ul> <li>Create a Security Profile - Continued  <ul> <li>Select <code>DNS Signature</code> Tab  </li> <li>Change <code>Action on DNS Queries</code> to Alert for both <code>Palo Alto Content DNS Signatures</code> and <code>Palo Alto Network DNS Security</code> </li> <li>Click <code>OK</code> </li> </ul> </li> </ul> <ul> <li>Create a Security Profile - Continued<ul> <li>Vulnerability Protection  <ul> <li>Add Profile Name  </li> <li>Click <code>Add,</code> to add Rule to Profile  </li> <li>Create Rule Name  </li> <li>Change <code>Action</code> to <code>Alert</code> Click <code>OK</code> </li> </ul> </li> </ul> </li> </ul> <ul> <li>Create a Security Profile - Continued  <ul> <li>URL Filtering  </li> <li>Add Profile Name  </li> <li>Select <code>Site Access</code> drop down -&gt; Set All Actions -&gt; Alert  </li> <li>Repeat STEP 2 for <code>User Credential Submission</code> </li> <li>Click <code>OK</code> </li> </ul> </li> </ul> <ul> <li>Create a Security Profile - Continued  <ul> <li>File Blocking  </li> <li>Click <code>Add,</code> to add Rule to Profile  </li> <li>Change <code>Action</code> to <code>Alert</code> </li> <li>Click <code>OK</code> </li> </ul> </li> </ul> <ul> <li>Create a Security Profile Group  <ul> <li>Objects &gt; Security Profile Group  </li> <li>click <code>add</code> </li> <li>Name the Security Profile  </li> <li>change each profile to the previously created rules for Alerting  </li> </ul> </li> </ul> <ul> <li>Create Log Forwarding Rule  <ul> <li>Objects &gt; Log Forwarding  </li> <li>Click <code>Add</code> </li> <li>Create Profile Name  </li> <li>Click <code>Add</code> under the Log Forwarding Profile  </li> </ul> </li> </ul> <ul> <li>Create Log Forwarding Rule - Continued  <ul> <li>Name the rule  </li> <li>Click <code>add</code> under the \"Syslog\" Forward Method  </li> <li>Select the Syslog Server Profile created previously  </li> </ul> </li> </ul> <ul> <li>Attach Logging and Log Forwarding policies to Active Security Policy  <ul> <li>Policies &gt; Security  </li> <li>Click on the active security profile name (which is in blue)  </li> <li>select <code>Actions</code> tab  </li> <li>Under Profile Setting set the:  <ul> <li>Profile Type to <code>Group</code> </li> <li>Group Profile to Security Group Profile created earlier  </li> </ul> </li> <li>Under Log Settings  <ul> <li>Select <code>Log at Session Start</code> and <code>Session End</code> Check-Box  </li> <li>Select Log Forwarding Profile previously created  </li> <li>Click <code>Ok</code> </li> </ul> </li> </ul> </li> </ul> <ul> <li>Configure Palo Alto Network Device to forward logs for System, Configuration , User-ID, HIP Match, and IP-Tag to Syslog Server  <ul> <li>Device &gt; Log Settings  </li> <li>for each: System, Configuration , User-ID, HIP Match, and IP-Tag  <ul> <li>Click <code>Add</code> and name the Log Profile  </li> <li>Under syslog click <code>Add</code> and select Syslog Server Profile.  </li> </ul> </li> </ul> </li> </ul> <p>Commit All Changes  </p> <p>Click Commit and add a Description of what you added  </p> <p>Confirm on Syslog Server that it is receiving logs  </p>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#dependencies","title":"Dependencies","text":"<ul> <li>Palo Alto Firewall and administrative credentials.  </li> <li>Security Onion NIDS to receive logs.  </li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#other-available-tools","title":"Other Available Tools","text":"<ul> <li>Wireshark with manual analysis.  </li> </ul>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#references","title":"References","text":"<p>PAN OS 90 Admin Guide PAN Article PAN Article </p>"},{"location":"4.Eradication/4.10_PAN_Forward_Syslog_SO/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/","title":"Task Monitor Account Creations","text":""},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#conditions","title":"Conditions","text":"<p>Given a Security Onion Server, a SO adamin account to query account creations, and an incident response workstation  </p>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#standards","title":"Standards","text":"<ul> <li>Team member queries the Security Onion Server to obtain the following minimum information:  <ul> <li>Account Name  </li> <li>Account Domain  </li> <li>Machine the account was created on(If the account was created locally)  </li> <li>SID of new account  </li> </ul> </li> <li>Team member outputs the account creation data to a comma-separate values (CSV) file and compares the entries to existing user accounts.  </li> <li>Team member checks information on account used to create new accounts against known IOCs or system owner activities to determine if accounts are legitimate.  </li> </ul>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#end-state","title":"End State","text":"<p>All new user or service account creation events are discovered  </p>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#notes","title":"Notes","text":"<p>Security Onion is able to detect local and domain account creations.  </p>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#manual-steps","title":"Manual Steps","text":"<p>Use the following Security Onion search query  </p> <p>winlog.event_id:\"4720\" | groupby event.module event.dataset  </p> <p>Alternative Steps: Using windows event log, query for event id 4720.   </p>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#running-script","title":"Running Script","text":""},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#other-available-tools","title":"Other available tools","text":"<p>PR.AC-1.7-Monitor_AD_New_Account_Creation will provide information about accounts created on the DC.</p>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#references","title":"References","text":"<p>EventID 4720 </p>"},{"location":"4.Eradication/4.11_Monitoring_account_creation_SO/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/","title":"Task Identify SMB using Security Onion","text":""},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#conditions","title":"Conditions","text":"<p>While using Security Onion alerts find SMB traffic  </p>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#standards","title":"Standards","text":"<ul> <li>Login into Security Onion. </li> <li>Select Alerts on the left panel  </li> <li>Ensure that Alerts are properly configured  <ul> <li>Set alerts as follows:  <ul> <li>Group: rule.name; Group: event.module; Group: event.severity_label  </li> </ul> </li> </ul> </li> <li>Set timeframe for your scan period (underlined area to the left of the refresh button)  <ul> <li>If the time is listed as calendar and hours, then click the calendar icon next to the date and select frequency (i.e. 1 day or last 6 hours etc. etc.)  </li> </ul> </li> <li>Click on column title <code>event.severity_label</code> to sort the alerts by severity (high to low).   </li> <li>Search for SMB alert (i.e. <code>ET POLICY SMB Executable File Transfer</code>)  </li> <li>Left click on the SMB alert and scroll down to Actions and click Hunt.  </li> <li>Click on the Hunt tab on the left side of the dashboard.  </li> <li>Ensure that the time frame is the same as the alert.  </li> <li>To the right of the search bar, delete everything in the quotations except <code>SMB</code>  Make sure that Group: event.module and Group: event.dataset is still active.  <ul> <li>If the two group sets are not active, click on the down arrow next to the search bar and click  </li> <li><code>| groupby event.module event.dataset</code> </li> </ul> </li> <li>Click on Hunt. The search criteria should look as such: <code>SMB</code> | groupby event.module event.dataset  </li> <li>Scroll down to Events and then to sort, click on categories <code>rule.name</code> and/or event.severity_label  </li> <li>You may see a result such as:  <ul> <li>ET TROJAN CobaltStrike SMB P2P Default Msagent Named Pipe Interaction, A Network Trohan was detected, high  </li> </ul> </li> </ul>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#end-state","title":"End State","text":"<ul> <li>Identify and monitor SMB file transfers  </li> </ul>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#manual-steps","title":"Manual Steps","text":"<p>NA  </p>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#running-script","title":"Running Script","text":"<p>NA  </p>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#dependencies","title":"Dependencies","text":"<ul> <li>Security Onion is running  </li> <li>Alerts on Security Onion is properly configured  </li> </ul>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#other-available-tools","title":"Other available tools","text":"<p>NA  </p>"},{"location":"4.Eradication/4.12_Detect_network_vulnerability_scans_SO/#references","title":"References","text":"<p>Security Onion Alerts Security Onion Hunt </p>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/","title":"4.13-Detect SMB using SecurityOnion","text":""},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#task-identify-smb-using-security-onion","title":"Task Identify SMB using Security Onion","text":""},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#conditions","title":"Conditions","text":"<p>While using Security Onion alerts find SMB traffic  </p>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#standards","title":"Standards","text":"<ul> <li>Login into Security Onion. </li> <li>Select Alerts on the left panel  </li> <li>Ensure that Alerts are properly configured  <ul> <li>Set alerts as follows:  <ul> <li>Group: rule.name; Group: event.module; Group: event.severity_label  </li> </ul> </li> </ul> </li> <li>Set timeframe for your scan period (underlined area to the left of the refresh button)  <ul> <li>If the time is listed as calendar and hours, then click the calendar icon next to the date and select frequency (i.e. 1 day or last 6 hours etc. etc.)  </li> </ul> </li> <li>Click on column title <code>event.severity_label</code> to sort the alerts by severity (high to low).  </li> <li>Search for SMB alert (i.e. <code>ET POLICY SMB Executable File Transfer.</code>)  </li> <li>Left click on the SMB alert and scroll down to Actions and click Hunt.  </li> <li>Click on the Hunt tab on the left side of the dashboard.  </li> <li>Ensure that the time frame is the same as the alert.  </li> <li>To the right of the search bar, delete everything in the quotations except <code>SMB.</code> Make sure that Group: event.module and Group: event.dataset is still active.  <ul> <li>If the two group sets are not active, click on the down arrow next to the search bar and click  </li> <li><code>| groupby event.module event.dataset</code> </li> </ul> </li> <li>Click on Hunt. The search criteria should look as such: <code>SMB</code> | groupby event.module event.dataset  </li> <li>Scroll down to Events and then to sort, click on categories <code>rule.name</code> and/or event.severity_label  </li> <li>You may see a result such as:  <ul> <li>ET TROJAN CobaltStrike SMB P2P Default Msagent Named Pipe Interaction, A Network Trohan was detected, high  </li> </ul> </li> </ul>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#end-state","title":"End State","text":"<ul> <li>Identify and monitor SMB file transfers  </li> </ul>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#manual-steps","title":"Manual Steps","text":"<p>NA  </p>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#running-script","title":"Running Script","text":"<p>N/A  </p>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#dependencies","title":"Dependencies","text":"<ul> <li>Security Onion is running</li> <li>Alerts on Security Onion is properly configured </li> </ul>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#other-available-tools","title":"Other available tools","text":"<p>NA  </p>"},{"location":"4.Eradication/4.13_Detect_SMB_using_SO/#references","title":"References","text":"<p>Security Onion Alerts Security Onion Hunt </p>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/","title":"Task Monitor DHCP Server for New Reservations","text":""},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#conditions","title":"Conditions","text":"<p>Given a Domain Controller (DC), a domain account with required permissions to query AD, and an incident response workstation  </p>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#standards","title":"Standards","text":"<ul> <li>Team member queries the DC to obtain the following minimum information:  <ul> <li>Name of user who created the new account  </li> <li>Security Identifier (SID) of the user who created the new account  </li> <li>Logon ID \u2013 provides semi-unique way to track user activity between reboots of computer  </li> <li>Name of new user account  </li> <li>SID of new account  </li> <li>Domain of new account (only if multiple domains exist)  </li> </ul> </li> <li>Team member outputs the account creation data to a comma-separate values (CSV) file and compares the entries to existing user accounts.  </li> <li>Team member checks information on account used to create new accounts against known IOCs or system owner activities to determine if accounts are legitimate.  </li> <li>Optional \u2013 Team member re-accomplished Task PR.AC-1.1 to obtain all user account attributes for comparison to existing accounts and verifying malicious activity  </li> </ul>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#end-state","title":"End State","text":"<p>All new user or service account creation events are discovered  </p>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#notes","title":"Notes","text":"<p>There are various ways to do this task but from an incident response perspective the best choice (when supported) is a PowerShell script that queries the DC event logs for account creation event IDs. Team SOP will drive output formats, file-naming and storage requirements of output files for this and similar tasks. Windows Event ID 4720 is used in Windows 2008+ and Windows 7+ for account creation Windows Event ID 624 is used in Windows 2003 and prior.  </p> <p>NB: Moved this BD from 'Protect' to the 'Detect' LOE per commander's guidance  </p>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#manual-steps","title":"Manual Steps","text":"<ul> <li> <p>Lists all users who have been created within the last 5 days and the actual date: <pre><code>$When = ((Get-Date).AddDays(-5)).Date\nGet-ADUser -Filter {whenCreated -ge $When} -Properties whenCreated\n</code></pre></p> </li> <li> <p>Using PowerShell, dump new Active Directory accounts in last 5 Days: <pre><code>import-module activedirectory\nGet-QADUser -CreatedAfter (Get-Date).AddDays(-5)\nGet-ADUser -Filter * -Properties whenCreated | Where-Object {$_.whenCreated -ge ((Get-Date).AddDays(-5)).Date}\n</code></pre></p> </li> <li> <p>Get log events of new account creation: <pre><code>Get-EventLog Security 4720 -after ((get-date).addDays(-1))\n</code></pre></p> </li> </ul> <p>4722, when a account was enabled 4726, when a account is deleted 4725, when a account is disabled  </p> <ul> <li> <p>Get SID of AD Group: <pre><code>Get-ADGroup -Identity \"some_group_name\"\n</code></pre></p> </li> <li> <p>Get Group name from SID: <pre><code>Get-ADGroup -Identity S-1-5-32-544\n</code></pre></p> </li> <li> <p>Get SID of a local user: <pre><code>wmic useraccount where name=\u2018some_username' get sid\n</code></pre></p> </li> <li> <p>Get SID for current logged in domain user: <pre><code>whoami /user\n</code></pre></p> </li> <li> <p>Get SID for the local administrator of the computer: <pre><code>wmic useraccount where (name='administrator' and domain='%computername%') get name,sid\n</code></pre></p> </li> <li> <p>Find username from a SID: <pre><code>wmic useraccount where sid='S-1-3-12-1234525106-3567804255-XYZAA-1111' get name\n</code></pre></p> </li> <li> <p>Get SID for the domain administrator: <pre><code>wmic useraccount where (name='administrator' and domain='%userdomain%') get name,sid\n</code></pre></p> </li> </ul>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#running-script","title":"Running Script","text":"<p>This script will be run at a command directed interval. <code>.\\AD_AccountCreationDetection.ps1</code> </p>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#other-available-tools","title":"Other available tools","text":"<p>BloodHound </p>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#references","title":"References","text":"<p>PowerShell Get Recently Created Users </p>"},{"location":"4.Eradication/4.14_Monitor_AD_New_Account_Creation/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/","title":"4.15-Monitor DHCP for New Reservations","text":""},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#task-monitor-dhcp-server-for-new-reservations","title":"Task Monitor DHCP Server for New Reservations","text":""},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#conditions","title":"Conditions","text":"<p>Given a Dynamic Host Configuration Protocol (DHCP) server, an administrator-level account, and an incident response workstation  </p>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#standards","title":"Standards","text":"<ul> <li>Team member determines if audit logging is enabled within the DHCP Management Console  </li> <li>Team member enables logging if it is not already enabled.  </li> <li>Team member connects to the DHCP server log and determines the presence of creation of new reservations  </li> <li>Team member exports applicable Windows events to an external file  </li> </ul>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#end-state","title":"End State","text":"<p>All new DHCP reservations are discovered and logged  </p>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#notes","title":"Notes","text":"<p>There are various ways to do this task but from an incident response perspective the best choice (when supported) is a PowerShell script that queries the DHCP event logs for reservation creation event IDs. The applicable log on Server 2008+ is Microsoft-Windows-DHCP Server Events/Operational in c:\\windows\\system32\\winevt\\logs. The applicable Event ID is 106. (csv files can be parsed with powershell via the Get-Content Commandlet). Team SOP will drive output formats, file-naming and storage requirements of output files for this and similar tasks. Windows 2012 Server and higher support PowerShell DHCP commands that may also leave log traces in the PowerShell logs.  </p>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#manual-steps","title":"Manual Steps","text":"<p>Example Commands:  </p> <ul> <li> <p>Windows</p> <ul> <li>Enable DHCP server logging: <pre><code>reg add HKLM\\System\\CurrentControlSet\\Services\\DhcpServer\\Parameters /v ActivityLogFlag /t REG_DWORD /d 1\n</code></pre></li> </ul> </li> <li> <p>Default Location Windows 2003/2008/2012: <code>%windir%\\System32\\Dhcp</code> </p> </li> <li> <p>Linux</p> </li> <li> <p>View DHCP lease logs: Ubuntu: <pre><code>grep -Ei 'dhcp' /var/log/syslog.1\n</code></pre></p> </li> <li> <p>View DHCP logs <pre><code>tail -f dhcpd.log\n</code></pre></p> </li> </ul>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#running-script","title":"Running Script","text":"<ul> <li>Example Script <pre><code># Gather dhcp lease information  \n# Change the scope range to your specific scope range  \nnetsh dhcp server scope &lt;IP ADDRESS&gt; show clients 1 &gt; C:\\Monitor\\New_dhcp_list.txt\n\n# remove top 8 lines  \n$file = cat C:\\Monitor\\New_dhcp_list.txt | select -skip 8\n\n#remove bottom 4 lines\n$len = $file.length-4\n$file = $file[0..($len)]\n\n#loop through each line in the file and grab the relevant columns\n$file | foreach-object{$_.split()[0,4,7,18] -join ' '} &gt; C:\\Monitor\\New_dhcp_list.txt\n\n#add white space and title\necho \" \" &gt;&gt; .\\Domain_Changes_Log.txt\necho \" \" &gt;&gt; .\\Domain_Changes_Log.txt echo \"DHCP Checked\" &gt;&gt; .\\Domain_Changes_Log.txt\n\n#add date time stamp\nget-date &gt;&gt; .\\Domain_Changes_Log.txt\n\n#compare known good to new list then add new dhcp leases to the log file\nCompare-Object $(Get-Content .\\Known_good_dhcp_list.txt) $(Get-Content .\\new_dhcp_list.txt) &gt;&gt; .\\Domain_Changes_Log.txt\nif ((Compare-Object $(Get-Content .\\Known_good_dhcp_list.txt) $(GetContent .\\New_dhcp_list.txt)) -ne $null)\n        {\n                [System.Reflection.Assembly]::LoadWithPartialName(\"System.Windows. Forms\") $oReturn=[system.windows.forms.messagebox]::show(\"DHCP Client has been added! This change needs to be verified and the master list updated.\")\n        }\n</code></pre></li> </ul>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#other-available-tools","title":"Other available tools","text":""},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#references","title":"References","text":"<p>DHCP Diagnostics DHCP Operational Events Get-Content Commandlet (usefull parsing csv files) </p>"},{"location":"4.Eradication/4.15_Monitor_DHCP_for_new_reservations/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/","title":"4.16-Monitor Active Directory for New DNS Names","text":""},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#task-monitor-active-directory-ad-for-new-domain-name-system-dns-names","title":"Task Monitor Active Directory (AD) for new Domain Name System (DNS) Names","text":""},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#conditions","title":"Conditions","text":"<p>Given a Domain Controller (DC), a domain account with required permissions, and a workstation with Remote Server Administration Tools (RSAT)  </p>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#standards","title":"Standards","text":"<ul> <li>Team member opens the DNS Console on the workstation and navigates to the Forward Lookup zone  </li> <li>Team member exports the list of records in the zone to a local file  </li> <li>Team member repeats this task periodically and compares the output files for new entries  </li> </ul> <p>OR  </p> <ul> <li>Team member chooses a command line tool and writes or chooses an existing script that will export the contents of a DNS zone to a local file  </li> <li>Team member repeats the task periodically and compares the output files for new entries  </li> </ul>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#end-state","title":"End State","text":"<p>All new DNS zone records are found and recorded  </p>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#notes","title":"Notes","text":"<p>This task is repetitive in nature and the use of a script to generate new files each time it is accomplished should be used. Comparison of the output files can be done manually or with a file diff\u2019ing tool such as Kdiff; however, this process can also be automated in the same PowerShell script that pulls the zone record information.  </p>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#running-script","title":"Running Script","text":"<ul> <li> <p>Example PowerShell Script:  </p> <ul> <li>All DNS Records <pre><code>get-wmiobject -Namespace root\\MicrosoftDNS -class microsoftdns_resourcerecord | select __Class, ContainerName, DomainName, RecordData, ownername | out-gridview\n</code></pre></li> </ul> </li> <li> <p>RootHints <pre><code>get-wmiobject -Namespace root\\MicrosoftDNS -class microsoftdns_resourcerecord | where{$_.domainname -eq \"..roothints\"} | out-gridview -Zones Get-WmiObject -namespace \"root\\MicrosoftDNS\" -class MicrosoftDNS_Zone | select Name\n</code></pre></p> </li> </ul>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#other-available-tools","title":"Other available tools","text":""},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#references","title":"References","text":"<p>Dnscmd tool reference Scripting with PowerShell PowerShell DNS </p>"},{"location":"4.Eradication/4.16_Monitor_AD_for_new_DNS_names/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/","title":"4.17-Respond to Alerts about unauthorized users","text":""},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#task-respond-to-alerts-about-unauthorized-users-or-unsuccessful-logins","title":"Task Respond to alerts about unauthorized users or unsuccessful logins","text":""},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#conditions","title":"Conditions","text":"<ul> <li>Proper controls and security practices applied to Active Directory or other directory platform.  </li> <li>Effective use of log management and SIEM.  </li> <li>Working in concert with Team Leader\u2019s priorities and interactions with mission partner.  </li> </ul>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#standards","title":"Standards","text":"<ul> <li>Ensure Active Directory logs are integrated into log management tool and test SIEM alerting.  </li> <li>Responding party should have knowledge of environment and understand the incident response process.  </li> <li>Incident response process should detail the escalation criteria, remediation plan, and have the ability to investigate the matter or collect evidence.  </li> <li>Abnormal activity should be logged and remediated until it meets the organizations acceptable risk tolerance level.  </li> <li>If needed user accounts should be suspended, terminated, or subject to advanced logging if nefarious activity is identified.  </li> </ul>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#end-state","title":"End State","text":"<p>User alerts are identified and responded to utilizing the proper incident response procedure.  </p>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#notes","title":"Notes","text":""},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#manual-steps","title":"Manual Steps","text":"<ul> <li>Login to the SIEM interface, e.g. Kibana  </li> <li>Select Dashboard on the left hand side  </li> <li>Scroll down the left hand side and select Sysmon under Host Hunting  </li> <li>Ensure Active Directory logs are populting  </li> </ul>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#dependencies","title":"Dependencies","text":"<ul> <li>Sysmon  </li> <li>Wazuh  </li> <li>Wazuh configuration file (ossec.conf)  </li> <li>Security Onion  </li> <li>Elasticsearch  </li> </ul>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#references","title":"References","text":"<p>Microsoft Unauthorized User Microsoft Login Failed </p>"},{"location":"4.Eradication/4.17_Respond_to_alerts_about_unauthorized_users/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/","title":"4.18-Compare Hashes of suspected malware","text":""},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#task-perform-hash-analysis-and-signature-check-of-suspected-malware","title":"Task Perform Hash Analysis and Signature check of Suspected Malware","text":""},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#conditions","title":"Conditions","text":"<p>Given a suspected malware file or files, file hashing tools, and a database or repository of known malware file hashes.  </p>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#standards","title":"Standards","text":"<ul> <li>The team member obtains a hash (MD5 or SHA1) of the suspected malware files and saves them to a text file.  </li> <li>Hashes can be obtained at the command line using one of the tools referenced below.  </li> <li>Hashes can be obtained and verified automatically on VirusTotal using Windows GUI tools.  </li> <li>The team member compares the hash value to previously known malware samples from the incident Indicators of Compromise (IOC).  </li> <li>The team member utilizes the VirusTotal website\u2019s hash search functionality to determine if any previous samples of this malware have been reported.  </li> <li>The team member utilizes a signature-checking utility to determine if the suspected malware is signed with a code-signing certificate.  </li> </ul>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#end-state","title":"End State","text":"<p>All file hashes of suspected malware files have been checked against a trusted file hash repository.  </p>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#notes","title":"Notes","text":"<p>Caution should be observed when utilizing VirusTotal to determine if a suspected malware sample has already been identified. Checking the hash of the file does not enter any information into the VirusTotal database. Uploading of the actual malware sample does create a searchable entry in the VirusTotal database and can be monitored by malicious actors to determine if their actions have been detected. * Tools: There are various free Windows and Linux tools that can be used to complete this task. For example:   * Md5sum / Sha1sum \u2013 Linux   * Md5deep / Hasheep   * Sigcheck.exe \u2013 Sysinternals (Windows)   * Hfind \u2013 Linux   * Signtool.exe \u2013 Part of Microsoft SDK## Manual Steps  </p>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#running-script","title":"Running Script","text":""},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#gather-hash-of-files","title":"Gather Hash of Files","text":"<ul> <li> <p>MacOS <pre><code>openssl [algorithm] [file]  \n\n#Example:  \nopenssl md5 READMME.md  \nMD5(README.md)=f524eb99090ff80aa7cb1ddee223531e\n\nopenssl sha1 README.md  \nSHA1(README.md)=71d926baef99eea2af534ba7bcdf5871d2da9f88\n</code></pre></p> </li> <li> <p>Linux <pre><code>md5 filename\nsha1sum filename\n</code></pre></p> </li> <li> <p>Windows  </p> </li> <li> <p>CertUtil is a Windows built-in command line installed as part of certificate services, but it also offers a switch -hashfile that allows you to generate the hash string using a specified algorithm. For example, running the following command generates an SHA-512 checksum for an executable file called lsr.exe. <pre><code>certutil -hashfile c:\\&lt;path to file&gt; SHA512\n</code></pre></p> <ul> <li>Use PowerShell to retrieve hash of file <pre><code>Get-FileHash -Path c:\\&lt;path to file&gt; -Algorithm SHA512\n</code></pre></li> </ul> </li> <li> <p>Submitting hashes to Virustotal using Sysinternals  </p> <ul> <li> <p>procex.exe  </p> <ul> <li>run ProcEx.exe</li> <li>Right-Click Columns tab and click <code>Select Columns</code>.  </li> <li>Check <code>Virus Total</code> box under <code>Process Image</code> tab.    </li> <li>Agree to VirustTotal's Terms of Service to submit process hashes for evaluation.  </li> </ul> </li> <li> <p>SigCheck.exe  </p> <ul> <li>Open cmd.exe and navigate to directory of sigcheck.exe if not added to global variables  </li> <li> <p>When you use option -v, the hash of the file will be submitted to VirusTotal. The first time you run it, you'll have to accept VirusTotal's terms (or use option -vt to accept and avoid the prompt).  You can scan a complete disk with option -s and specifying the root folder of the disk (e.g. c:), and you can produce a CSV report with option -c. <code>bat     sigcheck.exe -vt [File]</code> </p> </li> <li> <p>Files without digital signature are also checked with VirusTotal. <pre><code>sigcheck.exe -v -c c:/  \n</code></pre></p> </li> </ul> </li> </ul> </li> </ul>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#other-available-tools","title":"Other available tools","text":"<p>Visual Studio </p>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#references","title":"References","text":"<p>Searcing VirusTotal for hashes SingTool.exe using Sysinternals Process Explorer to check file hashes on VirusTotal using sigcheck to check file hash values on VirusTotal Using MD5DEEP Using MD5SUM </p>"},{"location":"4.Eradication/4.18_Compare_hashes_of_suspected_malware/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/","title":"4.19-Perform Manual Host Analysis","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/#tasks-perform-manual-host-analysis","title":"Tasks Perform Manual Host Analysis","text":"<p>4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows 4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File 4.19.3_Create_Hard_Disk_Image </p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/","title":"4.19.1-Perform Manual Host Analysis Live Physical Host Windows","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#task-perform-manual-host-analysis-live-physical-host-windows","title":"Task Perform Manual Host Analysis \u2013 Live Physical Host - Windows","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#conditions","title":"Conditions","text":"<p>Given a suspected compromised system, local administrator account credentials, analysis tools, and one or more Indicators of Compromise (IOC).  </p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#standards","title":"Standards","text":"<ul> <li>The team member inserts a USB device containing the memory analysis tools to the suspected compromised computer.  </li> <li>The team member loads the analysis software from the USB drive and initiates a scan of the computer\u2019s live memory outputting the results to the USB drive.  </li> <li>The team member analyzes the output of the tool and validates the presence of provided IOCs.  </li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#end-state","title":"End State","text":"<p>Processes, files, registry entries and other artifacts are identified that match one or more IOCs  </p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#notes","title":"Notes","text":"<p>If the IOCs from the incident indicate possible infection passing to any external USB data device plugged into the target system, the tools output results should be sent over the network to a secure share folder.  </p> <ul> <li>Tools:</li> <li>Redline \u2013 Mandiant tool that can analyze the live memory of a compromised computer from from an external USB drive. This required that Mandiant Redline be installed on a team member computer which can then copy the required files to an external USB.  </li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#running-script","title":"Running Script","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#other-available-tools","title":"Other available tools","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#references","title":"References","text":"<p>FireEye Redline </p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.1_Perform_Manual_Host_Analysis_Live_Physical_Host_Windows/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/","title":"4.19.2-Perform Manual Host Analysis Memory Image File","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#task-perform-manual-host-analysis-memory-image-file","title":"Task Perform Manual Host Analysis \u2013 Memory Image File","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#conditions","title":"Conditions","text":"<p>Given a memory image from a suspected compromised system, memory analysis tools, and one or more Indicators of Compromise (IOC).  </p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#standards","title":"Standards","text":"<ul> <li>The team member copies the memory image to the incident response workstation.  </li> <li>The team member performs a file hash of the memory image and validates it against the hash obtained when the image was captured.  </li> <li>Utilizing a memory image analysis tool, obtain or check for the following information and compare against known IOCs (not a comprehensive list)  </li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#end-state","title":"End State","text":"<p>Processes, files, network connections and/or command history that match one or more IOCs are identified.  </p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#notes","title":"Notes","text":"<p>Memory analysis can be done on a live system or with an image file of the suspect computers physical memory. Some tools can do both capture and analysis and can be used for this task. The information sought in this task is representative of that which an incident responder might do to further the creation of IOCs and the understanding of the compromise. Deeper inspection and analysis of the memory image is likely to be done by the forensics team.  </p> <ul> <li>Tools: There are various several tools that can be used to analyze a memory image. For example:  </li> <li>Volatility \u2013 used to analyze memory image files. Required python to be installed on responder\u2019s computer.  </li> <li>Memoryze \u2013 Mandiant tool that can analyze memory files on a responder\u2019s computer or the live memory of a compromised computer from running from an external USB drive.  </li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#manual-steps","title":"Manual Steps","text":"<p>The command for Volatility is as follows:  </p> <ul> <li> <p>Windows <pre><code>volatility -f &lt;memory dump location&gt; --profile=&lt;machine profile&gt; &lt;command&gt; &gt; &lt;chosen output location.txt&gt;\n</code></pre></p> </li> <li> <p>Linux (using python) <pre><code>python vol.py -f &lt;memory dump location&gt; --profile&lt;machine profile&gt; &lt;command&gt; &gt; &lt;chosen output location&gt;\n</code></pre></p> </li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#running-script","title":"Running Script","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#other-available-tools","title":"Other available tools","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#references","title":"References","text":"<p>Stuxnet Trojan Memory Forensics Volatility Command Reference </p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.2_Perform_Manual_Host_Analysis_Memory_Image_File/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/","title":"4.19.3-Create Hard Disk Image","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#task-create-hard-disk-image","title":"Task Create Hard Disk Image","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#conditions","title":"Conditions","text":"<p>Given a Windows or Linux machine, hard drive acquisition tools, and a network device with one or more indicators of compromise (IOC).  </p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#standards","title":"Standards","text":"<p>The team member connects to and creates an image from a remote machine using Linux or Windows. (the team member can choose how to create the image from the given tools so long as he/she can provide a log file with a good hash that can be verified against the created image.)  </p> <ul> <li> <p>Windows <pre><code>dc3dd.exe if=\\\\.\\c: of=d:\\&lt;ATTACHED OR TARGET DRIVE&gt;\\&lt;IMAGE NAME&gt;.dd hash=md5 log=d:\\&lt;MOUNTED LOCATION&gt;\\&lt;LOG NAME&gt;.log\n</code></pre></p> </li> <li> <p>Linux <pre><code>dd if=/dev/&lt;INPUT DEVICE&gt; | SSH &lt;USER NAME&gt;@&lt;DESTINATION IP ADDRESS&gt; \"DD OF=&lt;DESTINATION PATH&gt;\"\n</code></pre></p> </li> <li> <p>The team member then verifies that a log file with a hash was created by checking the chosen log file directory.  </p> </li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#end-state","title":"End State","text":"<p>A raw physical image of a remote machine is created and ready for analysis.  </p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#notes","title":"Notes","text":"<p>Imaging can be done on a live or dead system using a myriad of tools. Software and hardware tools can be used and are chosen based on available equipment and time constraints. The key portion of this task is the creation of a log file with a good hash to allow for integrity checks and chain of custody. Some tools will perform a hash verification check, and when these tools are used, this should be done if time allows.  </p> <ul> <li>Tools  </li> <li>Dc3dd.exe used to create images from linux or windows devices. Dc3dd will create a log and hash if the correct command is given.  </li> <li>dd \u2013 linux command that will create an image from a physical device. dd will create a log and hash if the correct command is given  </li> <li>ftk imager \u2013 windows program for imaging devices. Ftk imager is a GUI interface that allows for a myriad of options for evidence file formats including E01, dd, raw, etc.  </li> <li>Guymager \u2013 Guymager is a linux tool that can be used to create disk images. Guymager is an extremely fast option for imaging and is pre-installed in many linux flavors.  </li> </ul>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#running-script","title":"Running Script","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#other-available-tools","title":"Other available tools","text":""},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#references","title":"References","text":"<p>Sourceforge DC3DD FTX Imager Guymager forensic image </p>"},{"location":"4.Eradication/4.19_Perform_manual_host_analysis/4.19.3_Create_Hard_Disk_Image/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/","title":"4.20-Investigate Alerts from Host Sensors","text":""},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#task-investigate-alerts-from-host-sensors","title":"Task Investigate Alerts from Host Sensors","text":""},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#conditions","title":"Conditions","text":"<ul> <li>Given a network with HIDS agents installed on all relevant hosts.  </li> <li>Given a fully installed and properly configured SIEM that displays information reported by HIDS agents.  </li> <li>Given accounts for all relevant tools and hosts.  </li> <li>Given a notification of a host based sensor alert  </li> <li>Given prior approval from network owner to begin host based investigation  </li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#standards-network-analyst","title":"Standards- Network Analyst","text":"<ul> <li>Recognize alert related to host sensor data, if possible, rule out as false positive  </li> <li>Analyze other relevant SIEM data gathered from host ie. network connections to other hosts, suspicious traffic, etc.  </li> <li>Notify team leader and hand off report to host analyst team  </li> <li>Continue monitoring and report additional relevant data as it becomes available  </li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#standards-host-analyst","title":"Standards- Host Analyst","text":"<ul> <li>Determine Operating System, Windows, Linux, MacOS, etc.  </li> <li>Log onto system with authorized administrative credentials  </li> <li>Utilize native OS tools to confirm alert data, ie. network connections, open ports, active/startup processes, etc. (Windows- 'NetStat' 'TaskManager' 'arp'; Linux- 'ps -aux' 'top' 'htop' 'netstat' 'arp'; MacOS- 'top' 'ps' 'activity monitor' 'network utility')  </li> <li>If available, utilize third party tools to discover parent or child processes associated with alert. (Windows- SysInternals, 'ProcMon' 'ProcessExplorer') 'TCPview'; Linux-  </li> <li>Determine any potentially compromised account information: (Windows- powershell 'get-localuser, get-aduser'; Linux- 'cat /etc/passwd'; MacOS- 'cat /etc/passwd')  </li> <li>Determine source of IOC and any potential lateral movement conducted post compromise using (Windows- EventViewer)  </li> <li>Gather sufficient data to send a detailed report of the IOC  </li> <li>Send detailed report of IOC via specified channel to team lead or designated person  </li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#end-state","title":"End State","text":"<p>Host-based alert reporting is actioned and fully investigated  </p>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#notes","title":"Notes","text":""},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#manual-steps","title":"Manual Steps","text":"<ul> <li>Login to the SIEM interface, e.g. Kibana  </li> <li>Defenders should be able to see the reporting status of all hosts with agents. The most obvious and immediate problem a host might report is that it isn't reporting anymore.  </li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#running-script","title":"Running Script","text":"<ul> <li><code>4.Eradication/4.08_Deploy_or_evaluate_host_sensors/scripts/Sysmon_Wazuh_push.ps1</code> </li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#dependencies","title":"Dependencies","text":"<ul> <li>Sysmon  </li> <li>Wazuh  </li> <li>Wazuh configuration file (ossec.conf)  </li> <li>Security Onion  </li> <li>Elasticsearch  </li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#other-available-tools","title":"Other available tools","text":"<ul> <li>Splunk  </li> </ul>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#references","title":"References","text":"<p>Security Onion documentation Elasticsearch documentation </p>"},{"location":"4.Eradication/4.20_Investigate_Alerts_From_Host_Sensors/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/","title":"4.21-Find and Contain Rogue Workstation","text":""},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#task-find-and-contain-rogue-workstations","title":"Task Find and contain rogue workstations","text":""},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#conditions","title":"Conditions","text":"<p>Given a suspected compromised system, local administrator account credentials, analysis tools, and one or more Indicators of Compromise (IOC).  </p>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#standards","title":"Standards","text":"<ul> <li>Rogue access indicators of compromise are identified or alerted.  </li> <li>The team member analyzes network to identify any rogue workstations.  </li> <li>The rogue workstation(s) are contained.  </li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#end-state","title":"End State","text":"<p>Rogue workstations are identified and contained.  </p>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#notes","title":"Notes","text":""},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#manual-steps","title":"Manual Steps","text":"<p>Detect - Indicators of Compromise  </p> <ul> <li>Rogue/Unauthorized Access Points  </li> <li>Internal rogue devices such as a user brings in an unauthorized access point that serves as a gateway to the internal network.  </li> <li>External rogue access points used by an attacker spoofing the legitimate users. The attacker may steal authentication attributes to gain access to the internal network.  </li> <li>Detection: Review of any new access points to be compared to a known authorized list. Run Active Directory Script (Below). Review any new workstations detected on the domain. Compare to authorized workstation list.  </li> <li>Containment: Block/Remove any unauthorized access points. Disable/Remove device from network/domain.  </li> <li>Rogue Workstations  </li> <li>Deploy/Hunt to perform quick logical Rogue Workstation validation/enumeration  </li> <li>Ping, trace route and NMAP Rogue Host (within same subnet if possible)  </li> <li>Nessus scan if required/authorized  </li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#running-script","title":"Running Script","text":"<p>Nmap Commands  </p> <ul> <li> <p>list scan <pre><code>nmap -sL &lt;IP Address/Subnet&gt;\n</code></pre></p> </li> <li> <p>Ping scan <pre><code>nmap -sn &lt;IP Address/Subnet&gt;\n</code></pre></p> </li> <li> <p>Ping scan, no ports <pre><code>nmap -sn &lt;IP Address/Subnet&gt;\n</code></pre></p> </li> <li> <p>ARP scan <pre><code>nmap -PR &lt;IP Address/Subnet&gt;\n</code></pre></p> </li> <li> <p>No ping scan <pre><code>nmap -Pn &lt;IP Address/Subnet&gt;\n</code></pre></p> </li> <li> <p>Nessus  </p> </li> </ul> <p>Follow Host Discovery process/procedures using the most current version of Nessus.</p> <p>Containment  </p> <ul> <li>Switch Port  </li> <li>Turn off switch port to rogue host  </li> <li>Dispatch Security to investigate  </li> <li>Access Layer Switch ACL  </li> <li>Apply Switch ACLs to drop all traffic from host  </li> <li>Dispatch Security to investigate  </li> <li>Boundary Firewall / GPO  </li> <li>Apply ACLs to drop all traffic at nearest firewall  </li> <li>Apply GPO firewall rule on all hosts in OU to drop all traffic from host  </li> <li>Dispatch Security to investigate  </li> <li>Add MAC to DHCP deny list (DHCP Manager -&gt; IPv4 -&gt; Filters \u2013&gt; Deny)  </li> </ul>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#other-available-tools","title":"Other available tools","text":""},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#references","title":"References","text":"<p>NMAP Discovery Wireless Preventing Rogue devices </p>"},{"location":"4.Eradication/4.21_Find_and_contain_rogue_workstations/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/","title":"4.22-Block Unauthorized Software","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#task","title":"Task","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#conditions","title":"Conditions","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#standards","title":"Standards","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#end-state","title":"End State","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#notes","title":"Notes","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#running-script","title":"Running Script","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#other-available-tools","title":"Other available tools","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#references","title":"References","text":""},{"location":"4.Eradication/4.22_Block_unauthorized_software/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/","title":"4.23-Stop Credential Reuse Attack","text":""},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#task-stop-credential-re-use-attack","title":"Task Stop Credential Re-use Attack","text":""},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#conditions","title":"Conditions","text":"<ul> <li>Compromised credentials. Can be any authentication credentials that provides access to internal network, hardware, software.  </li> <li>Insider and external threats.  </li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#standards","title":"Standards","text":"<ul> <li>Identified/alerted on compromised credentials.  </li> <li>Identify what the compromised credentials has access to.  </li> <li>Alert appropriate personnel/groups of compromised credentials.  </li> <li>Disable Account a. Active Directory / User account Management Application b. Shared accounts / administrator accounts (domain, server, workstation, local) c. Known servers and databases that are not linked to Active Directory d. Known applications that are LDAP and non-LDAP authenticated e. Email Exchange account and credentials. f. Mobile / MDM g. Physical Access: keyfobs, access cards h. Externally facing websites i. Inactive / Infrequently used accounts j. Emergency or temporary accounts k. PLCs/SCADA l. Misc devices: tablets.  </li> <li>Degrade host(s) access via host port a. Active layer switch ACL b. Boundary Firewall GPO c. Remote/VPN Disable d. Remote wipe, if lost device (if available)  </li> <li>Alerting a. If possible, monitor and alert for attempted future attempts with compromised credentials.  </li> </ul>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#end-state","title":"End State","text":"<p>Compromised credentials are disabled and/or changed in all areas. Appropriate hosts are restricted or disabled. Attacker cannot re-use credentials to access any internal network area, hosts, hardware, or software.  </p>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#notes","title":"Notes","text":"<p>There may be other areas to disable accounts, dependent on the network environment.  </p>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#running-script","title":"Running Script","text":""},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#other-available-tools","title":"Other available tools","text":""},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#references","title":"References","text":"<p>NIST 800-53 Credential Controls </p>"},{"location":"4.Eradication/4.23_Stop_Credential_reuse_attack/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/","title":"4.24-Stop Brute Force Attack","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#task","title":"Task","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#conditions","title":"Conditions","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#standards","title":"Standards","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#end-state","title":"End State","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#notes","title":"Notes","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#running-script","title":"Running Script","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#other-available-tools","title":"Other available tools","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#references","title":"References","text":""},{"location":"4.Eradication/4.24_Stop_brute_force_attack/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.25_Stop_malware_rootkit/","title":"4.25-Stop Malware Rootkit","text":""},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#task-stop-malware-rootkit","title":"Task Stop Malware Rootkit","text":""},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#conditions","title":"Conditions","text":"<p>Given a compromised system, perform steps to stop malware rootkit.  </p>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#standards","title":"Standards","text":"<ul> <li>Disable Account</li> <li>Domain Account -&gt; Users and Computers -&gt; Disable  </li> <li>Local Account -&gt; Create GPO -&gt; Security Settings -&gt; Local Policies -&gt; Security Options -&gt; Accounts: Administrator account status  <li>Hobble Host  </li> <li>Identify the MAC address based on the IP address of the rogue station.  </li> <li>Trace to the port  </li> <li>No up interface   </li> <li>Physically power off the machine.  </li>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#end-state","title":"End State","text":"<p>System account has been disabled, Administrator account has been disabled, investigation and rebuild procedures completed and system is physically powered off.  </p>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#notes","title":"Notes","text":""},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#manual-steps","title":"Manual Steps","text":""},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#running-script","title":"Running Script","text":""},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#other-available-tools","title":"Other available tools","text":""},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#references","title":"References","text":"<p>Remove RootKit </p>"},{"location":"4.Eradication/4.25_Stop_malware_rootkit/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.26_Stop_data_exfiltration/","title":"4.26-Stop Data Exfiltration","text":""},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#task-stop-data-exfiltration","title":"Task Stop data exfiltration","text":""},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#conditions","title":"Conditions","text":"<ul> <li>Given a network with sensitive data  </li> <li>Harden host nodes against data exfiltration  </li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#standards","title":"Standards","text":""},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#end-state","title":"End State","text":"<p>Prevention or mitigation on the exfiltration of information from a network is accomplished when the following conditions are met:  </p> <ul> <li>Prevention of information from being transfered/burned to CD/DVD.  </li> <li>Prevention of information from being transfered to Removable or Additional Storage drives.  </li> <li>Education on Social Engineering and Phishing Attacks that lead to data exfiltration.  </li> <li>Minimize size of data allowed to be e-mailed.  </li> <li>Minimize size of data allowed to be sent out of the network.  </li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#notes","title":"Notes","text":"<p>The methods described in this document help prevent data exfiltration on a host machine by a user. There are other methods that are network-centric but turns complicated quickly. Some considerations for a network-centric implementation include: FTP ports, SFTP ports, SCP ports, Email attachments, access to cloud storage, etc\u2026 This can become quite the rabbit hole and requires deep understanding and strong requirements gathering before implementation.  </p>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#manual-steps","title":"Manual Steps","text":"<ul> <li>Disable USB ports  <ul> <li>In the Windows environment, there are two places to prevent the use of USB ports  </li> <li>Disable the installation of USB storage devices on the computer  <ul> <li>Start Windows Explorer, and then locate the %SystemRoot%\\Inf folder.  </li> <li>Right-click the Usbstor.pnf file, and then click Properties.  </li> <li>Click the Security tab.  </li> <li>In the Group or user names list, add the user or group that you want to set Deny permissions for.  </li> <li>In the Permissions for UserName or GroupName list, click to select the Deny check box next to Full Control. Note * Also add the System account to the Deny list.  </li> <li>In the Group or user names list, select the SYSTEM account.  </li> <li>In the Permissions for UserName or GroupName list, click to select the Deny check box next to Full Control, and then click OK.  </li> <li>Right-click the Usbstor.inf file, and then click Properties. ix. Click the Security tab.  </li> <li>In the Group or user names list, add the user or group that you want to set Deny permissions for.  </li> <li>In the Permissions for UserName or GroupName list, click to select the Deny check box next to Full Control.  </li> <li>In the Group or user names list, select the SYSTEM account.  </li> <li>In the Permissions for UserName or GroupName list, click to select the Deny check box next to Full Control, and then click OK.  </li> </ul> </li> <li>Disable the use of USB devices through the registry  <ul> <li>Click Start, and then click Run.  </li> <li>In the Open box, type regedit, and then click OK.  </li> <li>Locate and then click the following registry key: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\UsbStor  </li> <li>In the details pane, double-click Start.  </li> <li>In the Value data box, type 4, click Hexadecimal (if it is not already selected), and then click OK.  </li> <li>Exit Registry Editor.  </li> </ul> </li> </ul> </li> <li>Disable CD/DVD drive burning  <ul> <li>In the Windows environment, there are two places to prevent the use of CD/DVD devices for burning  </li> <li>Implement a Group Policy   <ul> <li>Open the \u201call users\u201d, \u201cspecific users or groups\u201d, or \u201call users except administrators\u201d Local Group Policy Editor for how you want this policy applied.  </li> <li>In the left pane navigate through the tree to: User Configuration &gt; Administrative Templates &gt; Windows Components &gt; Windows Explorer (Windows 7) or File Explorer (Windows 8 and newer)   </li> <li>In the right pane, double click/tap on Remove CD Burning features to edit it  </li> <li>Select the dot to enable this feature  </li> <li>Click OK  </li> <li>Close the Local Group Policy Editor  </li> </ul> </li> <li>Disable through Registry  <ul> <li>Open Regedit  </li> <li>Navigate to HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer  </li> <li>Modify/create the dword \u201cNoCDBurning\u201d and set it to 00000001  </li> <li>Exit Regedit  </li> </ul> </li> </ul> </li> <li>Employee training  <ul> <li>Develop a training that covers the following  <ul> <li>How to identify sensitive material  </li> <li>Define the risk of releasing sensitive material  </li> <li>Describe known sensitive material  </li> </ul> </li> <li>Distribute the training material  </li> </ul> </li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#running-script","title":"Running Script","text":"<p>The following scripts disable the functionality of USB ports for data exfiltration on user machines:  </p> <ul> <li> <p>WINDOWS 10 - PowerShell: <pre><code>Set-ItemProperty -Path \"HKLM:\\SYSTEM\\CurrentControlSet\\Services\\USBSTOR\\\" -Name \"start\" -Value 4\n</code></pre></p> </li> <li> <p>MAC OS X - Terminal:  </p> <ul> <li> <p>Disable: <pre><code>sudo kextunload /System/Library/Extensions/IOUSBMassStorageClass.kext\n</code></pre></p> </li> <li> <p>Enable: <pre><code>sudo kextload /System/Library/Extensions/IOUSBMassStorageClass.kext\n</code></pre></p> </li> </ul> </li> </ul>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#other-available-tools","title":"Other available tools","text":""},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#references","title":"References","text":"<p>Windows Disable USB Storage Devices Windows Disable burning DVD/CD </p>"},{"location":"4.Eradication/4.26_Stop_data_exfiltration/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.27_Stop_malware_backdoor/","title":"4.27-Stop Malware Backdoor","text":""},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#task-stop-malware-backdoor","title":"Task Stop malware backdoor","text":""},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#conditions","title":"Conditions","text":"<p>Given a compromised system, perform steps to stop malware backdoors and C2 beaconing.  </p>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#standards","title":"Standards","text":"<ul> <li>Run Stop_malware_backdoor.ps1 and an executable will named Cerberus.exe will appear.  </li> <li>Cerberus.exe will need to be run with administrator privileges.  </li> <li>Use Cerberus to either analyze, suspend, or kill the malware backdoor or C2 beaconing.  </li> </ul>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#end-state","title":"End State","text":"<p>System processes will be cleared of malicious code injection and back to its normal state.  </p>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#notes","title":"Notes","text":"<ul> <li>Cerberus will only go after the thread from within the process that it is hunting. There will not be a need to restart a process due to the fact that Cerberus is killing the thread that is infected, and ONLY that thread. It will not kill the process.  </li> <li>This Task will also apply to 4.28_Stop_C2_Beaconing  </li> </ul>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#manual-steps","title":"Manual Steps","text":"<ul> <li>Run Stop_malware_backdoor.ps1  </li> <li>Run Cerberus with --analyze or -a to analyze all of the hosts current running processes.  </li> <li>Run Cerberus with --suspend or -s to suspend the threads. This will not kill the thread, only suspend it that way malicious activities are not running while keeping the process running.  </li> <li>Run Cerberus with --kill or -k to kill the thread. The thread will be terminated and will not continue to beacon or be used as a backdoor. The process will not need to be restarted.  </li> </ul>"},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#running-script","title":"Running Script","text":""},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#dependencies","title":"Dependencies","text":""},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#other-available-tools","title":"Other available tools","text":""},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#references","title":"References","text":""},{"location":"4.Eradication/4.27_Stop_malware_backdoor/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/","title":"4.28-Stop C2 Beaconing","text":""},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#task-stop-c2-beaconing","title":"Task Stop C2 Beaconing","text":""},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#conditions","title":"Conditions","text":"<ul> <li>Compromised host that is beaconing externally to a potential malicious IP.  </li> <li>The compromised host have been compromised by malware (including zero-day) or system configuration vulnerability.  </li> </ul>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#standards","title":"Standards","text":"<ul> <li>An alert, event, or communication has been received indicating external connection attempts.  </li> <li>Identify the following:  <ul> <li>Source/Destination IP Addresses. Ensure logs/event are being read correctly. It may appear as the connection is coming from external to internal however it is in fact still internal to external. Bro logs/Snort rules may differ from Squil and ELSA events  </li> <li>Ports/Protocols Used - Common  <ul> <li>80/443 \u2013 Http/Https  </li> <li>53 - DNS  </li> <li>6667 \u2013 IRC  </li> <li>4444 \u2013 Metasploit  </li> <li>20/21 \u2013 FTP  </li> <li>22 \u2013 SSH  </li> <li>23 \u2013 Telnet  </li> <li>50050 - Cobaltstrike  </li> </ul> </li> <li>DNS names, if available  </li> <li>Even though there may initially be only one identified alert/event, there may be more than one host beaconing out to more than one malicious IPs/sites. Ensure that thorough review and pivoting is conducted to ensure that all affected hosts are identified. Reasonable anomalies should be investigated.  </li> <li>Malware names, hashes (MD5, SHA-256, etc).  </li> <li>Known system configuration vulnerabilities on affected hosts.  </li> </ul> </li> <li>Remove recursive DNS queries or remove root hints (if possible - this will prevent any dns lookups other than current domain) a. DNS Manager -&gt;  -&gt; properties -&gt; Forwarders b. Remove all recursive IPs c. Create a new recursive IP pointing no nowhere   <li>Create primary zone for the domain that is being called  <ul> <li>DNS Manager -&gt;  -&gt; New Zone   <li>Primary Zone  </li> <li>To all DNS servers running on domain controllers in this domain  </li> <li>Forward lookup zone  </li> <li>Zone name:  <li>Remove malware  </li> <li>Patch/harden system, if possible  </li> <li>Monitor and alert for future C2 beaconing events for any residual C2 characteristics not remediated.  </li>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#end-state","title":"End State","text":"<p>Compromised credentials are disabled and/or changed in all areas. Appropriate hosts are restricted or disabled. Attacker cannot re-use credentials to access any internal network area, hosts, hardware, or software.  </p>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#notes","title":"Notes","text":"<p>Specific manual steps, specific scripts, and dependencies cannot represent the multitude of ways beacons can communicate or the associated remediation. General actions are to either block the destination (ideally at the border to protect other assets), or remove the beacon itself.  </p>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#manual-steps","title":"Manual Steps","text":"<p>N/A  </p>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#running-script","title":"Running Script","text":"<p>N/A  </p>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#dependencies","title":"Dependencies","text":"<p>N/A  </p>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#other-available-tools","title":"Other available tools","text":""},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#references","title":"References","text":"<p>SANS C2 Analysis for IR Anti-Trojan Ports </p>"},{"location":"4.Eradication/4.28_Stop_C2_Beaconing/#revision-history","title":"Revision History","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/","title":"4.30-SecurityOnion Hunting","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#security-onion-hunting","title":"Security Onion Hunting","text":"<p>The purpose of this task is to document the procedures for threat hunting in Security Onion.  The task includes Sysmon examples and queries used to find the events.  </p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#conditions","title":"Conditions","text":"<ul> <li>Security Onion: The system must be installed and setup to receive log forwarding from the Wazuh agent on endpoints  </li> <li>Clients: <ul> <li>Sysmon installed using the ionstorm config file  </li> <li>Wazuh agent installed and forwarding, inscluding sysmon logs to Security Onion  </li> </ul> </li> </ul>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#standards","title":"Standards","text":"<p>These first examples are events from Sysmon showing some of the common tactics used by threat actors.  The events have been generated using MetaSploit and  CobaltStrike  </p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#lateral-movement","title":"Lateral Movement","text":"<p>A common tactic for lateral movement is to push an executable to a remote system and start a service, similar to how psexec.exe works  </p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#metasploit-lateral-movement-using-a-service-to-initiate-callback","title":"Metasploit lateral movement using a service to initiate callback","text":"<pre><code>Registry value set:\nRuleName: MitreRef=T1060,Technique=Registry Autorun Keys,Tactic=Persistence\nEventType: SetValue\nUtcTime: 2021-06-12 03:49:29.470\nProcessGuid: {298db6a9-2c67-60c4-eeb3-000000000000}\nProcessId: 620\nImage: C:\\Windows\\system32\\services.exe\nTargetObject: HKLM\\System\\CurrentControlSet\\Services\\DpRHdvsE\\Start\nDetails: DWORD (0x00000003)\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#metasploit-lateral-movement-using-a-service-to-initiate-callback-second-event","title":"Metasploit lateral movement using a service to initiate callback, second event","text":"<pre><code>Registry value set:\nRuleName: MitreRef=T1060,Technique=Registry Autorun Keys,Tactic=Persistence\nEventType: SetValue\nUtcTime: 2021-06-12 03:49:29.470\nProcessGuid: {298db6a9-2c67-60c4-eeb3-000000000000}\nProcessId: 620\nImage: C:\\Windows\\system32\\services.exe\nTargetObject: HKLM\\System\\CurrentControlSet\\Services\\DpRHdvsE\\ImagePath\nDetails: %%COMSPEC%% /b /c start /b /min powershell.exe -nop -w hidden -noni -c \"if([IntPtr]::Size -eq 4){$b='powershell.exe'}else{$b=$env:windir+'\\syswow64\\WindowsPowerShell\\v1.0\\powershell.exe'};$s=New-Object System.Diagnostics.ProcessStartInfo;$s.FileName=$b;$s.Arguments='-noni -nop -w hidden -c &amp;([scriptblock]::create((New-Object System.IO.StreamReader(New-Object System.IO.Compression.GzipStream((New-Object System.IO.MemoryStream(,[System.Convert]::FromBase64String(''H4sIAMguxGACA7shortentedforreadability''))),[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))';$s.UseShellExecute=$false;$s.RedirectStandardOutput=$true;$s.WindowStyle='Hidden';$s.CreateNoWindow=$true;$p=[System.Diagnostics.Process]::Start($s);\"\n</code></pre> <p>Process create is a useful event to look for.  It is common for an infected to host to create additional processes when performing other tasks such as, credential dumping or lateral movement  </p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#process-create-event","title":"Process create event","text":"<pre><code>Process Create:\nRuleName: technique_id=T1086,technique_name=PowerShell\nUtcTime: 2018-09-01 02:26:12.384\nProcessGuid: {79579f2b-f8c4-5b89-0000-0010a8e24300}\nProcessId: 5568\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nFileVersion: 10.0.14393.0 (rs1_release.160715-1616)\nDescription: Windows PowerShell\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nCommandLine: powershell.exe  -nop -w hidden -encodedcommand JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAEkAT\nCurrentDirectory: C:\\Windows\\system32\\\nUser: computer\\user\nLogonGuid: {79579f2b-f60c-5b89-0000-0020415e0600}\nLogonId: 0x65E41\nTerminalSessionId: 1\nIntegrityLevel: High\nHashes: SHA1=044A0CF1F6BC478A7172BF207EEF1E201A18BA02,MD5=097CE5761C89434367598B34FE32893B,SHA256=BA4038FD20E474C047BE8AAD5BFACDB1BFC1DDBE12F803F473B7918D8D819436,IMPHASH=CAEE994F79D85E47C06E5FA9CDEAE453\nParentProcessGuid: {79579f2b-f737-5b89-0000-0010a2d22200}\nParentProcessId: 2764\nParentImage: C:\\Windows\\System32\\cmd.exe\nParentCommandLine: \"C:\\Windows\\system32\\cmd.exe\"\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#process-create-event-for-lateral-movement","title":"Process create event for lateral movement","text":"<pre><code>Process Create:\nRuleName: -\nUtcTime: 2021-06-24 02:44:23.786\nProcessGuid: {f3da3d38-f187-60d3-b099-6a1600000000}\nProcessId: 7072\nImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nFileVersion: 10.0.14393.206 (rs1_release.160915-0644)\nDescription: Windows PowerShell\nProduct: Microsoft\u00ae Windows\u00ae Operating System\nCompany: Microsoft Corporation\nOriginalFileName: PowerShell.EXE\nCommandLine: powershell.exe -nop -w hidden -enc SQBFAFgAIAAoACgAbgBlAHcALQBvA==\nCurrentDirectory: C:\\WINDOWS\\system32\\\nUser: computer\\user\nLogonGuid: {f3da3d38-f187-60d3-e798-6a1600000000}\nLogonId: 0x166A98E7\nTerminalSessionId: 0\nIntegrityLevel: High\nHashes: MD5=097CE5761C89434367598B34FE32893B,SHA256=BA4038FD20E474C047BE8AAD5BFACDB1BFC1DDBE12F803F473B7918D8D819436,IMPHASH=CAEE994F79D85E47C06E5FA9CDEAE453\nParentProcessGuid: {f3da3d38-d166-60cb-4b31-020000000000}\nParentProcessId: 2868\nParentImage: C:\\Windows\\System32\\wbem\\WmiPrvSE.exe\nParentCommandLine: C:\\WINDOWS\\system32\\wbem\\wmiprvse.exe -secured -Embedding\n</code></pre> <p>Malware almost always has to connect back to a C2 system for follow on instructions and to maintain persistance  </p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#network-event-this-is-an-example-of-powershell-used-as-the-initial-infection-making-a-call-back-not-a-great-example-since-it-was-done-locally-in-vmware","title":"Network event.  This is an example of powershell used as the initial infection making a call back.  Not a great example, since it was done locally in vmware","text":"<pre><code>Network connection detected:\nRuleName: technique_id=T1218,technique_name=Signed Binary Proxy Execution\nUtcTime: 2018-09-01 02:26:19.331\nProcessGuid: {79579f2b-f8c7-5b89-0000-0010f4864400}\nProcessId: 5552\nImage: C:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe\nUser: computer\\user\nProtocol: tcp\nInitiated: true\nSourceIsIpv6: false\nSourceIp: 192.168.1.130\nSourceHostname: computer\nSourcePort: 1907\nSourcePortName: \nDestinationIsIpv6: false\nDestinationIp: 192.168.1.143\nDestinationHostname: \nDestinationPort: 443\nDestinationPortName: https\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#credential-events","title":"Credential Events","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#mimikatz-grabbing-credentials-from-current-logged-on-users","title":"mimikatz grabbing credentials from current logged on users","text":"<pre><code>Process accessed:\nRuleName: technique_id=T1003,technique_name=Credential Dumping\nUtcTime: 2018-09-01 02:40:12.833\nSourceProcessGUID: {79579f2b-fc0c-5b89-0000-001097eb6f00}\nSourceProcessId: 5212\nSourceThreadId: 6996\nSourceImage: C:\\Windows\\System32\\rundll32.exe\nTargetProcessGUID: {79579f2b-f5fa-5b89-0000-00105a9c0000}\nTargetProcessId: 604\nTargetImage: C:\\Windows\\system32\\lsass.exe\nGrantedAccess: 0x1010\nCallTrace: C:\\Windows\\SYSTEM32\\ntdll.dll+a6574|C:\\Windows\\System32\\KERNELBASE.dll+20edd|UNKNOWN(000001C7A2AA710D)\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#mimikatz-grabbing-hashes-from-the-local-accounts","title":"mimikatz grabbing hashes from the local accounts","text":"<pre><code>Process accessed:\nRuleName: technique_id=T1003,technique_name=Credential Dumping\nUtcTime: 2018-09-01 02:45:26.030\nSourceProcessGUID: {79579f2b-fd45-5b89-0000-0010c5657300}\nSourceProcessId: 6420\nSourceThreadId: 4172\nSourceImage: C:\\Windows\\System32\\rundll32.exe\nTargetProcessGUID: {79579f2b-f5fa-5b89-0000-00105a9c0000}\nTargetProcessId: 604\nTargetImage: C:\\Windows\\system32\\lsass.exe\nGrantedAccess: 0x1FFFFF\nCallTrace: C:\\Windows\\SYSTEM32\\ntdll.dll+a6574|C:\\Windows\\System32\\KERNELBASE.dll+20edd|UNKNOWN(0000022B28BB1D25)\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#process-injection","title":"Process Injection","text":"<pre><code>Registry object added or deleted:\nCreateRemoteThread detected:\nRuleName: -\nUtcTime: 2021-06-24 03:10:58.927\nSourceProcessGuid: {f3da3d38-f187-60d3-b099-6a1600000000}\nSourceProcessId: 7072\nSourceImage: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\nTargetProcessGuid: {f3da3d38-d163-60cb-f2d1-010000000000}\nTargetProcessId: 1316\nTargetImage: C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe\nNewThreadId: 4032\nStartAddress: 0x000001A4BC400000\nStartModule: -\nStartFunction: -\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#security-onion-hunt","title":"Security Onion Hunt","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#the-next-section-will-provide-some-basic-queries-that-can-be-used-in-security-onion-hunt","title":"The next section will provide some basic queries that can be used in Security Onion Hunt","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#filter-for-all-sysmon-events","title":"Filter for all sysmon events","text":"<pre><code>AND event.module:\"sysmon\" | groupby event.module event.dataset\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#filter-for-create-remote-thread-type-events","title":"Filter for create remote thread type events","text":"<pre><code>AND event.module: \"sysmon\" AND event.dataset:\"create_remote_thread\" | groupby event.module event.dataset\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#filter-for-network-events","title":"Filter for network events","text":"<pre><code>AND event.module: \"sysmon\" AND event.dataset: \"network_connection\" | groupby event.module event.dataset\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#filtering-for-specifc-systems","title":"Filtering for specifc systems","text":"<pre><code>AND event.module: \"sysmon\" AND agent.ip:\"x.x.x.x\" | groupby event.module event.dataset\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#security-onion-elastic","title":"Security Onion Elastic","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#the-next-section-will-provide-some-basic-queries-that-can-be-used-in-security-onion-elastic","title":"The next section will provide some basic queries that can be used in Security Onion Elastic","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#credential-dumping","title":"Credential dumping","text":"<p>Note: You are looking for processes that do not normally touch lsass.exe <pre><code>event.module: \"sysmon\" AND event.dataset:\"create_remote_thread\" AND message:\"*lsass.exe\"\n</code></pre></p> <pre><code>event.module: \"sysmon\" AND event.dataset:\"create_remote_thread\" AND winlog.event_data.targetImage:\"*lsass.exe\"\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#lateral-movement_1","title":"Lateral movement","text":"<pre><code>event.module: \"sysmon\" AND event.dataset:\"registry_value_set\" AND winlog.event_data.targetObject:\"*Start\"\n</code></pre> <pre><code>event.module: \"sysmon\" AND process.parent.executable:\"WmiPrvSE.exe\"\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#process-injection_1","title":"Process injection","text":"<p>Note: add following fields on the left: winlog.event_data.sourceImage and winlog.event_data.targetImage and look for sourceimages like powershell|rundll32 <pre><code>event.module: \"sysmon\" AND event.dataset:\"create_remote_thread\"\n</code></pre></p> <pre><code>(event.module:\"sysmon\" AND event.dataset:\"create_remote_thread\" AND winlog.event_data.sourceImage:\"powershell.exe\") OR (event.module:\"sysmon\" AND event.dataset:\"create_remote_thread\" AND winlog.event_data.sourceImage:\"rundll32.exe\" )\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#network-events","title":"Network Events","text":""},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#network-smb-executable-file-transfer","title":"Network SMB executable file transfer","text":"<pre><code>rule.name: \"ET POLICY SMB Executable File Transfer\"\n</code></pre> <pre><code>event.dataset.keyword: smb_files\n</code></pre> <pre><code>file.name.keyword: *.exe\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#remote-service-control-request","title":"Remote Service Control Request","text":"<pre><code>rule.name: \"ET RPC DCERPC SVCCTL - Remote Service Control Manager Access\"\n</code></pre> <pre><code>dce_rpc.operation.keyword: OpenSCManagerA\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#lateral-movement-using-ntlm-pass-the-hash","title":"Lateral movement using NTLM (pass-the-hash)","text":"<pre><code>event.dataset.keyword: ntlm\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#lateral-movement-using-winrm","title":"Lateral movement using WinRM","text":"<pre><code>rule.name: \"ET POLICY WinRM wsman Access - Possible Lateral Movement\"\n</code></pre> <pre><code>rule.metadata.tag.keyword: WinRM\n</code></pre> <pre><code>rule.name.keyword: \"ET USER_AGENTS WinRM User Agent Detected - Possible Lateral Movement\"\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#cobaltstrike-c2-communication-not-sure-how-accurate-this-is-but-it-returned-c2-communication","title":"CobaltStrike C2 communication (not sure how accurate this is, but it returned C2 communication)","text":"<pre><code>server.packets &gt;8 AND server.packets &lt;12\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#finding-executable-files","title":"Finding executable files","text":"<pre><code>file.mime_type.keyword: application/x-dosexec\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#dns-queries","title":"DNS Queries","text":"<pre><code>dns.query.name.keyword:* AND dns.query.type_name.keyword: A (This will find all DNS A records, not very usefull but a syntax example)\n</code></pre>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#end-state","title":"End State","text":"<p>Provide examples of threat hunting in Security onion  </p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#notes","title":"Notes","text":"<p>N/A  </p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#manual-steps","title":"Manual Steps","text":"<p>N/A  </p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#running-script","title":"Running Script","text":"<p>N/A  </p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#dependencies","title":"Dependencies","text":"<p>N/A  </p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#other-available-tools","title":"Other available tools","text":"<p>N/A  </p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#references","title":"References","text":"<p>Windows Event Log Examples SIGMA Rules Examples RUNDLL32 Connection to the Internet Quick Malware Analysis with Security Onion Quick Malware Analysis: malware-traffic-analysis.net pcap from 2021-06-18 </p>"},{"location":"4.Eradication/4.30_Security_Onion_Hunting/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/","title":"5.Recovery","text":""},{"location":"5.Recovery/#recovery-tasks","title":"Recovery Tasks","text":"<p>Develop and implement appropriate activities to maintain plans for resilience and to restore any capabilities or services that were impaired due to a cybersecurity incident.  </p> <p>The Recover Function supports timely recovery to normal operations to reduce the impact from a cybersecurity incident. Examples of outcome Categories within this Function include: Recovery Planning; Improvements; and Communications.</p>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/","title":"5.01-Vulnerability Scans","text":""},{"location":"5.Recovery/5.01_Vulnerability_Scans/#task-update-the-initial-supported-mission-partner-mp-vulnerability-assessment-va-scan","title":"Task Update the initial supported Mission Partner (MP) vulnerability assessment (VA) (scan)","text":""},{"location":"5.Recovery/5.01_Vulnerability_Scans/#conditions","title":"Conditions","text":"<p>Given an IR Team deployed supporting a designated MP in Cyber Incident Recovery.  </p>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/#standards","title":"Standards","text":"<p>In coordination with the supported MP, the DCO-E should:  </p> <ul> <li>Review initial the VA and document any/all changes made to improve security  </li> <li>Conduct a port scan and document deltas with original scans  </li> <li>Conduct a vulnerability scan and document deltas with the original scans  </li> <li>As needed conduct a web application vulnerability scan (e.g. Burp Suite) and document deltas  </li> <li>As needed test firewalls, IDS/IPS, proxies and boundary defense appliance configurations and document deltas  </li> <li>Provide End of Assessment Nessus Report  </li> <li>Additional assessments as needed </li> </ul>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/#end-state","title":"End State","text":"<p>The IR Team provides an updated VA &amp; scan to the support mission partner in order to document any actions taken during Eradication and Recovery phases.   </p>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/#notes","title":"Notes","text":"<p>Depending on the severity and/or complexity of the cyber incident, the DCO-E may consider conducting another full vulnerability assessment. At a minimum, full network/system scans with tools such as NMAP, OpenVAS, NESSUS, orothers is critical.  </p>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.01_Vulnerability_Scans/#running-script","title":"Running Script","text":"<p>N/A  </p>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/#dependencies","title":"Dependencies","text":"<p>N/A  </p>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/#other-available-tools","title":"Other available tools","text":"<p>N/A  </p>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/#references","title":"References","text":"<p>NIST Cyber Security Framework NIST SP 800-184: Guide to Cyber Event Recovery US CERT: Cyber Resilience Review Self Assessment Package </p>"},{"location":"5.Recovery/5.01_Vulnerability_Scans/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/","title":"5.02-Cyber Security Improvements","text":""},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#task-provide-cyber-security-improvement-recommendations-to-mission-partner-mp","title":"Task Provide cyber security improvement recommendations to Mission Partner (MP)","text":""},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#conditions","title":"Conditions","text":"<p>Given an IR Team deployed supporting a designated MP in Cyber Incident Recovery.  </p>"},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#standards","title":"Standards","text":"<p>Upon moving into the Recovery Phase, the DCO-E should review their documentation and findings (from previous port, network, service, and vulnerability scans) to provide improvement recommendations to the MP.  These recommendations may include the following areas:  </p> <ul> <li>Unauthorized Devices  </li> <li>Unauthorized Software  </li> <li>Hardware and Software Configurations  </li> <li>Vulnerability Assessments and Remediation  </li> <li>Administrative Privileges  </li> <li>Maintenance, Monitoring, and Analysis of Logs  </li> <li>Email and Web Browser  </li> <li>Malware Defense  </li> <li>Management of Network Ports  </li> <li>Data Recovery  </li> <li>Network Device Configurations  </li> <li>Boundary Defense  </li> <li>Data Protection  </li> <li>Need to Know Access  </li> <li>Wireless Access  </li> <li>User Account Management  </li> <li>User Cyber Security Training  </li> <li>Application Software Security  </li> <li>Incident Response Management  </li> <li>Cyber Security Exercises  </li> </ul> <p>The IR Team should provide recommendations in a format agreed upon with the supported MP.  </p>"},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#end-state","title":"End State","text":"<p>IR Team provides written recommendations to the supported MP on improving their cyber security posture (minimum focus on the network defense plan).  </p>"},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#notes","title":"Notes","text":"<p>Providing cyber security improvement recommendations begins with solid documentation of vulnerabilities identified upon arriving on site.  </p>"},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#references","title":"References","text":"<p>NIST Cyber Security Framework NIST SP 800-184: Guide to Cyber Event Recovery US CERT: Cyber Resilience Review Self Assessment Package</p>"},{"location":"5.Recovery/5.02_Cyber-Security-Improvements/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/","title":"5.03-Firewall Analysis","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#task-review-firewall-rules-and-logs-ensure-mfa-is-enabled-for-all-user-access","title":"Task Review firewall rules and logs. Ensure MFA is enabled for all user access","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#conditions","title":"Conditions","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#standards","title":"Standards","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#end-state","title":"End State","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#notes","title":"Notes","text":"<p>Incomplete  </p>"},{"location":"5.Recovery/5.03_Firewall_Analysis/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#references","title":"References","text":""},{"location":"5.Recovery/5.03_Firewall_Analysis/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.04_Password_Requirements/","title":"5.04-Password Requirements","text":""},{"location":"5.Recovery/5.04_Password_Requirements/#task-password_requirements-define-and-implement-best-password-policies-and-practices","title":"Task Password_Requirements: Define and implement best password policies and practices","text":""},{"location":"5.Recovery/5.04_Password_Requirements/#conditions","title":"Conditions","text":"<p>Given a network, implement stronger password policies  </p>"},{"location":"5.Recovery/5.04_Password_Requirements/#standards","title":"Standards","text":"<p>Upon moving into the Recovery Phase, the IR Team should recommend stronger password policies  </p> <ul> <li>Remove Periodic Password Change Requirements</li> <li>Use A Password Manager</li> <li>Recommend the use of a secure Password Manager (i.e. KeePass, LastPass, etc.)</li> <li>Minimum Password Length</li> <li>Ensure password length of at least 8 characters in accordance with NIST standards.</li> <li>Encourage the use of passphrases (a string if words that makes a password long and memorable)</li> <li>Implement Screening of New Passwords</li> <li>When processing requests to establish and change memorized secrets, verifiers SHALL compare the prospective secrets against a list that contains values known to be commonly-used, expected, or compromised. For example, the list MAY include, but is not limited to:  </li> </ul> <p>Passwords obtained from previous breach corpuses.  </p> <ul> <li>Dictionary words  </li> <li>Repetitive or sequential characters (e.g. <code>aaaaaa</code>, <code>1234abcd</code>)  </li> <li>Context-specific words, such as the name of the service, the username, and derivatives thereof  </li> </ul>"},{"location":"5.Recovery/5.04_Password_Requirements/#end-state","title":"End State","text":"<p>The IR Team provides secure password policies to implement  </p>"},{"location":"5.Recovery/5.04_Password_Requirements/#notes","title":"Notes","text":"<p>N/A  </p>"},{"location":"5.Recovery/5.04_Password_Requirements/#references","title":"References","text":"<p>NIST Special Publication 800-63B </p>"},{"location":"5.Recovery/5.04_Password_Requirements/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.05_Create_new_baselines/","title":"Task Create New Baselines","text":""},{"location":"5.Recovery/5.05_Create_new_baselines/#conditions","title":"Conditions","text":"<p>Create baseline image(s) for the following(s) to meet the compliance against the NIST Moderate standards  </p> <ul> <li>Hosts  </li> <li>Servers  </li> <li>Domain Controller(s)  </li> </ul>"},{"location":"5.Recovery/5.05_Create_new_baselines/#standards","title":"Standards","text":"<ul> <li>All baseline image(s) must be checked to verify that no critical and high vulnerabilities exists in the image at the time of creation.  </li> <li>Run vulnerability analysis (Nessus preferred) of the image with the latest plugins.  </li> <li>This must include workstations, laptops, application servers, and domain controllers.  </li> <li>Use provided Security Content Automation Protocol Tool (SCAP) to achieve baseline image of 70% or greater SCAP score.  </li> </ul>"},{"location":"5.Recovery/5.05_Create_new_baselines/#end-state","title":"End State","text":"<p>All created baseline images must be free of critical/high vulnerabilities AND have 70% or greater SCAP score.  </p>"},{"location":"5.Recovery/5.05_Create_new_baselines/#notes","title":"Notes","text":""},{"location":"5.Recovery/5.05_Create_new_baselines/#manual-steps","title":"Manual Steps","text":"<ul> <li>Load/Install operating system to be used for creating baseline image.  </li> <li>Run security patches and recommended updates.  </li> <li>Ensure that the Vulnerability Scanner (Nessus) has the latest plugins and analyze the baseline image.  </li> <li>Identify and remediate all critical and high findings using the Nessus report(s) remediation guide.  </li> <li>Repeat this process until no critical and high vulnerabilities exist.  </li> <li>It is highly recommended that all vulnerabilities are reviewed and patched according to the agencys' security guidelines, including moderate and low vulnerabilities, to minimize attack surface.  </li> <li>Load Security Content Automation Protocol (SCAP) tool and scan the image.  This process can be done on the image itself or via remote.  </li> <li>Review and remediate findings to further harden the image.  </li> <li>Repeat this process until 70% or better score is achieved.  </li> <li>Save image.  </li> <li>Test out new image in small sets in multiple departments prior to mass rollout.  </li> </ul>"},{"location":"5.Recovery/5.05_Create_new_baselines/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.05_Create_new_baselines/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.05_Create_new_baselines/#references","title":"References","text":"<p>DISA SCAP Content </p>"},{"location":"5.Recovery/5.05_Create_new_baselines/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.06_Syslog_Retention/","title":"Task Syslog_Retention","text":""},{"location":"5.Recovery/5.06_Syslog_Retention/#conditions","title":"Conditions","text":"<p>The agency will generate and retain audit logs for a period of 6 months or longer.  </p>"},{"location":"5.Recovery/5.06_Syslog_Retention/#standards","title":"Standards","text":"<p>Must provide logs for the following for 6 months:  </p> <ul> <li>Firewall Events  </li> <li>DNS ingress and egress logs  </li> <li>Domain Controller Events  </li> <li>Intrusion Detection/Protection Events  </li> <li>Web Usage  </li> </ul>"},{"location":"5.Recovery/5.06_Syslog_Retention/#end-state","title":"End State","text":"<p>Retain all logs identified for 6 months (minimum) to meet the incident response requirements.  </p>"},{"location":"5.Recovery/5.06_Syslog_Retention/#notes","title":"Notes","text":""},{"location":"5.Recovery/5.06_Syslog_Retention/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.06_Syslog_Retention/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.06_Syslog_Retention/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.06_Syslog_Retention/#references","title":"References","text":""},{"location":"5.Recovery/5.06_Syslog_Retention/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.07_Patch_Management/","title":"Task Patch Management and continuous monitoring","text":""},{"location":"5.Recovery/5.07_Patch_Management/#conditions","title":"Conditions","text":"<p>Create task(s) to continuously perform vulnerability scans of all assets.  Identify and remediate all critical and high vulnerabilities more than 30 days.  </p>"},{"location":"5.Recovery/5.07_Patch_Management/#standards","title":"Standards","text":"<ul> <li>Perform authenticated (domain privileged, local admin, root) scans.  </li> <li>All assets on the network must scanned.  </li> <li>All assets must be scanned monthly.  </li> <li>Vulnerability scan signature (plugins) must be updated within 15 days of the scan.  </li> </ul>"},{"location":"5.Recovery/5.07_Patch_Management/#end-state","title":"End State","text":"<p>Must produce proof of recurring patch management and continuous monitoring.  </p> <ul> <li>Vulnerability scan history of 2 months  </li> <li>Patch management history of 2 months  </li> <li>No critical and high risk vulnerabilities detected over 30 days of detection  </li> </ul>"},{"location":"5.Recovery/5.07_Patch_Management/#notes","title":"Notes","text":""},{"location":"5.Recovery/5.07_Patch_Management/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.07_Patch_Management/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.07_Patch_Management/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.07_Patch_Management/#references","title":"References","text":"<p>NIST 800-53 NIST 800-171 </p>"},{"location":"5.Recovery/5.07_Patch_Management/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.08_User_Cyber_Training/","title":"Task User-Cyber-Training","text":""},{"location":"5.Recovery/5.08_User_Cyber_Training/#conditions","title":"Conditions","text":"<p>Provide users monthly and yearly training  </p> <ul> <li>Cyber Security Awareness Training  </li> <li>Phishing Security Training  </li> </ul>"},{"location":"5.Recovery/5.08_User_Cyber_Training/#standards","title":"Standards","text":"<p>All new and existing users are to complete annual cyber training in order to obtain network access.  </p> <p>Training certification(s) are good for one year and must be nenewed prior to the expiration date.  </p> <p>All user accounts without current certifications will be disabled until all requirements are met.  </p>"},{"location":"5.Recovery/5.08_User_Cyber_Training/#end-state","title":"End State","text":"<p>Emphasize the importance of cyber security  and raise awareness for all employees.  </p>"},{"location":"5.Recovery/5.08_User_Cyber_Training/#notes","title":"Notes","text":""},{"location":"5.Recovery/5.08_User_Cyber_Training/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.08_User_Cyber_Training/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.08_User_Cyber_Training/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.08_User_Cyber_Training/#references","title":"References","text":""},{"location":"5.Recovery/5.08_User_Cyber_Training/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.09_System_Restoration/","title":"Task","text":""},{"location":"5.Recovery/5.09_System_Restoration/#conditions","title":"Conditions","text":""},{"location":"5.Recovery/5.09_System_Restoration/#standards","title":"Standards","text":""},{"location":"5.Recovery/5.09_System_Restoration/#end-state","title":"End State","text":""},{"location":"5.Recovery/5.09_System_Restoration/#notes","title":"Notes","text":""},{"location":"5.Recovery/5.09_System_Restoration/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.09_System_Restoration/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.09_System_Restoration/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.09_System_Restoration/#references","title":"References","text":""},{"location":"5.Recovery/5.09_System_Restoration/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.10_Account_Audit/","title":"Task Account Audit","text":""},{"location":"5.Recovery/5.10_Account_Audit/#conditions","title":"Conditions","text":"<p>Review standard and privilege accounts to identify and remediate users with access beyond daily operations.  </p>"},{"location":"5.Recovery/5.10_Account_Audit/#standards","title":"Standards","text":"<p>In accordance with Principle of Least Permissions, privileged roles and standard roles must to reviewed on regular basis.    </p> <p>Privileged and Standard roles(accounts) should have minimum permissions to allow daily operations. All privilege accounts should be separate per roles.  (i.e.  Domain Admins - DA-username, Servers - svc-username,   DNS - dns-username)  </p> <ul> <li> <p>Privilege roles (100% Check monthly)  </p> <ul> <li>Enterprise administrators  </li> <li>Domain Administrators  </li> <li>Power Users  </li> <li>HelpDesk  </li> <li>Service Accounts  </li> <li>DNS Administrators  </li> <li>Other  </li> </ul> </li> <li> <p>Standard Roles (20% Check quarterly)  </p> <ul> <li>All standard role accounts with separate privilege role accounts should be checked montly.  </li> </ul> </li> </ul>"},{"location":"5.Recovery/5.10_Account_Audit/#end-state","title":"End State","text":"<p>Agency free of standard users accounts with privilege roles. Separation of privilege roles (DNS, DA, Enterprise, etc)  </p>"},{"location":"5.Recovery/5.10_Account_Audit/#notes","title":"Notes","text":""},{"location":"5.Recovery/5.10_Account_Audit/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.10_Account_Audit/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.10_Account_Audit/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.10_Account_Audit/#references","title":"References","text":"<p>NIST 800-53 AC-6 NIST 800-171 (3.1.5) </p>"},{"location":"5.Recovery/5.10_Account_Audit/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.11_Turn_Over_Mission_Related_Documents/","title":"5.11-Turn over Mission related Documents","text":""},{"location":"5.Recovery/5.11_Turn_Over_Mission_Related_Documents/#task-turn-over-mission-related-documents-turn-over-incident-mission-related-documentation-to-the-supported-mission-partner-mp","title":"Task Turn Over Mission Related Documents: Turn-Over incident mission-related documentation to the supported Mission Partner (MP).","text":""},{"location":"5.Recovery/5.11_Turn_Over_Mission_Related_Documents/#conditions","title":"Conditions","text":"<p>Given an IR Team deployed supporting a designated MP in Cyber Incident Recovery.  </p>"},{"location":"5.Recovery/5.11_Turn_Over_Mission_Related_Documents/#standards","title":"Standards","text":"<p>Upon moving into the Recovery Phase, the IR Team should gather and prepare the following items for turn-over to the supported mission partner:  </p> <ul> <li>Mission Logs  </li> <li>Accounts Added  </li> <li>Ports Opened  </li> <li>Software Installed  </li> <li>Network Maps  </li> <li>System and Network Configuration Information  </li> <li>Team Chats   </li> <li>Emails  </li> <li>Wall Notes  </li> <li>System Logs  </li> <li>Packet Captures  </li> <li>Malware Samples  </li> <li>Others  </li> </ul> <p>This list is not exhaustive. If the IR Team produces it during mission, it should be considered an artifact and turned over to the supported MP.  </p>"},{"location":"5.Recovery/5.11_Turn_Over_Mission_Related_Documents/#end-state","title":"End State","text":"<p>The IR Team provides all mission logs, journals, and incident response artifacts to the supported MP in keeping with any Non-Disclosure Agreement stipulations.  The IR Team Team Leader ensures that team members do not keep any response related documentation unless approved by the supported MP for future training opportunities.  </p>"},{"location":"5.Recovery/5.11_Turn_Over_Mission_Related_Documents/#notes","title":"Notes","text":"<p>IR Team personnel should be aware that during incident response that any/all notes, logs, journals, diagrams, etc... that they create belong to the supported MP.  It is imperative that this policy be strictly followed to ensure trust is maintained with the supported MP.  </p>"},{"location":"5.Recovery/5.11_Turn_Over_Mission_Related_Documents/#references","title":"References","text":"<p>NIST Cyber Security Framework NIST SP 800-184: Guide to Cyber Event Recovery </p>"},{"location":"5.Recovery/5.11_Turn_Over_Mission_Related_Documents/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.12_Creating_Clean_Backups/","title":"5.12-Creating Clean Backups","text":""},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#creating-clean-backups-task","title":"Creating Clean Backups Task","text":""},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#conditions","title":"Conditions","text":"<p>Establish a plan to prevent/recover from an incident escalating to a disaster.  </p>"},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#standards","title":"Standards","text":"<p>Create back-ups to minimize downtime in a catastrophic event using the 3-2-1 rule.</p>"},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#end-state","title":"End State","text":""},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#notes","title":"Notes","text":""},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#manual-steps","title":"Manual Steps","text":"<ul> <li>Make three copies of every piece of important data so that no single event will wipeout all the data.  </li> <li>Make two different formats such as external media, network, cloud.  </li> <li>Keep one copy offsite in case of physical disasters like theft, fire, earthquake, etc.  </li> </ul>"},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#running-scripts","title":"Running Scripts","text":""},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#references","title":"References","text":"<p>NIST Guide to General Server Security SANS Backup Whitepaper CISA Data Backup Options </p>"},{"location":"5.Recovery/5.12_Creating_Clean_Backups/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.13-Conduct_Outbriefing/","title":"5.13-Conduct Outbriefing","text":""},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#conduct-outbriefing-of-mission-partner-mp-task","title":"Conduct Outbriefing of Mission Partner (MP) Task","text":""},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#conditions","title":"Conditions","text":"<p>Given a IR Team deployed supporting a designated MP in a completed Cyber Incident Recovery.  </p>"},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#standards","title":"Standards","text":"<p>A mission out briefing should be conducted to inform MP of the completed cyber incident recovery mission. During this briefing, the following items should be included in briefing:  </p> <ul> <li>After Action Review (containing follow up report and lessons learned)  </li> <li>Lessons Learned  </li> <li>Question and Answer Session  </li> </ul>"},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#end-state","title":"End State","text":"<p>The IR Team communicates the after-action review report and lessons clearly and concisely to MP. The MP reviews the briefing and asks questions for clarification purposes.  </p>"},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#notes","title":"Notes","text":"<p>The listing in the standards is not exhaustive.  </p>"},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#running-script","title":"Running Script","text":""},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#other-available-tools","title":"Other available tools","text":""},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#references","title":"References","text":"<p>NIST Cyber Security Framework NIST SP 800-61: Computer Security Incident Handling Guide </p>"},{"location":"5.Recovery/5.13-Conduct_Outbriefing/#revision-history","title":"Revision History","text":""},{"location":"5.Recovery/5.14-Conduct_AAR/","title":"5.14-Conduct AAR","text":""},{"location":"5.Recovery/5.14-Conduct_AAR/#conduct-after-action-review-to-support-redeployment-efforts-task","title":"Conduct After Action Review to support redeployment efforts Task","text":""},{"location":"5.Recovery/5.14-Conduct_AAR/#conditions","title":"Conditions","text":"<p>Given an IR Team deployed supporting a designated MP in Cyber Incident Recovery.  </p>"},{"location":"5.Recovery/5.14-Conduct_AAR/#standards","title":"Standards","text":"<p>Upon moving into the redeployment Phase, the IR Team should develop an AAR containing the following elements:  </p> <ul> <li>List of Participants  </li> <li>Review key actions/event that occurred during mission  </li> <li>Analysis of Lessons Learned  </li> <li>Remediation plans to prevent this from occurring in the future  </li> <li>Discussion of final indicators of compromise to share for detection of potential incidents across the community  </li> <li>Staff performance review  </li> <li>Corrective actions review  </li> <li>Tool utilization review  </li> <li>Process gaps review  </li> <li>Documentation gaps review  </li> <li>Training review This list is not exhaustive. If the IR Team produces it during mission, it should be considered an artifact and turned over to the supported MP.  </li> </ul>"},{"location":"5.Recovery/5.14-Conduct_AAR/#end-state","title":"End State","text":"<p>The IR Team completes a full after action review with MP. The MP contains knowledge from knowing lessons learned, ways to prevent future incidents, and how to detect an actionable incident.  </p>"},{"location":"5.Recovery/5.14-Conduct_AAR/#manual-steps","title":"Manual Steps","text":""},{"location":"5.Recovery/5.14-Conduct_AAR/#running-script","title":"Running Script","text":""},{"location":"5.Recovery/5.14-Conduct_AAR/#dependencies","title":"Dependencies","text":""},{"location":"5.Recovery/5.14-Conduct_AAR/#other-available-tools","title":"Other available tools","text":""},{"location":"5.Recovery/5.14-Conduct_AAR/#references","title":"References","text":"<p>NIST Cyber Security Framework NIST SP 800*61: Computer Security Incident Handling Guide </p>"},{"location":"5.Recovery/5.14-Conduct_AAR/#revision-history","title":"Revision History","text":""},{"location":"6.LessonsLearned/","title":"6.Lessons Learned","text":"<p>After Action Reviews (AARs) are structured debriefings that occur after a particular event or project has concluded. The purpose of AARs is to evaluate the effectiveness of the project or operation and to identify areas for improvement. These reviews are typically conducted by a team that includes key personnel who participated in the event or project. The goal is to have an open and honest discussion about what went well, what did not go well, and what can be done differently in the future. The results of AARs are often used to inform future planning and decision-making, allowing organizations to continuously improve their processes and outcomes. Overall, the purpose of AARs is to promote learning, enhance performance, and drive organizational success.  </p>"},{"location":"6.LessonsLearned/6.01-After_Action_Review/","title":"6.01-After Action Review(AAR)","text":""},{"location":"6.LessonsLearned/6.01-After_Action_Review/#after-action-report-task","title":"After Action Report Task","text":"<p>After any training exercise or event the team should conduct an After Action Review.  This will help improve the process or document any changes in documentation needed.  </p>"},{"location":"6.LessonsLearned/6.01-After_Action_Review/#conditions","title":"Conditions","text":"<p>Given an After Action Report Template, conduct a After Action Review of the event.  </p>"},{"location":"6.LessonsLearned/6.01-After_Action_Review/#standards","title":"Standards","text":""},{"location":"6.LessonsLearned/6.01-After_Action_Review/#end-state","title":"End State","text":"<p>Completed After Action Report for the event.  </p>"},{"location":"6.LessonsLearned/6.01-After_Action_Review/#notes","title":"Notes","text":""},{"location":"6.LessonsLearned/6.01-After_Action_Review/#manual-steps","title":"Manual Steps","text":"<ul> <li>Download the After_Action_Report_Template.docx using the References Link below.  </li> <li>Conduct After Action Review with the team and document the results using the template provided.  </li> <li>Submit After Action Report to coordinating organization.  </li> </ul>"},{"location":"6.LessonsLearned/6.01-After_Action_Review/#running-script","title":"Running Script","text":""},{"location":"6.LessonsLearned/6.01-After_Action_Review/#dependencies","title":"Dependencies","text":""},{"location":"6.LessonsLearned/6.01-After_Action_Review/#other-available-tools","title":"Other available tools","text":""},{"location":"6.LessonsLearned/6.01-After_Action_Review/#references","title":"References","text":"<p>AAR Template DINFOS AAR Template </p>"},{"location":"6.LessonsLearned/6.01-After_Action_Review/#revision-history","title":"Revision History","text":"<p>Note: Place new entries at the top to create a decending list of changes. * 20220213 - Initial document creation  </p>"},{"location":"ReferenceDocuments/","title":"Reference Documents","text":"<p>This section should cover any unique references for commands, tools or any other helpful information that does not fit any where else.  </p>"},{"location":"ReferenceDocuments/PowerShell_Commands/","title":"PowerShell Commands","text":""},{"location":"ReferenceDocuments/PowerShell_Commands/#get-winevent","title":"Get-WinEvent","text":"<p>View all events in the live system Event Log: <pre><code>Get-WinEvent -LogName system\n</code></pre> View all events in the live security Event Log (requires administrator PowerShell): <pre><code>Get-WinEvent -LogName security\n</code></pre> View all events in the file example.evtx, format list (fl) output: <pre><code>Get-WinEvent -Path example.evtx | fl\n</code></pre> View all events in example.evtx, format GridView output: <pre><code>Get-WinEvent -Path example.evtx | Out-GridView\n</code></pre> Perform long tail analysis of example.evtx: <pre><code>Get-WinEvent -Path example.evtx | Group-Object id -NoElement | sort count\n</code></pre> Pull events 7030 and 7045 from system.evtx: <pre><code>Get-WinEvent -FilterHashtable @{Path=\"system.evtx\"; ID=7030,7045}\n</code></pre> Same as above, but use the live system event log: <pre><code>Get-WinEvent -FilterHashtable @{logname=\"system\"; id=7030,7045}\n</code></pre> Search for events containing the string \"USB\" in the file system.evtx: <pre><code>Get-WinEvent -FilterHashtable @{Path=\"system.evtx\"} | Where {$_.Message -like \"*USB*\"}\n</code></pre> 'grep'-style search for lines of events containing the case insensitive string \"USB\" in the file system.evtx: <pre><code>Get-WinEvent -FilterHashtable @{Path=\"system.evtx\"} | fl | findstr /i USB\n</code></pre> Pull all errors (level=2) from application.evtx: <pre><code>Get-WinEvent -FilterHashtable @{Path=\"application.evtx\"; level=2}\n</code></pre> Pull all errors (level=2) from application.evtx and count the number of lines ('wc'-style): <pre><code>Get-WinEvent -FilterHashtable @{Path=\"application.evtx\"; level=2} | Measure-Object -Line\n</code></pre> Export Event Logs to CSV format <pre><code># Define the path to the directory where your event log files are stored\n$logDirectory = \"patch to log files\"\n\n# Loop through each event log file in the directory\nGet-ChildItem $logDirectory -Filter *.evtx | ForEach-Object {\n    $logPath = $_.FullName\n\n    # Define the output path for the CSV file\n    $csvPath = \"$logDirectory\\$($_.BaseName).csv\"\n\n    # Export the event log to a CSV file\n    Get-WinEvent -Path $logPath | Select-Object * -ExcludeProperty ContainerLog | Export-Csv $csvPath -NoTypeInformation\n}\n</code></pre></p>"},{"location":"ReferenceDocuments/PowerShell_Commands/#applocker","title":"AppLocker","text":"<p>Pull all AppLocker logs from the live AppLocker event log (requires Applocker): <pre><code>Get-WinEvent -logname \"Microsoft-Windows-AppLocker/EXE and DLL\"\n</code></pre> Search for live AppLocker EXE/MSI block events: \"(EXE) was prevented from running\": <pre><code>Get-WinEvent -FilterHashtable @{logname=\"Microsoft-Windows-Applocker/EXE and DLL\"; id=8004}\n</code></pre> Search for live AppLocker EXE/MSI audit events: \"(EXE) was allowed to run but would have been prevented from running if the AppLocker policy were enforced\": <pre><code>Get-WinEvent -FilterHashtable @{logname=\"Microsoft-Windows-Applocker/EXE and DLL\"; id=8003}\n</code></pre></p>"},{"location":"ReferenceDocuments/PowerShell_Commands/#emet","title":"EMET","text":"<p>Pull all EMET logs from the live Application Event log (requires EMET): <pre><code>Get-WinEvent -FilterHashtable @{logname=\"application\"; providername=\"EMET\"}\n ```  \nPull all EMET logs from a saved Application Event log (requires EMET):  \n```powershell\nGet-WinEvent -FilterHashtable @{path=\"application.evtx\"; providername=\"EMET\"}\n</code></pre></p>"},{"location":"ReferenceDocuments/PowerShell_Commands/#sysmon","title":"Sysmon","text":"<p>Pull all Sysmon logs from the live Sysmon Event log (requires Sysmon and an admin PowerShell): <pre><code>Get-WinEvent -LogName \"Microsoft-Windows-Sysmon/Operational\"\n</code></pre> Pull Sysmon event ID 1 from the live Sysmon Event log <pre><code>Get-WinEvent -FilterHashtable @{logname=\"Microsoft-Windows-Sysmon/Operational\"; id=1}\n</code></pre></p>"},{"location":"ReferenceDocuments/PowerShell_Commands/#windows-defender","title":"Windows Defender","text":"<p>Pull all live Windows Defender event logs <pre><code>Get-WinEvent -FilterHashtable @{logname=\"Microsoft-Windows-Windows Defender/Operational\"}\n</code></pre> Pull Windows Defender event logs 1116 and 1117 from the live event log <pre><code>Get-WinEvent -FilterHashtable @{logname=\"Microsoft-Windows-Windows Defender/Operational\";id=1116,1117}\n</code></pre> Pull Windows Defender event logs 1116 (malware detected) and 1117 (malware blocked) from a saved evtx file <pre><code>Get-WinEvent -FilterHashtable @{path=\"WindowsDefender.evtx\";id=1116,1117}\n</code></pre></p>"},{"location":"ReferenceDocuments/PowerShell_Commands/#references","title":"References","text":"<p>SANS PowerShell Reference SANS PowerShell Reference GitHub </p>"},{"location":"ReferenceDocuments/PowerShell_Commands/#revision-history","title":"Revision History","text":"<ul> <li>20230127 - Initial creation  </li> </ul>"}]}