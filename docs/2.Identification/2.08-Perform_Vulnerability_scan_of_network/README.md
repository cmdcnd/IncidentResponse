# Task Perform Vulnerability scan of network  


## Conditions  
Given a IP Address range and local administrator credentials, an incident response workstation, network access, and a vulnerability assessment tool. Perform a Vulnerability scan of a network  


## Standards  
* Team member verifies network connectivity to a network  
* Team member assures the vulnerability assessment tool is using the latest updates and signatures of the selected tool  
* Team member scans a network and identifies all hosts / systems on network enclave  
* Team member configures the vulnerability assessment tool with the IP address of the network enclave  
* Team member selects assessment options within the tool based on testing level required (Note: Some tests can cause denial of service to host and will need to be evaluated before beginning of assessment)  
* Team member runs the assessment with selected options and monitors progress  
* Team member evaluates the results of the assessment and determines if critical or high vulnerabilities exist on the test machine  


## End State  
All hosts and devices on a network are identified and documented  
All vulnerabilities on the test machine are found and critical or high results are evaluated for remediation  


## Notes  
There are several free and commercial tools available to assist with this task on Linux hosts. OpenVAS is the Open Source version of Nessus and both can be used to perform this task depending on availability.  

As noted in the Standards section, care must be given to the assessment options as some can cause denial of service conditions on the tested host which will cause the remainder of the test to fail. These conditions are normally annotated in the toolâ€™s documentation.  


## Manual Steps  


### Determine if the client/victim currently have designated in-house vulnerability tools  
* Identify if the customer has a service account to conduct your scans. [See Task 1.18 Establish Network Access Accounts](/1.Preparation/1.18RequestNetworkAccounts/README.md)  
* Request a network topolgy from the network owner(if available)  
   * Verify network topology with a ping sweep   
* Establish and separate vulnerability scan groups by Operating Systems(Win/Linux)  
   * Narrow vulnerability scans prevent false results  
* Verify the credentials you are using to scan have:  
   * `Sudo` privilege for Unix/Linux  
   * `Administrator group` for Windows  

* (Optional) Update your machine and system packages:  
   ```bash
   sudo apt-get update  
   sudo apt-get dist-upgrade  
   ```  

### Installing OpenVAS  
* Install OpenVAS with the following commands  
NOTE: the setup command will create an admin account, make sure to copy and save the password.   
   ```bash
   sudo apt-get install openvas  
   sudo openvas-setup  
   sudo openvas-start  
   ```  

* To change the admin username and password complete the following command as root  
   ```bash
   openvasmd --user=admin --new-password=password  
   ```  

### Verify all signatures and feeds are up-to-date  
To access OpenVAS web front-end open a browser and navigate to https://server_name_or_IP:9392  
* Hover over Extras  
* Click on `Feed Status`  
* Verify NVTs version is on or about the current date  
* The formation of the timestamp is: YYYYMMDDHHSS  
* Update all feeds from the terminal  
   ```bash
   openvas-nvt-sync  
   ```  


### Perform Device Discovery Scan  
* Access OpenVAS web front-end  
* Navigate to Scans -> Tasks  
* Start the Advanced Wizard by hovering over the purple New Wizard Icon in top left  
* Enter the following fields  
   * Task Name  
   * Scan Config: Discovery  
   * Target Hosts  
   * Start Time  
* To view reports navigate to Scans -> Reports  


### Perform a Simple Scan  
* Access OpenVAS web front-end  
* Start the Task Wizard by hovering over the purple New Wizard Icon in top left  
* Enter the IP address range and click "Start Scan"  
* To view reports navigate to Scans -> Reports  


### Perform an Authenticated / Credentialed Scan  
* Access OpenVAS web front-end  
* Navigate to Configuration -> Credentials  
* In the top left select New Credential  
* Create the new credentials after filling in the information  
* Navigate to Scans -> Tasks  
* Start the Advanced Wizard by hovering over the purple New Wizard Icon in top left  
* Enter the following information  
	* Task Name  
	* Change Scan Config to "Full and Fast"  
	* Enter IP address or CIDR address range for Target Hosts  
	* Select the appropriate credentials created above  
	* Click Create Task to start your scan  
* To view reports navigate to Scans -> Reports  

* NOTE#1: To perform Credentialed / Authenticated scans on windows hosts you must:   
	* Ensure remote registry service is started  
	* The credentials used must be members of the Local or Domain administrator group on scanned hosts  
	* The File and Printer Sharing is activated - if hosts are Windows XP do not use Simple File Sharing  

* NOTE#2: If you receive an error while creating user credentials verify that the following directory exists:  
	```bash
	/var/lib/openvas/gnupg  
	```  

If the above directory does not exist create it by typing on the server as root  
	```  
	mkdir /var/lib/openvas/gnupg  
	```  


### Report and Remediate All High, Medium, and Low Findings  
NOTE: Implementing remediations requires approval from multiple sources. Please contact your leadership to ensure the proper documentation has been completed and personnel have agreed upon the changes prior to implementing and changes to a network. Major changes to a network should be tested prior to a full implementation accross the network.  
* Navigate to Scans -> Reports  
* Select the report you wish to review  
* Vulnerabilities will be listed in order of severity  
* Click on each vulnerability and review/implement suggested remediation and workarounds per local SOP  


## Running Scripts  
No script; this is a manual process  


## Dependencies  
Internet Connection  

OpenVAS  

Nessus  


## References  
[OpenVAS](http://www.openvas.org)  
[Nessus](http://www.tenable.com/nessus)  


## Revision History  
